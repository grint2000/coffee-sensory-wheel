<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mollis 커피 관능 평가</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #8B5A2B;
            --secondary-color: #D2B48C;
            --accent-color: #654321;
            --background-color: #FFF8E7;
            --text-color: #3E2723;
            --chart-bg: rgba(255, 248, 231, 0.8);
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        
        .coffee-btn {
            background-color: var(--primary-color);
            color: white;
            transition: all 0.3s;
        }
        
        .coffee-btn:hover {
            background-color: var(--accent-color);
        }
        
        .coffee-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .coffee-input {
            border: 1px solid var(--secondary-color);
            border-radius: 4px;
            padding: 8px 12px;
            transition: border 0.3s;
        }
        
        .coffee-input:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .coffee-checkbox {
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            margin-right: 12px;
            margin-bottom: 8px;
            user-select: none;
        }
        
        .coffee-checkbox input {
            position: absolute;
            opacity: 0;
            height: 0;
            width: 0;
        }
        
        .checkmark {
            position: relative;
            height: 20px;
            width: 20px;
            background-color: white;
            border: 2px solid var(--secondary-color);
            border-radius: 4px;
            margin-right: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .coffee-checkbox:hover input ~ .checkmark {
            border-color: var(--primary-color);
        }
        
        .coffee-checkbox input:checked ~ .checkmark {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        
        .coffee-checkbox input:checked ~ .checkmark:after {
            display: block;
        }
        
        .flavor-category {
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            margin-bottom: 15px;
        }
        
        .flavor-title {
            font-weight: 600;
            padding-bottom: 8px;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--secondary-color);
        }
        
        .category-section {
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
        }
        
        .sub-category {
            margin-left: 15px;
        }
        
        .slider-container {
            width: 100%;
            margin: 15px 0;
        }
        
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: var(--secondary-color);
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }
        
        .flavor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
        }
        
        .result-container {
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
        }
        
        @media (min-width: 768px) {
            .score-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }

        /* Custom animation for logo */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .logo-animation {
            animation: fadeIn 1.2s ease-out;
        }
        
        /* The colors for the flavor wheel */
        .color-fruity { background-color: #E57373; }
        .color-berry { background-color: #F06292; }
        .color-citrus { background-color: #FF9800; }
        .color-stone-fruit { background-color: #FFB74D; }
        .color-tropical { background-color: #FFEB3B; }
        
        .color-floral { background-color: #9575CD; }
        .color-herbal { background-color: #81C784; }
        .color-spice { background-color: #A1887F; }
        
        .color-nutty { background-color: #8D6E63; }
        .color-cocoa { background-color: #795548; }
        .color-sweet { background-color: #FFCC80; }
        
        .color-caramel { background-color: #D2B48C; }
        .color-vanilla { background-color: #F5DEB3; }
        .color-honey { background-color: #FFA000; }
        
        /* Print optimization */
        @media print {
            body {
                width: 100%;
                margin: 0;
                padding: 0;
            }
            
            .no-print {
                display: none !important;
            }
            
            .page-break {
                page-break-before: always;
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="container mx-auto">
        <!-- Header with Logo -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-6 logo-animation">
            <div class="flex items-center">
                <svg width="80" height="80" viewBox="0 0 200 200" class="mr-3">
                    <rect width="200" height="200" fill="black" />
                    <path d="M100,40 L120,60 L110,60 L110,80 L115,90 L105,100 C105,100 120,110 130,120 C140,130 120,150 120,150 L80,150 C80,150 60,130 70,120 C80,110 95,100 95,100 L85,90 L90,80 L90,60 L80,60 Z" fill="#D2B48C" />
                    <circle cx="95" cy="60" r="2" fill="#D2B48C" />
                    <circle cx="105" cy="70" r="2" fill="#D2B48C" />
                    <circle cx="115" cy="65" r="2" fill="#D2B48C" />
                </svg>
                <h1 class="text-3xl md:text-4xl font-bold text-accent-color">mollis</h1>
            </div>
            <h2 class="text-xl md:text-2xl font-semibold mt-3 md:mt-0">커피 관능 평가</h2>
        </header>

        <!-- Coffee Information Card -->
        <div class="coffee-card mb-8 p-6">
            <h3 class="text-xl font-bold mb-4 border-b pb-2 border-secondary-color">커피 정보</h3>
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium mb-1">커피명</label>
                    <input type="text" id="coffeeName" class="coffee-input w-full" placeholder="커피 이름을 입력하세요">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">원산지</label>
                    <input type="text" id="origin" class="coffee-input w-full" placeholder="원산지를 입력하세요">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">품종</label>
                    <input type="text" id="variety" class="coffee-input w-full" placeholder="품종을 입력하세요">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">가공방식</label>
                    <input type="text" id="process" class="coffee-input w-full" placeholder="가공방식을 입력하세요">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">로스팅 날짜</label>
                    <input type="date" id="roastDate" class="coffee-input w-full">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">로스팅 레벨</label>
                    <select id="roastLevel" class="coffee-input w-full">
                        <option value="">로스팅 레벨 선택</option>
                        <option value="light">라이트 로스트</option>
                        <option value="medium-light">미디엄-라이트 로스트</option>
                        <option value="medium">미디엄 로스트</option>
                        <option value="medium-dark">미디엄-다크 로스트</option>
                        <option value="dark">다크 로스트</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Flavor Profile Card -->
        <div class="coffee-card mb-8 p-6">
            <h3 class="text-xl font-bold mb-4 border-b pb-2 border-secondary-color">향미 프로필</h3>
            <p class="mb-4 text-sm">각 카테고리에서 감지된 향미를 체크하세요. 여러 항목 선택 가능합니다.</p>
            
            <!-- Flavor Categories -->
            <div>
                <!-- Fruity Category -->
                <div class="flavor-category">
                    <div class="flavor-title">과일향 (Fruity)</div>
                    <div class="category-section">
                        <div class="mb-3">
                            <label class="coffee-checkbox">
                                <input type="checkbox" data-category="fruity" data-subcategory="berry">
                                <span class="checkmark"></span>
                                베리류 (Berry)
                            </label>
                            <div class="sub-category ml-6">
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="berry" data-flavor="blackberry">
                                    <span class="checkmark"></span>
                                    블랙베리
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="berry" data-flavor="raspberry">
                                    <span class="checkmark"></span>
                                    라즈베리
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="berry" data-flavor="blueberry">
                                    <span class="checkmark"></span>
                                    블루베리
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="berry" data-flavor="strawberry">
                                    <span class="checkmark"></span>
                                    딸기
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="coffee-checkbox">
                                <input type="checkbox" data-category="fruity" data-subcategory="citrus">
                                <span class="checkmark"></span>
                                시트러스 (Citrus)
                            </label>
                            <div class="sub-category ml-6">
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="citrus" data-flavor="lemon">
                                    <span class="checkmark"></span>
                                    레몬
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="citrus" data-flavor="orange">
                                    <span class="checkmark"></span>
                                    오렌지
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="citrus" data-flavor="grapefruit">
                                    <span class="checkmark"></span>
                                    자몽
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="citrus" data-flavor="lime">
                                    <span class="checkmark"></span>
                                    라임
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="coffee-checkbox">
                                <input type="checkbox" data-category="fruity" data-subcategory="stone-fruit">
                                <span class="checkmark"></span>
                                핵과류 (Stone Fruit)
                            </label>
                            <div class="sub-category ml-6">
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="stone-fruit" data-flavor="peach">
                                    <span class="checkmark"></span>
                                    복숭아
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="stone-fruit" data-flavor="apricot">
                                    <span class="checkmark"></span>
                                    살구
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="stone-fruit" data-flavor="cherry">
                                    <span class="checkmark"></span>
                                    체리
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="stone-fruit" data-flavor="plum">
                                    <span class="checkmark"></span>
                                    자두
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="coffee-checkbox">
                                <input type="checkbox" data-category="fruity" data-subcategory="tropical">
                                <span class="checkmark"></span>
                                열대과일 (Tropical)
                            </label>
                            <div class="sub-category ml-6">
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="tropical" data-flavor="pineapple">
                                    <span class="checkmark"></span>
                                    파인애플
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="tropical" data-flavor="mango">
                                    <span class="checkmark"></span>
                                    망고
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="tropical" data-flavor="banana">
                                    <span class="checkmark"></span>
                                    바나나
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="fruity" data-subcategory="tropical" data-flavor="passion-fruit">
                                    <span class="checkmark"></span>
                                    패션프루트
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Floral Category -->
                <div class="flavor-category">
                    <div class="flavor-title">꽃향 (Floral)</div>
                    <div class="category-section">
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="floral" data-subcategory="floral" data-flavor="jasmine">
                            <span class="checkmark"></span>
                            자스민
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="floral" data-subcategory="floral" data-flavor="rose">
                            <span class="checkmark"></span>
                            장미
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="floral" data-subcategory="floral" data-flavor="elderflower">
                            <span class="checkmark"></span>
                            엘더플라워
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="floral" data-subcategory="floral" data-flavor="lavender">
                            <span class="checkmark"></span>
                            라벤더
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="floral" data-subcategory="floral" data-flavor="chamomile">
                            <span class="checkmark"></span>
                            캐모마일
                        </label>
                    </div>
                </div>
                
                <!-- Herbal Category -->
                <div class="flavor-category">
                    <div class="flavor-title">허브향 (Herbal)</div>
                    <div class="category-section">
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="herbal" data-subcategory="herbal" data-flavor="mint">
                            <span class="checkmark"></span>
                            민트
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="herbal" data-subcategory="herbal" data-flavor="sage">
                            <span class="checkmark"></span>
                            세이지
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="herbal" data-subcategory="herbal" data-flavor="basil">
                            <span class="checkmark"></span>
                            바질
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="herbal" data-subcategory="herbal" data-flavor="thyme">
                            <span class="checkmark"></span>
                            타임
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="herbal" data-subcategory="herbal" data-flavor="tea">
                            <span class="checkmark"></span>
                            차
                        </label>
                    </div>
                </div>
                
                <!-- Spice Category -->
                <div class="flavor-category">
                    <div class="flavor-title">향신료 (Spice)</div>
                    <div class="category-section">
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="spice" data-subcategory="spice" data-flavor="cinnamon">
                            <span class="checkmark"></span>
                            시나몬
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="spice" data-subcategory="spice" data-flavor="clove">
                            <span class="checkmark"></span>
                            클로브
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="spice" data-subcategory="spice" data-flavor="pepper">
                            <span class="checkmark"></span>
                            후추
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="spice" data-subcategory="spice" data-flavor="anise">
                            <span class="checkmark"></span>
                            아니스
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="spice" data-subcategory="spice" data-flavor="cardamom">
                            <span class="checkmark"></span>
                            카다몸
                        </label>
                    </div>
                </div>
                
                <!-- Sweet/Nuts Category -->
                <div class="flavor-category">
                    <div class="flavor-title">달콤함 & 견과류 (Sweet & Nuts)</div>
                    <div class="category-section">
                        <div class="mb-3">
                            <label class="coffee-checkbox">
                                <input type="checkbox" data-category="sweet" data-subcategory="sweet">
                                <span class="checkmark"></span>
                                달콤함 (Sweet)
                            </label>
                            <div class="sub-category ml-6">
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="sweet" data-subcategory="sweet" data-flavor="caramel">
                                    <span class="checkmark"></span>
                                    카라멜
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="sweet" data-subcategory="sweet" data-flavor="honey">
                                    <span class="checkmark"></span>
                                    꿀
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="sweet" data-subcategory="sweet" data-flavor="vanilla">
                                    <span class="checkmark"></span>
                                    바닐라
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="sweet" data-subcategory="sweet" data-flavor="molasses">
                                    <span class="checkmark"></span>
                                    당밀
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="sweet" data-subcategory="sweet" data-flavor="maple-syrup">
                                    <span class="checkmark"></span>
                                    메이플 시럽
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="coffee-checkbox">
                                <input type="checkbox" data-category="nutty" data-subcategory="nutty">
                                <span class="checkmark"></span>
                                견과류 (Nutty)
                            </label>
                            <div class="sub-category ml-6">
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="nutty" data-subcategory="nutty" data-flavor="almond">
                                    <span class="checkmark"></span>
                                    아몬드
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="nutty" data-subcategory="nutty" data-flavor="hazelnut">
                                    <span class="checkmark"></span>
                                    헤이즐넛
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="nutty" data-subcategory="nutty" data-flavor="peanut">
                                    <span class="checkmark"></span>
                                    땅콩
                                </label>
                                <label class="coffee-checkbox">
                                    <input type="checkbox" data-category="nutty" data-subcategory="nutty" data-flavor="walnut">
                                    <span class="checkmark"></span>
                                    호두
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Cocoa Category -->
                <div class="flavor-category">
                    <div class="flavor-title">코코아 (Cocoa)</div>
                    <div class="category-section">
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="cocoa" data-subcategory="cocoa" data-flavor="dark-chocolate">
                            <span class="checkmark"></span>
                            다크 초콜릿
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="cocoa" data-subcategory="cocoa" data-flavor="milk-chocolate">
                            <span class="checkmark"></span>
                            밀크 초콜릿
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="cocoa" data-subcategory="cocoa" data-flavor="cocoa-powder">
                            <span class="checkmark"></span>
                            코코아 파우더
                        </label>
                        <label class="coffee-checkbox">
                            <input type="checkbox" data-category="cocoa" data-subcategory="cocoa" data-flavor="baker-chocolate">
                            <span class="checkmark"></span>
                            베이커 초콜릿
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Flavor Intensity Slider -->
            <div class="mt-6">
                <label class="block font-medium mb-2">전체 향미 강도</label>
                <div class="slider-container">
                    <input type="range" min="1" max="10" value="5" class="slider" id="flavorIntensity">
                    <div class="flex justify-between text-sm mt-1">
                        <span>약함</span>
                        <span>중간</span>
                        <span>강함</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- SCA Cupping Score Card -->
        <div class="coffee-card mb-8 p-6">
            <h3 class="text-xl font-bold mb-4 border-b pb-2 border-secondary-color">SCA 커핑 점수</h3>
            <p class="mb-4 text-sm">각 항목을 6-10점 사이로 평가하세요 (0.25점 단위).</p>
            
            <div class="score-grid">
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">향기 (Fragrance/Aroma)</label>
                    <input type="number" id="scoreAroma" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">맛 (Flavor)</label>
                    <input type="number" id="scoreFlavor" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">뒷맛 (Aftertaste)</label>
                    <input type="number" id="scoreAftertaste" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">산미 (Acidity)</label>
                    <input type="number" id="scoreAcidity" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">바디 (Body)</label>
                    <input type="number" id="scoreBody" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">균형감 (Balance)</label>
                    <input type="number" id="scoreBalance" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">단맛 (Sweetness)</label>
                    <input type="number" id="scoreSweetness" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-1">클린컵 (Clean Cup)</label>
                    <input type="number" id="scoreCleanCup" class="coffee-input w-full" min="0" max="10" step="0.25" value="7.5">
                </div>
            </div>
            
            <div class="mt-4 flex items-end">
                <div class="flex-1">
                    <label class="block text-sm font-medium mb-1">총점 (Total Score)</label>
                    <div id="totalScore" class="coffee-input w-full font-bold text-center py-2">36.0</div>
                </div>
                <div class="ml-4 flex-none">
                    <button id="calculateBtn" class="coffee-btn px-4 py-2 rounded">점수 계산</button>
                </div>
            </div>
        </div>

        <!-- Notes section -->
        <div class="coffee-card mb-8 p-6">
            <h3 class="text-xl font-bold mb-4 border-b pb-2 border-secondary-color">테이스팅 노트</h3>
            <textarea id="tastingNotes" class="coffee-input w-full h-32" placeholder="커피에 대한 추가 의견이나 느낌을 자유롭게 적어주세요."></textarea>
        </div>

        <!-- Result Visualization Card -->
        <div class="coffee-card mb-8 p-6">
            <h3 class="text-xl font-bold mb-4 border-b pb-2 border-secondary-color">결과 시각화</h3>
            <div class="result-container">
                <h4 class="text-lg font-semibold text-center mb-4" id="result-title">커피 향미 프로필</h4>
                
                <!-- Flavor Wheel Chart -->
                <div class="chart-container mb-6">
                    <canvas id="flavorWheel"></canvas>
                </div>
                
                <!-- SCA Score Radar Chart -->
                <div class="chart-container mb-6">
                    <canvas id="scoringRadar"></canvas>
                </div>
                
                <div class="coffee-card p-4 w-full mb-6">
                    <h4 class="font-semibold mb-2">선택된 향미 특성</h4>
                    <div id="selectedFlavors" class="text-sm">선택된 향미가 없습니다.</div>
                </div>
                
                <!-- Export Button -->
                <button id="exportBtn" class="coffee-btn px-6 py-3 rounded no-print">
                    이미지로 내보내기 <i class="fas fa-download ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // 플레이버 데이터 구조
        const flavorCategories = {
            fruity: {
                name: "과일향 (Fruity)",
                color: "#E57373",
                subcategories: {
                    berry: {
                        name: "베리류 (Berry)",
                        color: "#F06292",
                        flavors: {
                            blackberry: "블랙베리",
                            raspberry: "라즈베리",
                            blueberry: "블루베리",
                            strawberry: "딸기"
                        }
                    },
                    citrus: {
                        name: "시트러스 (Citrus)",
                        color: "#FF9800",
                        flavors: {
                            lemon: "레몬",
                            orange: "오렌지",
                            grapefruit: "자몽",
                            lime: "라임"
                        }
                    },
                    "stone-fruit": {
                        name: "핵과류 (Stone Fruit)",
                        color: "#FFB74D",
                        flavors: {
                            peach: "복숭아",
                            apricot: "살구",
                            cherry: "체리",
                            plum: "자두"
                        }
                    },
                    tropical: {
                        name: "열대과일 (Tropical)",
                        color: "#FFEB3B",
                        flavors: {
                            pineapple: "파인애플",
                            mango: "망고",
                            banana: "바나나",
                            "passion-fruit": "패션프루트"
                        }
                    }
                }
            },
            floral: {
                name: "꽃향 (Floral)",
                color: "#9575CD",
                subcategories: {
                    floral: {
                        name: "꽃향 (Floral)",
                        color: "#9575CD",
                        flavors: {
                            jasmine: "자스민",
                            rose: "장미",
                            elderflower: "엘더플라워",
                            lavender: "라벤더",
                            chamomile: "캐모마일"
                        }
                    }
                }
            },
            herbal: {
                name: "허브향 (Herbal)",
                color: "#81C784",
                subcategories: {
                    herbal: {
                        name: "허브향 (Herbal)",
                        color: "#81C784",
                        flavors: {
                            mint: "민트",
                            sage: "세이지",
                            basil: "바질",
                            thyme: "타임",
                            tea: "차"
                        }
                    }
                }
            },
            spice: {
                name: "향신료 (Spice)",
                color: "#A1887F",
                subcategories: {
                    spice: {
                        name: "향신료 (Spice)",
                        color: "#A1887F",
                        flavors: {
                            cinnamon: "시나몬",
                            clove: "클로브",
                            pepper: "후추",
                            anise: "아니스",
                            cardamom: "카다몸"
                        }
                    }
                }
            },
            sweet: {
                name: "달콤함 (Sweet)",
                color: "#FFCC80",
                subcategories: {
                    sweet: {
                        name: "달콤함 (Sweet)",
                        color: "#FFCC80",
                        flavors: {
                            caramel: "카라멜",
                            honey: "꿀",
                            vanilla: "바닐라",
                            molasses: "당밀",
                            "maple-syrup": "메이플 시럽"
                        }
                    }
                }
            },
            nutty: {
                name: "견과류 (Nutty)",
                color: "#8D6E63",
                subcategories: {
                    nutty: {
                        name: "견과류 (Nutty)",
                        color: "#8D6E63",
                        flavors: {
                            almond: "아몬드",
                            hazelnut: "헤이즐넛",
                            peanut: "땅콩",
                            walnut: "호두"
                        }
                    }
                }
            },
            cocoa: {
                name: "코코아 (Cocoa)",
                color: "#795548",
                subcategories: {
                    cocoa: {
                        name: "코코아 (Cocoa)",
                        color: "#795548",
                        flavors: {
                            "dark-chocolate": "다크 초콜릿",
                            "milk-chocolate": "밀크 초콜릿",
                            "cocoa-powder": "코코아 파우더",
                            "baker-chocolate": "베이커 초콜릿"
                        }
                    }
                }
            }
        };

        // DOM 로드 완료 후 실행
        document.addEventListener('DOMContentLoaded', function() {
            // 초기화
            initCheckboxes();
            initCharts();
            updateResultTitle();
            
            // 이벤트 리스너
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateFlavorWheel();
                    updateSelectedFlavorsList();
                });
            });
            
            document.getElementById('flavorIntensity').addEventListener('input', function() {
                updateFlavorWheel();
            });
            
            document.getElementById('calculateBtn').addEventListener('click', function() {
                calculateTotalScore();
                updateScoringRadar();
            });
            
            document.getElementById('coffeeName').addEventListener('input', updateResultTitle);
            document.getElementById('origin').addEventListener('input', updateResultTitle);
            
            document.getElementById('exportBtn').addEventListener('click', exportAsImage);
            
            // 초기 데이터로 차트 업데이트
            updateFlavorWheel();
            updateScoringRadar();
        });

        // 체크박스 선택 관계 초기화
        function initCheckboxes() {
            // 상위 카테고리 체크박스가 선택되면 하위 체크박스 상태 변경
            document.querySelectorAll('input[data-subcategory]').forEach(checkbox => {
                if (!checkbox.hasAttribute('data-flavor')) {
                    checkbox.addEventListener('change', function() {
                        const category = this.getAttribute('data-category');
                        const subcategory = this.getAttribute('data-subcategory');
                        
                        // 하위 체크박스 찾기
                        const childCheckboxes = document.querySelectorAll(`input[data-category="${category}"][data-subcategory="${subcategory}"][data-flavor]`);
                        
                        // 모든 하위 체크박스 상태 변경
                        childCheckboxes.forEach(child => {
                            child.checked = this.checked;
                        });
                        
                        updateFlavorWheel();
                    });
                }
            });
            
            // 하위 체크박스가 선택되면 상위 체크박스 상태 확인 및 업데이트
            document.querySelectorAll('input[data-flavor]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const category = this.getAttribute('data-category');
                    const subcategory = this.getAttribute('data-subcategory');
                    
                    // 같은 서브카테고리의 모든 하위 체크박스
                    const siblingCheckboxes = document.querySelectorAll(`input[data-category="${category}"][data-subcategory="${subcategory}"][data-flavor]`);
                    
                    // 하위 체크박스 중 하나라도 체크되어 있는지 확인
                    const anyChecked = Array.from(siblingCheckboxes).some(box => box.checked);
                    
                    // 상위 체크박스 찾기 및 상태 업데이트
                    const parentCheckbox = document.querySelector(`input[data-category="${category}"][data-subcategory="${subcategory}"]:not([data-flavor])`);
                    if (parentCheckbox) {
                        parentCheckbox.checked = anyChecked;
                    }
                    
                    updateFlavorWheel();
                });
            });
        }

        // 차트 초기화
        function initCharts() {
            // 향미 휠 차트 초기화
            const flavorWheelCtx = document.getElementById('flavorWheel').getContext('2d');
            window.flavorWheelChart = new Chart(flavorWheelCtx, {
                type: 'polarArea',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [],
                        borderColor: 'rgba(255, 255, 255, 0.5)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Noto Sans KR'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw;
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            ticks: {
                                display: false
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            angleLines: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    }
                }
            });
            
            // 점수 레이더 차트 초기화
            const scoringRadarCtx = document.getElementById('scoringRadar').getContext('2d');
            window.scoringRadarChart = new Chart(scoringRadarCtx, {
                type: 'radar',
                data: {
                    labels: ['향기', '맛', '뒷맛', '산미', '바디', '균형감', '단맛', '클린컵'],
                    datasets: [{
                        label: 'SCA 점수',
                        data: [7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5],
                        backgroundColor: 'rgba(139, 90, 43, 0.3)',
                        borderColor: 'rgba(139, 90, 43, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(139, 90, 43, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(139, 90, 43, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: false,
                            min: 5,
                            max: 10,
                            ticks: {
                                stepSize: 1
                            },
                            pointLabels: {
                                font: {
                                    family: 'Noto Sans KR',
                                    size: 12
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // 향미 휠 차트 업데이트
        function updateFlavorWheel() {
            const selectedFlavors = getSelectedFlavors();
            const intensity = parseInt(document.getElementById('flavorIntensity').value);
            
            const labels = [];
            const data = [];
            const backgroundColors = [];
            
            // 선택된 향미가 없으면 기본 차트 표시
            if (Object.keys(selectedFlavors).length === 0) {
                const defaultCategories = Object.keys(flavorCategories);
                defaultCategories.forEach(category => {
                    labels.push(flavorCategories[category].name);
                    data.push(intensity / 2); // 기본 강도는 선택된 강도의 절반
                    backgroundColors.push(flavorCategories[category].color);
                });
            } else {
                // 선택된 향미로 차트 데이터 생성
                for (const [category, subcategories] of Object.entries(selectedFlavors)) {
                    for (const [subcategory, flavors] of Object.entries(subcategories)) {
                        if (Object.keys(flavors).length > 0) {
                            // 각 서브카테고리별로 라벨 추가
                            const subcategoryInfo = flavorCategories[category].subcategories[subcategory];
                            const flavorNames = Object.keys(flavors).map(f => subcategoryInfo.flavors[f]);
                            
                            // 서브카테고리 이름과 선택된 플레이버 이름들을 합침
                            const label = `${subcategoryInfo.name} (${flavorNames.join(', ')})`;
                            labels.push(label);
                            data.push(intensity);
                            backgroundColors.push(subcategoryInfo.color);
                        }
                    }
                }
            }
            
            // 차트 데이터 업데이트
            window.flavorWheelChart.data.labels = labels;
            window.flavorWheelChart.data.datasets[0].data = data;
            window.flavorWheelChart.data.datasets[0].backgroundColor = backgroundColors;
            window.flavorWheelChart.update();
            
            // 선택된 향미 목록 업데이트
            updateSelectedFlavorsList();
        }

        // 현재 선택된 향미 가져오기
        function getSelectedFlavors() {
            const selected = {};
            
            // 선택된 체크박스 찾기
            document.querySelectorAll('input[data-flavor]:checked').forEach(checkbox => {
                const category = checkbox.getAttribute('data-category');
                const subcategory = checkbox.getAttribute('data-subcategory');
                const flavor = checkbox.getAttribute('data-flavor');
                
                // 선택된 향미 목록에 추가
                if (!selected[category]) {
                    selected[category] = {};
                }
                if (!selected[category][subcategory]) {
                    selected[category][subcategory] = {};
                }
                
                selected[category][subcategory][flavor] = true;
            });
            
            return selected;
        }

        // 선택된 향미 목록 텍스트 업데이트
        function updateSelectedFlavorsList() {
            const selectedFlavors = getSelectedFlavors();
            const listElement = document.getElementById('selectedFlavors');
            
            if (Object.keys(selectedFlavors).length === 0) {
                listElement.textContent = "선택된 향미가 없습니다.";
                return;
            }
            
            let flavorHtml = '';
            
            for (const [category, subcategories] of Object.entries(selectedFlavors)) {
                const categoryInfo = flavorCategories[category];
                
                for (const [subcategory, flavors] of Object.entries(subcategories)) {
                    const subcategoryInfo = categoryInfo.subcategories[subcategory];
                    const flavorKeys = Object.keys(flavors);
                    
                    if (flavorKeys.length > 0) {
                        flavorHtml += `<div class="mb-2"><strong style="color:${subcategoryInfo.color}">${subcategoryInfo.name}:</strong> `;
                        
                        const flavorNames = flavorKeys.map(key => subcategoryInfo.flavors[key]);
                        flavorHtml += flavorNames.join(', ');
                        
                        flavorHtml += '</div>';
                    }
                }
            }
            
            listElement.innerHTML = flavorHtml;
        }

        // SCA 점수 레이더 차트 업데이트
        function updateScoringRadar() {
            const scores = [
                parseFloat(document.getElementById('scoreAroma').value) || 7.5,
                parseFloat(document.getElementById('scoreFlavor').value) || 7.5,
                parseFloat(document.getElementById('scoreAftertaste').value) || 7.5,
                parseFloat(document.getElementById('scoreAcidity').value) || 7.5,
                parseFloat(document.getElementById('scoreBody').value) || 7.5,
                parseFloat(document.getElementById('scoreBalance').value) || 7.5,
                parseFloat(document.getElementById('scoreSweetness').value) || 7.5,
                parseFloat(document.getElementById('scoreCleanCup').value) || 7.5
            ];
            
            window.scoringRadarChart.data.datasets[0].data = scores;
            window.scoringRadarChart.update();
        }

        // 총점 계산
        function calculateTotalScore() {
            const scoreFields = [
                'scoreAroma', 'scoreFlavor', 'scoreAftertaste', 'scoreAcidity',
                'scoreBody', 'scoreBalance', 'scoreSweetness', 'scoreCleanCup'
            ];
            
            let total = 0;
            
            scoreFields.forEach(field => {
                const value = parseFloat(document.getElementById(field).value) || 0;
                total += value;
            });
            
            // SCA 커핑 폼에 따라 총점 계산 (36 + 합계)
            const finalScore = 36 + total;
            document.getElementById('totalScore').textContent = finalScore.toFixed(2);
        }

        // 결과 타이틀 업데이트
        function updateResultTitle() {
            const coffeeName = document.getElementById('coffeeName').value;
            const origin = document.getElementById('origin').value;
            
            let title = "커피 향미 프로필";
            
            if (coffeeName) {
                title = coffeeName;
                if (origin) {
                    title += ` (${origin})`;
                }
            }
            
            document.getElementById('result-title').textContent = title;
        }

        // 이미지로 내보내기
        function exportAsImage() {
            const resultContainer = document.querySelector('.result-container');
            
            html2canvas(resultContainer, {
                backgroundColor: "#FFF8E7",
                scale: 2,
                logging: false,
                onclone: function(clonedDoc) {
                    // 클론된 DOM에서 필요 없는 버튼 등 숨기기
                    Array.from(clonedDoc.querySelectorAll('.no-print')).forEach(el => {
                        el.style.display = 'none';
                    });
                }
            }).then(canvas => {
                // 캔버스를 이미지로 변환
                const image = canvas.toDataURL('image/png');
                
                // 다운로드 링크 생성
                const downloadLink = document.createElement('a');
                const coffeeName = document.getElementById('coffeeName').value || 'coffee';
                downloadLink.href = image;
                downloadLink.download = `${coffeeName}_profile.png`;
                
                // 링크 클릭하여 다운로드
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
            });
        }
    </script>
</body>
</html>
