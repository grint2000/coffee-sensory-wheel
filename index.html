<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Mollis SCA ì»¤í”¼ ê´€ëŠ¥ í‰ê°€ (ê°œì„ ë²„ì „)</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    html,body { font-family: 'Noto Sans KR', sans-serif; background: #fcfaf7;}
    .flavor-badge { font-size: 13px; border-radius: 9999px; padding: 2px 10px; margin: 2px; display:inline-block;}
    .export-btn { background:#8B5A2B; color:white;} .export-btn:hover { background: #654321;}
    .tab-btn-active { background: #8B5A2B!important; color:#fff !important;}
    .tab-btn-inactive { background: #f3efe8!important; color: #675444;}
    .visual-section-flex { display: flex; flex-direction: row; gap: 18px; flex-wrap: wrap; }
    @media (max-width:900px){ .visual-section-flex{ flex-direction:column; } }
    @media (max-width:640px){
      .visual-section-flex { flex-direction: column; gap: 12px;}
      .grid-cols-sample { grid-template-columns:1fr!important;}
      .md\:grid-cols-2 { grid-template-columns: 1fr !important;}
      .score-input-wrap input[type=number], .score-slider { width: 90px; }
      .defect-block { min-width:110px!important;}
    }
    
    /* í–¥ë¯¸ ì„ íƒ ì˜ì—­ ìŠ¤í¬ë¡¤ ì œê±° ë° ì „ì²´ í‘œì‹œ */
    .flavor-section {
      max-height: none !important; 
      overflow: visible !important;
      padding: 15px;
      background: #f9f7f5;
      border-radius: 12px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
    }
    
    /* ë°”ë””ê° í•­ëª© ìŠ¤íƒ€ì¼ ê°œì„  - í–¥ë¯¸ ì„ íƒê³¼ ìœ ì‚¬í•˜ê²Œ */
    .body-descriptor-section {
      background: #f4f1ee;
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
      border: 1px solid #e5ddd4;
    }
    
    .body-descriptor-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 8px;
      margin-top: 10px;
    }
    
    /* ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° í•­ëª© - í–¥ë¯¸ ì²´í¬ë°•ìŠ¤ì™€ ìœ ì‚¬í•œ ìŠ¤íƒ€ì¼ */
    .body-descriptor-item {
      position: relative;
      display: inline-flex;
      align-items: center;
      padding: 6px 12px 6px 32px;
      border-radius: 20px;
      margin: 3px;
      font-size: 13px;
      cursor: pointer;
      line-height: 1.3;
      transition: all 0.2s;
      user-select: none;
      border: 1px solid #ddd;
      background: white;
      min-height: 36px;
    }
    
    .body-descriptor-item:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .body-descriptor-item.selected {
      box-shadow: 0 0 0 2px rgba(139, 90, 43, 0.8);
      transform: translateY(-1px);
      border-color: #8B5A2B;
      background: #8B5A2B;
      color: white;
    }
    
    .body-descriptor-item input[type="checkbox"] {
      position: absolute;
      opacity: 0;
      left: 8px;
      width: 16px;
      height: 16px;
      margin: 0;
      cursor: pointer;
    }
    
    .body-descriptor-item .checkbox-custom {
      position: absolute;
      left: 8px;
      width: 16px;
      height: 16px;
      background: white;
      border-radius: 4px;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .body-descriptor-item input:checked + .checkbox-custom:after {
      content: "\f00c";
      font-family: "Font Awesome 5 Free";
      font-weight: 900;
      font-size: 10px;
      color: #8B5A2B;
    }
    
    .body-descriptor-item.selected input:checked + .checkbox-custom:after {
      color: #fff;
    }
    
    .body-descriptor-item.selected .checkbox-custom {
      background: #8B5A2B;
      border-color: #8B5A2B;
    }
    
    /* SNS í˜• ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .sns-export-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      transition: all 0.3s;
    }
    
    .sns-export-btn:hover {
      background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    /* ìƒ˜í”Œ ì•Œë¦¼ í† ìŠ¤íŠ¸ */
    .sample-toast {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 16px 32px;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 600;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }
    .sample-toast.show {
      opacity: 1;
      visibility: visible;
    }
    
    .no-scrollbar::-webkit-scrollbar {display: none;} 
    .no-scrollbar {-ms-overflow-style: none; scrollbar-width: none;}
    .html2canvas-container { box-shadow: 0 0 0 3px #eee; }
    .score-slider { width: 100%; }
    .sample-list-scroll {
  max-height: 190px; 
  overflow-y: auto;
  -webkit-overflow-scrolling: touch; /* iOS ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ */
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: #8B5A2B transparent; /* Firefox */
}

/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ - ì›¹í‚· ê¸°ë°˜ ë¸Œë¼ìš°ì € */
.sample-list-scroll::-webkit-scrollbar {
  width: 4px;
}

.sample-list-scroll::-webkit-scrollbar-track {
  background: transparent;
}

.sample-list-scroll::-webkit-scrollbar-thumb {
  background: #8B5A2B;
  border-radius: 2px;
}

.sample-list-scroll::-webkit-scrollbar-thumb:hover {
  background: #654321;
}
    .compare-table th, .compare-table td {border:1px solid #e2e2e2; padding:6px 8px; font-size:14px;}
    .compare-table th {background: #f9f3ea;}
    .compare-table tr:nth-child(even) td {background: #f8f6f4;}
    .tooltip { position: relative; cursor: help;}
    .tooltip .tooltip-text { visibility: hidden; background: #333; color: #fff; position: absolute; z-index: 10; padding: 7px 15px; border-radius: 8px; left: 50%; top:110%; min-width:160px; font-size:13px; opacity:0; transform:translateX(-50%); pointer-events: none; transition: opacity 0.2s; box-shadow: 0 1px 6px rgba(0,0,0,0.13); word-break: keep-all; }
    .tooltip:hover .tooltip-text {opacity:1;visibility:visible;}
    .toast { position: fixed; bottom: 28px; right: 28px; min-width: 240px; background: #8B5A2B; color: #fff; padding: 14px 24px; border-radius: 8px; box-shadow: 0 3px 20px rgba(0,0,0,.18); z-index: 9999; font-size: 15px; opacity: 0; pointer-events:none; transition: opacity 0.3s; text-align: center; }
    .toast.show{opacity:1;pointer-events:auto;}
    .defect-badge { border-radius:9999px; font-size:12px!important; padding:2px 11px;margin: 0 4px 4px 0; display:inline-block; max-width:100%; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .defect-headline { font-size: 15px; font-weight:600; margin-bottom:.5rem }
    .defect-desc { font-size: 11px; color: #666; margin-bottom: .2rem; }
    .defect-block { display:flex; flex-direction: column; min-width:120px; margin-right:9px; margin-bottom:7px;}
    @media print { .flavor-section { max-height: none !important; overflow: visible !important; } body { background: #fff; } .toast, .sample-toast { display:none; } }
    @media (max-width:400px) {
      .defect-block { min-width:70px!important;font-size:11px;}
      .defect-badge { font-size:11px!important;padding:1px 6px;}
      .defect-headline { font-size:12.5px;}
      .body-descriptor-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
      .body-descriptor-item { font-size: 12px; padding: 5px 8px; }
    }
    
    /* í–¥ë¯¸ ì„ íƒ ê°œì„  */
    .flavor-checkbox-label {
      position: relative;
      display: inline-flex;
      align-items: center;
      padding: 4px 12px 4px 30px;
      border-radius: 20px;
      margin: 3px;
      font-size: 13px;
      cursor: pointer;
      line-height: 1.3;
      transition: all 0.2s;
    }
    .flavor-checkbox-label:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .flavor-checkbox-label input {
      position: absolute;
      opacity: 0;
      left: 8px;
    }
    .flavor-checkbox-label .checkbox-custom {
      position: absolute;
      left: 8px;
      width: 16px;
      height: 16px;
      background: white;
      border-radius: 4px;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .flavor-checkbox-label input:checked + .checkbox-custom:after {
      content: "\f00c";
      font-family: "Font Awesome 5 Free";
      font-weight: 900;
      font-size: 10px;
      color: #fff;
    }
    .flavor-checkbox-label input:checked + .checkbox-custom {
      background: #8B5A2B;
      border-color: #8B5A2B;
    }
    .flavor-checkbox-label .flavor-kr {
      font-size: 12px;
      opacity: 0.85;
      display: block;
    }
    
    .flavor-category-title {
      background: #8B5A2B;
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 12px 0 8px 0;
      font-weight: 600;
    }
    
    .flavor-subcategory-title {
      font-weight: 600;
      background: #f1e7db;
      padding: 4px 10px;
      border-radius: 4px;
      margin: 8px 0 6px 0;
      display: inline-block;
    }
    
    /* ìƒ˜í”Œ ë¦¬ìŠ¤íŠ¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­ */
    .sample-item {
      cursor: grab;
      transition: background-color 0.2s;
      user-select: none;
      touch-action: none;
    }
    .sample-item:active {
      cursor: grabbing;
    }
    .sample-item.sortable-ghost {
      opacity: 0.4;
      background-color: #f0ebdd !important;
    }
    .sample-item.sortable-chosen {
      background-color: #fef9c3 !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .sample-drag-handle {
      cursor: grab;
      color: #9ca3af;
      padding: 0 6px;
      touch-action: none;
    }
    .sample-drag-handle:active {
      cursor: grabbing;
    }
    
    /* í–¥ë¯¸ í”„ë¡œí•„ ë ˆì´ë” ì°¨íŠ¸ */
    .flavor-profile-chart-container {
      width: 100%;
      height: 300px;
      margin-top: 20px;
    }
    
    /* ë¶„í•  í™”ë©´ ë¹„êµ */
    .split-view {
      display: flex;
      flex-direction: row;
      width: 100%;
      gap: 10px;
      margin-top: 20px;
      overflow: auto;
    }
    .split-view-container {
      flex: 1;
      min-width: 200px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 15px;
      background: white;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    @media (max-width: 768px) {
      .split-view {
        flex-direction: column;
      }
    }
  
/* ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™” - ìƒ˜í”Œ ëª©ë¡ ìŠ¤í¬ë¡¤ ê°œì„  */
@media (max-width: 768px) {
  .sample-list-scroll {
    max-height: 200px; /* ëª¨ë°”ì¼ì—ì„œ ì•½ê°„ ë” ë†’ê²Œ */
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    /* ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ ì˜ì—­ ëª…í™•í•˜ê²Œ */
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 8px;
  }
  
  /* ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ë°” ë” êµµê²Œ */
  .sample-list-scroll::-webkit-scrollbar {
    width: 6px;
  }
  
  .sample-list-scroll::-webkit-scrollbar-thumb {
    background: #8B5A2B;
    border-radius: 3px;
  }
  
  /* ìƒ˜í”Œ ì•„ì´í…œ í„°ì¹˜ ì˜ì—­ í™•ëŒ€ */
  .sample-item {
    min-height: 50px;
    padding: 8px;
    margin-bottom: 4px;
    touch-action: manipulation;
  }
  
  /* ë“œë˜ê·¸ í•¸ë“¤ í„°ì¹˜ ì˜ì—­ í™•ëŒ€ */
  .sample-drag-handle {
    padding: 8px 6px;
    min-width: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
}
  
    /* í„°ì¹˜ ìµœì í™” - ëª¨ë°”ì¼ */
    @media (max-width: 768px) {
      .flavor-checkbox-label {
        padding: 8px 14px 8px 34px;
        margin: 4px;
        font-size: 14px;
      }
      .flavor-checkbox-label .checkbox-custom {
        width: 20px;
        height: 20px;
        left: 8px;
      }
      .flavor-checkbox-label input:checked + .checkbox-custom:after {
        font-size: 12px;
      }
      .mobile-touch-friendly {
        min-height: 44px;
      }
      .tab-btn-inactive, .tab-btn-active {
        padding: 8px 16px;
        margin-bottom: 8px;
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      input[type="radio"] + span {
        padding: 4px 0;
        margin-left: 4px;
        display: inline-block;
      }
      .score-slider {
        height: 20px;
      }
      .flavor-badge {
        padding: 4px 12px;
        margin: 3px;
      }
      .mobile-touch-friendly {
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      /* ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ëª¨ë°”ì¼ ìµœì í™” */
      .body-descriptor-item {
        padding: 8px 14px 8px 34px;
        margin: 4px;
        font-size: 14px;
        min-height: 44px;
      }
      .body-descriptor-item .checkbox-custom {
        width: 20px;
        height: 20px;
        left: 8px;
      }
      .body-descriptor-item input:checked + .checkbox-custom:after {
        font-size: 12px;
      }
    }
    
    /* ê³ ê¸‰ ë¹„êµ í…Œì´ë¸” */
    .advanced-compare-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      border-radius: 8px;
      overflow: hidden;
    }
    .advanced-compare-table th {
      background: #8B5A2B;
      color: white;
      font-weight: 600;
      text-align: left;
      padding: 10px 12px;
      font-size: 13px;
    }
    .advanced-compare-table td {
      padding: 10px 12px;
      border-bottom: 1px solid #f0f0f0;
      font-size: 13px;
    }
    .advanced-compare-table tr:nth-child(even) {
      background-color: #f9f7f5;
    }
    .advanced-compare-table tr:last-child td {
      border-bottom: none;
    }
    .advanced-compare-table .category-row {
      background-color: #f4eee6;
      font-weight: bold;
    }
    .advanced-compare-category {
      margin-top: 10px;
      margin-bottom: 6px;
      font-weight: bold;
      padding: 6px 8px;
      background-color: #f4eee6;
      border-radius: 4px;
    }
    
    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 50;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }
    .modal.show {
      display: flex;
    }
    .modal-content {
      background-color: white;
      border-radius: 0.5rem;
      max-width: 90%;
      max-height: 90vh;
      overflow: auto;
      width: 1200px;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      border-bottom: 1px solid #e5e7eb;
    }
    .modal-body {
      padding: 1rem;
    }
    
    /* ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€ */
    .search-box {
      position: sticky;
      top: 0;
      background: #f8f8f8;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 8px;
      z-index: 5;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .search-input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }
    
    /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ë†’ì´ ì§€ì • */
    .chart-container {
      position: relative;
      height: 300px;
      width: 100%;
    }
    
    /* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .nav-btn {
      padding: 6px 12px;
      background-color: #f3f4f6;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
      min-height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .nav-btn:hover:not(:disabled) {
      background-color: #e5e7eb;
    }
    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    /* ì–¸ì–´ í† ê¸€ ë²„íŠ¼ */
    .lang-toggle {
      position: absolute;
      right: 10px;
      top: 8px;
      z-index: 5;
      display: inline-flex;
      background: #f4eee6;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .lang-toggle button {
      padding: 4px 8px;
      border: none;
      background: transparent;
      font-size: 12px;
      cursor: pointer;
      min-height: 32px;
      transition: all 0.2s;
    }
    .lang-toggle button.active {
      background: #8B5A2B;
      color: white;
    }
    .lang-toggle button:hover:not(.active) {
      background: #e5d9c7;
    }
    
    /* í–¥ë¯¸ ì¹´í…Œê³ ë¦¬ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
    .flavor-category-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 15px;
    }
    
    .flavor-category-tab {
      padding: 6px 12px;
      background: #f1e7db;
      border-radius: 6px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid transparent;
      min-height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .flavor-category-tab:hover {
      background: #e5d9c7;
    }
    
    .flavor-category-tab.active {
      background: #8B5A2B;
      color: white;
    }
    
    /* í–¥ë¯¸ ì•„ì½”ë””ì–¸ íŒ¨ë„ */
    .flavor-category-wrapper {
      margin-bottom: 10px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .flavor-category-header {
      padding: 10px 15px;
      background: #f1e7db;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      min-height: 44px;
    }
    
    .flavor-category-header h4 {
      margin: 0;
      font-weight: 600;
    }
    
    .flavor-category-content {
      padding: 15px;
      display: none;
      background: white;
    }
    
    .flavor-category-content.show {
      display: block;
    }
    
    /* ìì£¼ ì‚¬ìš©í•˜ëŠ” í–¥ë¯¸ ì„¹ì…˜ */
    .frequently-used-flavors {
      background: #f9f4ea;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 15px;
    }
    
    .frequently-used-flavors h4 {
      font-weight: 600;
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 14px;
    }
    
    /* ê²€ìƒ‰ ê²°ê³¼ ê°•ì¡° */
    .flavor-checkbox-label.search-highlight {
      box-shadow: 0 0 0 2px #8B5A2B;
    }
    
    /* í–¥ë¯¸ ì¹´í…Œê³ ë¦¬ í•„í„° ë²„íŠ¼ */
    .flavor-filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 10px;
    }
    
    .flavor-filter-btn {
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 15px;
      background-color: #f3efe8;
      border: 1px solid #e5e7eb;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .flavor-filter-btn.active {
      background-color: #8B5A2B;
      color: white;
      border-color: #8B5A2B;
    }
    
    /* í–¥ë¯¸ ë°ì´í„° ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
    .flavor-items {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }
    
    /* í–¥ë¯¸ íœ  íŒ¨ì¹˜ ìŠ¤íƒ€ì¼ */
    .flavor-fix-hidden {
      display: none !important;
    }
    
    /* ì„ íƒëœ í–¥ë¯¸ ìŠ¤íƒ€ì¼ ê°•í™” */
    .flavor-checkbox-label.selected-flavor {
      box-shadow: 0 0 0 2px rgba(139, 90, 43, 0.8);
      transform: translateY(-1px);
    }
    
    /* ìë™ ë°±ì—… ì•Œë¦¼ */
    .backup-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(25, 135, 84, 0.9);
      color: white;
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 14px;
      z-index: 9999;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s ease;
    }
    
    .backup-notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* ì–¸ì–´ ë³€ê²½ ì• ë‹ˆë©”ì´ì…˜ */
    .language-transition {
      transition: opacity 0.2s ease-in-out;
    }
    
    .language-transition.fade-out {
      opacity: 0.5;
    }
    
    /* ë°”ë””ê° ì¹´í…Œê³ ë¦¬ í—¤ë” ìŠ¤íƒ€ì¼ */
    .body-category-header {
      font-weight: 600;
      color: #8B5A2B;
      margin: 12px 0 8px 0;
      padding: 4px 8px;
      background: #f9f7f5;
      border-radius: 4px;
      font-size: 14px;
    }
  </style>
</head>
<body class="min-h-screen bg-[#fcfaf7]">
<div class="max-w-5xl mx-auto p-1 md:p-4 bg-[#fcfaf7]">
  <!-- Header -->
  <header class="flex flex-col md:flex-row items-center justify-between py-4 mb-2 border-b border-tan-300 bg-white rounded-lg shadow-sm">
    <div class="flex items-center">
      <svg width="48" height="48" viewBox="0 0 200 200" class="mr-2"><rect width="200" height="200" fill="black"/><path d="M100,40 L120,60 L110,60 L110,80 L115,90 L105,100 C105,100 120,110 130,120 C140,130 120,150 120,150 L80,150 C80,150 60,130 70,120 C80,110 95,100 95,100 L85,90 L90,80 L90,60 L80,60 Z" fill="#D2B48C"/><circle cx="95" cy="60" r="2" fill="#D2B48C"/><circle cx="105" cy="70" r="2" fill="#D2B48C"/><circle cx="115" cy="65" r="2" fill="#D2B48C"/></svg>
      <span class="text-2xl md:text-3xl font-bold text-tan-900 select-none">mollis</span>
    </div>
    <div class="mt-3 md:mt-0 text-center md:text-right">
      <h2 class="text-lg md:text-2xl font-semibold">SCA ì»¤í”¼ ê´€ëŠ¥ í‰ê°€ (ê°œì„ ë²„ì „)</h2>
      <div class="text-xs text-gray-500 mt-1">PC/ëª¨ë°”ì¼ ëŒ€ì‘ Â· PDF ì €ì¥ ìµœì  Â· í™•ì¥í˜• ë°”ë””ê°/í–¥ë¯¸ ì¶”ê°€ Â· ê°œì„ ëœ UI/UX</div>
    </div>
  </header>
  
  <!-- Sample/Data/Compare Section -->
  <section class="bg-white shadow rounded-lg p-3 md:p-6 mb-3 flex flex-col md:flex-row gap-3">
    <!-- ìƒ˜í”Œ ê´€ë¦¬ -->
    <div class="flex-1 min-w-[260px] mb-3 md:mb-0">
      <div class="mb-3 bg-yellow-50 border border-yellow-200 rounded px-2 py-2 flex items-center text-xs text-yellow-800 leading-5">
        <i class="fa fa-info-circle mr-2"></i>
        <div>
          <span class="font-semibold">ìƒ˜í”Œ ê´€ë¦¬ ë°©ë²• ì•ˆë‚´:</span><br>
          - <b>ìƒ˜í”Œ ì¶”ê°€</b>ë¡œ ìƒˆë¡œìš´ ì»¤í”¼ í‰ê°€ë¥¼ ê¸°ë¡/ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
          - <b>ìƒ˜í”Œ ì„ íƒ</b>ì‹œ í•´ë‹¹ ìƒ˜í”Œ ë‚´ìš©ì„ ìƒì„¸ í¸ì§‘/ì €ì¥í•˜ë©°, ìë™ì €ì¥ì´ ì§€ì›ë©ë‹ˆë‹¤.<br>
          - <b>ì›¹ì— ì „ì²´ ì €ì¥</b> ë˜ëŠ” <b>ì›¹ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</b> ë²„íŠ¼ì„ í†µí•´ LocalStorageì— ì „ì²´ í‰ê°€ ë‚´ì—­ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
          - <b>JSON ë‚´ë³´ë‚´ê¸°</b> ë° <b>ë¶ˆëŸ¬ì˜¤ê¸°</b> ê¸°ëŠ¥ì„ í†µí•´ ë°ì´í„°ë¥¼ íŒŒì¼ë¡œ ë³´ê´€/ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
      </div>
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fa fa-database mr-2"></i>ìƒ˜í”Œ ê´€ë¦¬/ë¶ˆëŸ¬ì˜¤ê¸°</h3>
      <div class="flex items-center gap-1 mb-2">
        <button class="px-2 py-1 export-btn rounded text-xs flex items-center mobile-touch-friendly" id="addSampleBtn"><i class="fa fa-plus mr-2"></i>ìƒ˜í”Œ ì¶”ê°€</button>
        <button class="px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded text-xs flex items-center mobile-touch-friendly" id="removeSampleBtn"><i class="fa fa-trash mr-2"></i>ìƒ˜í”Œ ì‚­ì œ</button>
        <button class="px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs flex items-center mobile-touch-friendly" id="cloneSampleBtn"><i class="fa fa-copy mr-2"></i>ë³µì œ</button>
      </div>
      <div class="sample-list-scroll bg-gray-50 rounded-lg border p-1.5 no-scrollbar">
        <div id="sampleList" class="sample-sortable-list"></div>
        <div class="text-xs text-gray-500 mt-2 px-2">
  <i class="fas fa-arrows-alt"></i> ìƒ˜í”Œ ìˆœì„œë¥¼ ë“œë˜ê·¸í•˜ì—¬ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  <div class="text-xs text-gray-400 mt-1">
    ğŸ“± ëª¨ë°”ì¼: ìœ„ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•˜ì—¬ ë” ë§ì€ ìƒ˜í”Œì„ í™•ì¸í•˜ì„¸ìš”.
  </div>
</div>
      </div>
      <div class="flex flex-wrap gap-1 mt-2">
        <button class="px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded text-xs flex items-center mobile-touch-friendly" id="saveSamplesBtn"><i class="fa fa-save mr-1"></i>ì›¹ì— ì „ì²´ ì €ì¥</button>
        <button class="px-3 py-1 bg-blue-200 hover:bg-blue-300 text-blue-900 rounded text-xs flex items-center mobile-touch-friendly" id="loadSamplesWebBtn"><i class="fa fa-cloud-download-alt mr-1"></i>ì›¹ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <button class="px-3 py-1 bg-green-100 hover:bg-green-200 text-green-800 rounded text-xs flex items-center mobile-touch-friendly" id="exportSamplesBtn"><i class="fa fa-download mr-1"></i>JSON ë‚´ë³´ë‚´ê¸°</button>
        <label class="px-3 py-1 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 rounded text-xs flex items-center cursor-pointer mb-0 mobile-touch-friendly"><i class="fa fa-upload mr-1"></i>ë¶ˆëŸ¬ì˜¤ê¸°<input type="file" id="importSamplesInput" accept=".json" class="hidden"></label>
        <button class="px-3 py-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-800 rounded text-xs flex items-center mobile-touch-friendly" id="backupManageBtn"><i class="fa fa-history mr-1"></i>ë°±ì—… ë³µì›</button>
      </div>
    </div>
    
    <!-- ì»¤í•‘ ë¹„êµ -->
    <div class="flex-1 min-w-[260px]">
      <div class="mb-3 bg-blue-50 border border-blue-200 rounded px-2 py-2 flex items-center text-xs text-blue-800 leading-5">
        <i class="fa fa-info-circle mr-2"></i>
        <div>
          <span class="font-semibold">ì»¤í•‘ ê¸°ë¡ ë¹„êµ ì•ˆë‚´:</span><br>
          - <b>ì•„ë˜ í‰ê°€ ëª©ë¡ì—ì„œ 2ê°œ ì´ìƒ ì„ íƒ</b> í›„ <b>ë¹„êµì°¨íŠ¸ í‘œì‹œ</b>ë¥¼ í´ë¦­í•˜ë©´ SCA ì ìˆ˜/í–¥ë¯¸/ê²°ì  ë¹„êµì°¨íŠ¸ì™€ í‘œê°€ ìƒì„±ë©ë‹ˆë‹¤.<br>
          - ë‹¤ì–‘í•œ ìƒ˜í”Œì„ ì¶”ê°€í•œ í›„, ì†ì‰½ê²Œ ì°¨íŠ¸ë¡œ ë¹„êµãƒ»ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>
          - ìƒ˜í”Œì„ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë¶ˆëŸ¬ì˜¨ í›„ì—ë„ ë¹„êµê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥.<br>
          <span class="text-gray-400">â€» ë¹„êµ í‘œì™€ ì°¨íŠ¸ëŠ” PDF, ì´ë¯¸ì§€ ë“±ìœ¼ë¡œ ì €ì¥ì‹œ í•¨ê»˜ ì¶œë ¥ë¨.</span>
        </div>
      </div>
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fas fa-code-compare mr-2"></i>ì»¤í•‘ ê¸°ë¡ ë¹„êµ</h3>
      <div id="compareListBox" class="mb-2"></div>
      <div class="flex gap-2 flex-wrap"> 
        <button class="export-btn text-xs px-3 py-1 rounded flex items-center mb-2 mobile-touch-friendly" id="compareBtn">
          <i class="fa fa-chart-radar mr-1"></i>ê¸°ë³¸ ë¹„êµ
        </button>
        <button class="bg-indigo-600 hover:bg-indigo-700 text-white text-xs px-3 py-1 rounded flex items-center mb-2 mobile-touch-friendly" id="advancedCompareBtn">
          <i class="fa fa-chart-line mr-1"></i>ê³ ê¸‰ ë¹„êµ
        </button>
        <button class="bg-purple-600 hover:bg-purple-700 text-white text-xs px-3 py-1 rounded flex items-center mb-2 mobile-touch-friendly" id="splitViewBtn">
          <i class="fa fa-columns mr-1"></i>ë¶„í•  í™”ë©´
        </button>
      </div>
      <div id="compareArea"><div class="text-xs text-gray-400 my-2">2ê°œ ì´ìƒ ìƒ˜í”Œì„ ì„ íƒ í›„ ë¹„êµ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div></div>
    </div>
  </section>
  
  <!-- ìƒ˜í”Œ ë„¤ë¹„ê²Œì´ì…˜ -->
  <div class="mb-3 bg-white shadow rounded-lg p-3 flex items-center justify-between">
    <button id="prevSampleBtn" class="nav-btn mobile-touch-friendly">
      <i class="fas fa-chevron-left mr-1"></i>ì´ì „
    </button>
    <div id="currentSampleIndicator" class="font-bold text-center flex-1 truncate mx-2">í˜„ì¬ ìƒ˜í”Œ: <span class="text-amber-700"></span></div>
    <button id="nextSampleBtn" class="nav-btn mobile-touch-friendly">
      ë‹¤ìŒ<i class="fas fa-chevron-right ml-1"></i>
    </button>
  </div>
  
  <!-- í‰ê°€ í¼ -->
  <form id="cuppingForm" class="bg-white shadow rounded-lg p-3 md:p-6 mb-4 sample-info">
    <div class="flex flex-wrap items-center gap-2 mb-2">
      <div class="font-bold text-lg mr-2 mb-1">í˜„ì¬ ìƒ˜í”Œëª…:</div>
      <input id="sampleTitleInput" type="text" maxlength="60" class="p-1.5 border rounded min-w-[140px] text-base font-semibold" placeholder="ìƒ˜í”Œëª…">
      <span id="sampleSavedState" class="ml-2 text-green-700 font-bold text-xs hidden">ì €ì¥ë¨</span>
    </div>
    
    <!-- ì»¤í”¼ ì •ë³´ -->
    <section>
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fas fa-mug-hot mr-2"></i>ì»¤í”¼ ì •ë³´</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-4 grid-cols-sample">
        <div>
          <label class="block text-sm font-semibold mb-1">ì»¤í”¼ëª…</label>
          <input class="coffee-input w-full border border-tan-300 rounded p-2" id="coffeeName" autocomplete="off">
        </div>
        <div>
          <label class="block text-sm font-semibold mb-1">ì›ì‚°ì§€</label>
          <select class="coffee-input w-full border border-tan-300 rounded p-2" id="origin">
            <option value="">ì„ íƒ</option>
            <option value="Costa Rica">Costa Rica</option>
            <option value="Guatemala">Guatemala</option>
            <option value="Honduras">Honduras</option>
            <option value="El Salvador">El Salvador</option>
            <option value="Nicaragua">Nicaragua</option>
            <option value="Panama">Panama</option>
            <option value="Brazil">Brazil</option>
            <option value="Colombia">Colombia</option>
            <option value="Peru">Peru</option>
            <option value="Ecuador">Ecuador</option>
            <option value="Bolivia">Bolivia</option>
            <option value="Ethiopia">Ethiopia</option>
            <option value="Kenya">Kenya</option>
            <option value="Uganda">Uganda</option>
            <option value="Rwanda">Rwanda</option>
            <option value="Burundi">Burundi</option>
            <option value="Tanzania">Tanzania</option>
            <option value="Indonesia">Indonesia</option>
            <option value="Vietnam">Vietnam</option>
            <option value="India">India</option>
            <option value="Thailand">Thailand</option>
            <option value="Yemen">Yemen</option>            
          </select>
        </div>
        <div>
          <label class="block text-sm font-semibold mb-1">í’ˆì¢…(Variety)</label>
          <input class="coffee-input w-full border border-tan-300 rounded p-2" id="variety" autocomplete="off">
        </div>
        <div>
          <label class="block text-sm font-semibold mb-1">ê°€ê³µë°©ì‹(Process)</label>
          <select class="coffee-input w-full border border-tan-300 rounded p-2" id="process">
            <option value="">ì„ íƒ</option>
            <option value="Washed">Washed</option>
            <option value="Natural">Natural</option>
            <option value="Honey">Honey</option>
            <option value="Anaerobic Natural">Anaerobic Natural</option>
            <option value="Anaerobic Washed">Anaerobic Washed</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-semibold mb-1">ë¡œìŠ¤íŒ… ë‚ ì§œ</label>
          <input type="date" class="coffee-input w-full border border-tan-300 rounded p-2" id="roastDate">
        </div>
        <div>
          <label class="block text-sm font-semibold mb-1">ë¡œìŠ¤íŒ… ë ˆë²¨</label>
          <select class="coffee-input w-full border border-tan-300 rounded p-2" id="roastLevel">
            <option value="">ì„ íƒ</option>
            <option value="light">Light</option>
            <option value="medium-light">Medium-Light</option>
            <option value="medium">Medium</option>
            <option value="medium-dark">Medium-Dark</option>
            <option value="dark">Dark</option>
          </select>
        </div>
      </div>
    </section>
    
    <!-- SCA í–¥ë¯¸ ì„ íƒ -->
    <section class="mt-8">
      <h3 class="text-base font-bold mb-1 border-b pb-1 border-tan-200 flex items-center"><i class="fa fa-circle-half-stroke mr-2"></i>SCA í–¥ë¯¸ ì„ íƒ</h3>
      <div class="text-xs mb-3 text-gray-600">[í”„ë˜ê·¸ëŸ°ìŠ¤] [ì•„ë¡œë§ˆ] [í”Œë ˆì´ë²„] [ì—í”„í„°í…Œì´ìŠ¤íŠ¸] ê° ê·¸ë£¹ë³„ í–¥ë¯¸ ì„ íƒ</div>
      <div class="mb-4 flex flex-wrap items-center">
        <button type="button" class="px-2 py-1 rounded bg-gray-100 text-xs mobile-touch-friendly mr-2" onclick="window.open('https://sca.coffee/research/coffee-tasters-flavor-wheel', '_blank');">
          í”Œë ˆì´ë²„ íœ  ê³µì‹ìë£Œ <i class="fas fa-external-link-alt ml-1 text-xs"></i>
        </button>
        <div class="lang-toggle">
          <button type="button" id="langEn" class="active">ì˜ì–´</button>
          <button type="button" id="langKo">í•œê¸€</button>
        </div>
      </div>
      <div id="flavorTabs" class="flex flex-wrap gap-2 mb-2"></div>
      <div id="flavorWheelMultiSelectArea" class="flavor-section border border-gray-50 rounded-lg p-2 bg-gray-50 mb-1"></div>
    </section>
    
    <!-- ë‹¨ê³„ ì†ì„± -->
    <section class="mt-8">
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div>
          <label class="block mb-1 font-medium tooltip">
            Acidity <span class="text-xs text-gray-500">(ì‚°ë¯¸)</span>
            <span class="tooltip-text">ì»¤í”¼ì˜ ë°ê³  ìƒì¾Œí•œ íŠ¹ì„±ìœ¼ë¡œ ì…ì—ì„œ ëŠê»´ì§€ëŠ” ì‹ ë§›ì˜ ì •ë„</span>
          </label>
          <div class="flex gap-2 flex-wrap" id="acidity_level">
            <label class="mobile-touch-friendly"><input type="radio" name="acidityLevel" value="Low"><span class="ml-1">Low</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="acidityLevel" value="Med-Low"><span class="ml-1">Med-Low</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="acidityLevel" value="Medium"><span class="ml-1">Medium</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="acidityLevel" value="Med-High"><span class="ml-1">Med-High</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="acidityLevel" value="High"><span class="ml-1">High</span></label>
          </div>
        </div>
        <div>
          <label class="block mb-1 font-medium tooltip">
            Sweetness <span class="text-xs text-gray-500">(ë‹¨ë§›)</span>
            <span class="tooltip-text">ì»¤í”¼ì—ì„œ ëŠê»´ì§€ëŠ” ë‹¬ì½¤í•¨ì˜ ì •ë„ì™€ ê¹Šì´</span>
          </label>
          <div class="flex gap-2 flex-wrap" id="sweetness_level">
            <label class="mobile-touch-friendly"><input type="radio" name="sweetnessLevel" value="Low"><span class="ml-1">Low</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="sweetnessLevel" value="Med-Low"><span class="ml-1">Med-Low</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="sweetnessLevel" value="Medium"><span class="ml-1">Medium</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="sweetnessLevel" value="Med-High"><span class="ml-1">Med-High</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="sweetnessLevel" value="High"><span class="ml-1">High</span></label>
          </div>
        </div>
        <div>
          <label class="block mb-1 font-medium tooltip">
            Body <span class="text-xs text-gray-500">(ë°”ë””ê°)</span>
            <span class="tooltip-text">ì»¤í”¼ì˜ ì§ˆê°ê³¼ ë¬´ê²Œê°, ì…ì•ˆì—ì„œ ëŠê»´ì§€ëŠ” ë°€ë„</span>
          </label>
          <div class="flex gap-2 flex-wrap" id="body_level">
            <label class="mobile-touch-friendly"><input type="radio" name="bodyLevel" value="Low"><span class="ml-1">Low</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="bodyLevel" value="Med-Low"><span class="ml-1">Med-Low</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="bodyLevel" value="Medium"><span class="ml-1">Medium</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="bodyLevel" value="Med-High"><span class="ml-1">Med-High</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="bodyLevel" value="High"><span class="ml-1">High</span></label>
          </div>
        </div>
      </div>
    </section>
    
    <!-- ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ì„¹ì…˜ ê°œì„  -->
    <section class="mt-8">
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fas fa-hand-paper mr-2"></i><span data-i18n="body-descriptor-title">ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°</span></h3>
      <div class="text-xs mb-3 text-gray-600">
        <span data-i18n="body-descriptor-desc">ì»¤í”¼ì˜ ì§ˆê°, ë°€ë„, ë¬´ê²Œê°ì„ í‘œí˜„í•˜ëŠ” ì„¸ë¶€ íŠ¹ì„±ì„ ì„ íƒí•˜ì„¸ìš” (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</span>
      </div>
      <div class="body-descriptor-section">
        <div id="bodyDescriptorArea" class="body-descriptor-grid">
          <!-- ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°ë“¤ì´ JavaScriptë¡œ ë™ì  ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
        <div class="text-xs text-gray-500 mt-3">
          <i class="fas fa-info-circle mr-1"></i>
          <span data-i18n="body-descriptor-help">ì„ íƒëœ í•­ëª©ì€ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œë©ë‹ˆë‹¤. í´ë¦­í•˜ì—¬ ì„ íƒ/í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
        </div>
      </div>
    </section>
    
    <!-- ë¡œìŠ¤íŒ… ë””í™íŠ¸ -->
    <section class="mt-10" id="section-defect">
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fa fa-fire mr-2"></i>ë¡œìŠ¤íŒ… ë””í™íŠ¸(ê²°ì ) ì„ íƒ</h3>
      <div class="text-xs mb-2 text-gray-600"> ê° í•­ëª©ë³„ë¡œ ê²°ì ì˜ ì •ë„(ë§¤ìš° ì•½í•¨, ì•½í•¨, ë³´í†µ, ê°•í•¨, ë§¤ìš° ê°•í•¨)ë¥¼ ì„ íƒí•˜ì„¸ìš”. <span class="text-gray-400 ml-1">* ì™œê³¡ë˜ì§€ ì•Šì€ í‰ê°€ë¥¼ ìœ„í•´ ê²°ì ì´ ì—†ìœ¼ë©´ "ë¯¸ì„ íƒ"ìœ¼ë¡œ ë‘¡ë‹ˆë‹¤.</span> </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <div>
          <label class="font-semibold mb-1 flex items-center"> ì–¸ë”ë””ë²¨ë¡­ë¨¼íŠ¸
            <span class="tooltip text-xs ml-2 text-gray-500"><i class="fa fa-info-circle"></i> 
              <span class="tooltip-text">
                ë¡œìŠ¤íŒ…ì„ í†µí•´ ì‚°ë¯¸, ë‹¨ë§›, í”Œë ˆì´ë²„ê°€ ë¶ˆì¶©ë¶„í•˜ê²Œ ë°œí˜„.<br>
                ê³µê²©ì ì¸ ì‚°ë¯¸, í”¼ë‹ˆì‹œ/ì• í”„í„°í…Œì´ìŠ¤íŠ¸ ë¶€ì¡±,<br>
                êµ¬ê°œ ì•ìª½ì—ì„œ í”Œë ˆì´ë²„ê°€ ëŠê»´ì§.<br>
                <span class="font-semibold">SCA í”Œë ˆì´ë²„íœ  'Green/Vegetative'ì™€ ê´€ë ¨.</span>
              </span>
            </span>
          </label>
          <div class="flex gap-2 flex-wrap mt-1" id="defect_underdevelopment">
            <label class="mobile-touch-friendly"><input type="radio" name="defectUnderdevelopment" value="none"><span class="ml-1">ë¯¸ì„ íƒ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectUnderdevelopment" value="very_weak"><span class="ml-1">ë§¤ìš° ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectUnderdevelopment" value="weak"><span class="ml-1">ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectUnderdevelopment" value="moderate"><span class="ml-1">ë³´í†µ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectUnderdevelopment" value="strong"><span class="ml-1">ê°•í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectUnderdevelopment" value="very_strong"><span class="ml-1">ë§¤ìš° ê°•í•¨</span></label>
          </div>
        </div>
        <div>
          <label class="font-semibold mb-1 flex items-center"> ì˜¤ë²„ë””ë²¨ë¡­ë¨¼íŠ¸
            <span class="tooltip text-xs ml-2 text-gray-500"><i class="fa fa-info-circle"></i> 
              <span class="tooltip-text">
                ê³¼ë„í•œ ë¡œìŠ¤íŒ…ìœ¼ë¡œ í”Œë ˆì´ë²„ê°€ íŒŒê´´.<br>ëª¨ë“  ì‚°ë¯¸ì™€ í”Œë ˆì´ë²„ê°€ ì‚¬ë¼ì§„ ë§›.<br>
                <span class="font-semibold">SCA í”Œë ˆì´ë²„íœ  'Roasted'ì™€ ê´€ë ¨.</span>
              </span>
            </span>
          </label>
          <div class="flex gap-2 flex-wrap mt-1" id="defect_overdevelopment">
            <label class="mobile-touch-friendly"><input type="radio" name="defectOverdevelopment" value="none"><span class="ml-1">ë¯¸ì„ íƒ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectOverdevelopment" value="very_weak"><span class="ml-1">ë§¤ìš° ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectOverdevelopment" value="weak"><span class="ml-1">ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectOverdevelopment" value="moderate"><span class="ml-1">ë³´í†µ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectOverdevelopment" value="strong"><span class="ml-1">ê°•í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectOverdevelopment" value="very_strong"><span class="ml-1">ë§¤ìš° ê°•í•¨</span></label>
          </div>
        </div>
        <div>
          <label class="font-semibold mb-1 flex items-center"> ë² ì´í‚¹(ë² ì´í¬ë“œ)
            <span class="tooltip text-xs ml-2 text-gray-500"><i class="fa fa-info-circle"></i> 
              <span class="tooltip-text">
                ìºëŸ¬ë©œ ë°˜ì‘ ì§€ì†ì‹œ ìƒê¸°ëŠ” ê²°ì .<br>íŒì½˜, ë”±ë”±í•œ ì‹œë¦¬ì–¼, ê·€ë¦¬ë§› ë“±.<br>
                <span class="font-semibold">SCA í”Œë ˆì´ë²„íœ  'ê³¡ë¬¼ë¥˜'ì™€ ê´€ë ¨.</span>
              </span>
            </span>
          </label>
          <div class="flex gap-2 flex-wrap mt-1" id="defect_baked">
            <label class="mobile-touch-friendly"><input type="radio" name="defectBaked" value="none"><span class="ml-1">ë¯¸ì„ íƒ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectBaked" value="very_weak"><span class="ml-1">ë§¤ìš° ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectBaked" value="weak"><span class="ml-1">ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectBaked" value="moderate"><span class="ml-1">ë³´í†µ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectBaked" value="strong"><span class="ml-1">ê°•í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectBaked" value="very_strong"><span class="ml-1">ë§¤ìš° ê°•í•¨</span></label>
          </div>
        </div>
        <div>
          <label class="font-semibold mb-1 flex items-center"> ìŠ¤ì½”ì¹­
            <span class="tooltip text-xs ml-2 text-gray-500"><i class="fa fa-info-circle"></i> 
              <span class="tooltip-text">
                ê³¼í•˜ê²Œ ë†’ì€ ì—´ì— ë…¸ì¶œëœ ê²°ì .<br>SCA í”Œë ˆì´ë²„íœ ì˜ 'ì¬' ë˜ëŠ” 'íƒ„ ë§›' ë…¸íŠ¸.<br>
              </span>
            </span>
          </label>
          <div class="flex gap-2 flex-wrap mt-1" id="defect_scorching">
            <label class="mobile-touch-friendly"><input type="radio" name="defectScorching" value="none"><span class="ml-1">ë¯¸ì„ íƒ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectScorching" value="very_weak"><span class="ml-1">ë§¤ìš° ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectScorching" value="weak"><span class="ml-1">ì•½í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectScorching" value="moderate"><span class="ml-1">ë³´í†µ</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectScorching" value="strong"><span class="ml-1">ê°•í•¨</span></label>
            <label class="mobile-touch-friendly"><input type="radio" name="defectScorching" value="very_strong"><span class="ml-1">ë§¤ìš° ê°•í•¨</span></label>
          </div>
        </div>
      </div>
    </section>
    
    <!-- SCA ì ìˆ˜ (ìŠ¬ë¼ì´ë”ë³„ ì ìˆ˜ì…ë ¥) -->
    <section class="mt-10">
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fa fa-star mr-2"></i>SCA ì ìˆ˜ (0~10ì , 0.25ë‹¨ìœ„)</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-2 score-input-wrap">
        <div>
          <label class="block text-sm mb-1 tooltip">í”„ë˜ê·¸ëŸ°ìŠ¤<span class="tooltip-text">ë¶„ì‡„í•œ ë¶„ë§ ì‹œ ëŠê»´ì§€ëŠ” í–¥</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreFragrance_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreFragrance" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">ì•„ë¡œë§ˆ<span class="tooltip-text">ë¬¼ ë¶€ì€ í›„ ëŠê»´ì§€ëŠ” í–¥</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreAroma_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreAroma" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">í”Œë ˆì´ë²„<span class="tooltip-text">í˜€ë¡œ ëŠê»´ì§€ëŠ” ì»¤í”¼ì˜ ì „ë°˜ì  ë§› íŠ¹ì„±</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreFlavor_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreFlavor" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">ì—í”„í„°í…Œì´ìŠ¤íŠ¸<span class="tooltip-text">ì‚¼í‚¨ í›„ ì…ì•ˆì— ë‚¨ëŠ” ì¢‹ì€ ë§›ì˜ ì§€ì†ì„±</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreAftertaste_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreAftertaste" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">ì•¡ì‹œë””í‹°<span class="tooltip-text">ë°ì€ ì‚°ë¯¸, ê¸ì •ì ì´ë©´ ë†’ê²Œ</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreAcidity_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreAcidity" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">ë°”ë””<span class="tooltip-text">ì…ì•ˆì—ì„œ ëŠê»´ì§€ëŠ” ë¬´ê²Œê°, ì§ˆê°</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreBody_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreBody" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">ë°¸ëŸ°ìŠ¤<span class="tooltip-text">ê° í•­ëª©ì˜ ì¡°í™”</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreBalance_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreBalance" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
        <div>
          <label class="block text-sm mb-1 tooltip">ì˜¤ë²„ëŸ´<span class="tooltip-text">ì´í‰, ì¸ìƒ</span></label>
          <input type="range" min="0" max="10" step="0.25" value="7" id="scoreOverall_slider" class="score-slider mb-1">
          <input type="number" step="0.25" min="0" max="10" id="scoreOverall" class="coffee-input w-full p-1.5 text-center border rounded" value="7">
        </div>
      </div>
      <div class="mt-4 flex flex-wrap items-end gap-3">
        <div>
          <label class="text-sm block mb-1">ì´ì  (ê¸°ë³¸ 30ì +í•©ê³„)</label>
          <span id="totalScore" class="font-bold inline-block text-lg bg-gray-100 px-4 py-2 rounded border">86.00</span>
        </div>
        <button type="button" id="calcScoreBtn" class="ml-1 mt-2 px-4 py-2 rounded export-btn flex items-center mobile-touch-friendly"><i class="fas fa-equals mr-2"></i>ì ìˆ˜ ê³„ì‚°</button>
      </div>
    </section>
    
    <!-- í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ -->
    <section class="mt-10">
      <h3 class="text-base font-bold mb-1 border-b pb-1 border-tan-200 flex items-center"><i class="fas fa-pen-nib mr-2"></i>í…Œì´ìŠ¤íŒ… ë…¸íŠ¸/ë¹„ê³ </h3>
      <textarea id="tastingNotes" class="coffee-input w-full min-h-[80px] p-2 border rounded" placeholder="íŠ¹ì´ì‚¬í•­, ì‹œê°„, ì˜¨ë„, ì»¤í•‘ ì´í‰ ë“± ë©”ëª¨"></textarea>
    </section>
    
    <!-- ê²°ê³¼ ì‹œê°í™” ë° ë‚´ë³´ë‚´ê¸° -->
    <section class="mt-10">
      <h3 class="text-base font-bold mb-2 border-b pb-1 border-tan-200 flex items-center"><i class="fa fa-chart-radar mr-2"></i>ê²°ê³¼ ì‹œê°í™” ë° ë‚´ë³´ë‚´ê¸°</h3>
      <div id="visualSection" class="visual-section-flex w-full mt-2">
        <div class="bg-white rounded-lg p-4 shadow-md flex-1 min-w-0 mb-2">
          <h4 class="font-semibold mb-2">í–¥ë¯¸ íŠ¹ì„±/ì†ì„±</h4>
          <div id="selectedFlavorsArea"></div>
        </div>
        <div class="bg-white rounded-lg p-4 shadow-md flex-1 min-w-0">
          <h4 class="font-semibold mb-2">SCA í‰ê°€ ë ˆì´ë” ì°¨íŠ¸</h4>
          <canvas id="cuppingRadar" class="w-full max-w-full" height="200"></canvas>
        </div>
      </div>
      <div class="flex flex-wrap mt-6 gap-2">
        <button id="exportImgBtn" type="button" class="export-btn px-6 py-2 rounded flex items-center mobile-touch-friendly"><i class="fas fa-image mr-2"></i>ì´ë¯¸ì§€ë¡œ ë‚´ë³´ë‚´ê¸°</button>
        <button id="exportSnsImgBtn" type="button" class="sns-export-btn px-6 py-2 rounded flex items-center mobile-touch-friendly"><i class="fas fa-share-alt mr-2"></i>SNSí˜• ì´ë¯¸ì§€</button>
        <button id="exportXlsxBtn" type="button" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded flex items-center mobile-touch-friendly"><i class="fas fa-file-excel mr-2"></i>ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°</button>
      </div>
      <div class="text-xs text-gray-400 mt-8 md:mt-12 text-center"> í‰ê°€ì¼: <span id="evalDate"></span> | mollis SCA ì»¤í”¼ ê´€ëŠ¥ í‰ê°€</div>
    </section>
  </form>
</div>

<!-- ë¶„í•  í™”ë©´ ë¹„êµ ëª¨ë‹¬ -->
<div id="splitViewModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="font-bold text-lg">ë¶„í•  í™”ë©´ ë¹„êµ</h3>
      <button id="closeSplitViewBtn" class="text-gray-500 hover:text-gray-700 mobile-touch-friendly">
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>
    <div class="modal-body">
      <div class="flex gap-2 mb-4 flex-wrap">
        <div class="flex-1 min-w-[200px]">
          <label class="block text-sm font-medium mb-1">ì™¼ìª½ ìƒ˜í”Œ</label>
          <select id="leftSampleSelect" class="w-full border rounded p-2 mobile-touch-friendly"></select>
        </div>
        <div class="flex-1 min-w-[200px]">
          <label class="block text-sm font-medium mb-1">ì˜¤ë¥¸ìª½ ìƒ˜í”Œ</label>
          <select id="rightSampleSelect" class="w-full border rounded p-2 mobile-touch-friendly"></select>
        </div>
      </div>
      <div class="split-view" id="splitViewContainer">
        <div class="split-view-container" id="leftSampleView">
          <div class="text-center text-gray-500">ì™¼ìª½ ìƒ˜í”Œì„ ì„ íƒí•˜ì„¸ìš”</div>
        </div>
        <div class="split-view-container" id="rightSampleView">
          <div class="text-center text-gray-500">ì˜¤ë¥¸ìª½ ìƒ˜í”Œì„ ì„ íƒí•˜ì„¸ìš”</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>
<div id="sampleToast" class="sample-toast"></div>

<script>
/* === 1ë‹¨ê³„: ê¸°ë³¸ ë°ì´í„° êµ¬ì¡° ë° ìƒìˆ˜ ì •ì˜ === */

// í™•ì¥ëœ í–¥ë¯¸ ë°ì´í„° - ì²¨ë¶€ëœ ì»¤í”¼ í”Œë ˆì´ë²„ íœ  ì°¸ê³ í•˜ì—¬ ëŒ€í­ í™•ì¥
const FLAVOR_DATA = [
  // Fruity - Citrus Fruit (ê°ê·¤ë¥˜ í™•ì¥)
  ["Fruity","Citrus Fruit","Lemon","#FFEB88","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ë ˆëª¬"],
  ["Fruity","Citrus Fruit","Orange","#FFC300","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ì˜¤ë Œì§€"],
  ["Fruity","Citrus Fruit","Grapefruit","#FF9970","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ìëª½"],
  ["Fruity","Citrus Fruit","Lime","#C0E57B","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ë¼ì„"],  
  ["Fruity","Citrus Fruit","Tangerine","#FFA54F","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ê·¤"],
  ["Fruity","Citrus Fruit","Yuzu","#EFDF48","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ìœ ì"],
  ["Fruity","Citrus Fruit","Kumquat","#FFA07A","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ê¸ˆê·¤"],
  ["Fruity","Citrus Fruit","Citron","#F0E68C","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ì‹œíŠ¸ë¡ "],
  ["Fruity","Citrus Fruit","Blood Orange","#FF4500","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ë¸”ëŸ¬ë“œ ì˜¤ë Œì§€"],
  ["Fruity","Citrus Fruit","Mandarin","#FFAE42","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ë§Œë‹¤ë¦°"],
  ["Fruity","Citrus Fruit","Pomelo","#FDDA0D","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","í¼ë©œë¡œ"],
  ["Fruity","Citrus Fruit","Key Lime","#B6E2A1","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","í‚¤ë¼ì„"],
  ["Fruity","Citrus Fruit","Bergamot","#F9D949","ê³¼ì¼ë¥˜","ê°ê·¤ë¥˜","ë² ë¥´ê°€ëª»"],
  
  // Fruity - Other Fruit (ê¸°íƒ€ ê³¼ì¼ í™•ì¥)
  ["Fruity","Other Fruit","Apple","#C4E8A2","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ì‚¬ê³¼"],
  ["Fruity","Other Fruit","Green Apple","#8DB600","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ì²­ì‚¬ê³¼"],
  ["Fruity","Other Fruit","Red Apple","#FF6347","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ë¹¨ê°„ì‚¬ê³¼"],
  ["Fruity","Other Fruit","Pear","#D6ECC2","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ë°°"],
  ["Fruity","Other Fruit","Asian Pear","#E8DACC","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ë°°(ë™ì–‘ë°°)"],
  ["Fruity","Other Fruit","Grape","#A288E3","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","í¬ë„"],
  ["Fruity","Other Fruit","White Grape","#E6E8FA","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ì²­í¬ë„"],
  ["Fruity","Other Fruit","Red Grape","#B19CD9","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ì í¬ë„"],
  ["Fruity","Other Fruit","Kiwi","#8FBC8F","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","í‚¤ìœ„"],
  ["Fruity","Other Fruit","Watermelon","#E8B4B8","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ìˆ˜ë°•"],
  ["Fruity","Other Fruit","Melon","#D1E9B0","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ë©œë¡ "],
  ["Fruity","Other Fruit","Cantaloupe","#FDAC53","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ìº”í„¸ë¡­ ë©œë¡ "],
  ["Fruity","Other Fruit","Honeydew","#CCEBC5","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","í—ˆë‹ˆë“€ ë©œë¡ "],
  ["Fruity","Other Fruit","Persimmon","#FF8C00","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ê°"],
  ["Fruity","Other Fruit","Pomegranate","#C71585","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ì„ë¥˜"],
  ["Fruity","Other Fruit","Quince","#E3B14E","ê³¼ì¼ë¥˜","ê¸°íƒ€ ê³¼ì¼ë¥˜","ë§ˆë¥´ë©œë¡œ"],
  
  // Fruity - Berry (ë² ë¦¬ë¥˜ í™•ì¥)
  ["Fruity","Berry","Raspberry","#FF8BA0","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¼ì¦ˆë² ë¦¬"],
  ["Fruity","Berry","Strawberry","#FF97A1","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë”¸ê¸°"],
  ["Fruity","Berry","Wild Strawberry","#FF6B8A","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ì•¼ìƒ ë”¸ê¸°"],
  ["Fruity","Berry","Blackberry","#D7263D","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¸”ë™ë² ë¦¬"],
  ["Fruity","Berry","Blueberry","#7099DA","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¸”ë£¨ë² ë¦¬"],  
  ["Fruity","Berry","Cranberry","#E30B5C","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","í¬ëœë² ë¦¬"],
  ["Fruity","Berry","Acai","#71466F","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ì•„ì‚¬ì´ë² ë¦¬"],
  ["Fruity","Berry","Goji Berry","#B22222","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","êµ¬ê¸°ì"],
  ["Fruity","Berry","Elderberry","#654321","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ì—˜ë”ë² ë¦¬"],
  ["Fruity","Berry","Boysenberry","#873260","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë³´ì´ì  ë² ë¦¬"],
  ["Fruity","Berry","Currant","#B31B1B","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ì»¤ëŸ°íŠ¸"],
  ["Fruity","Berry","Black Currant","#2C1608","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¸”ë™ì»¤ëŸ°íŠ¸"],
  ["Fruity","Berry","Red Currant","#DC143C","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¹¨ê°„ì»¤ëŸ°íŠ¸"],
  ["Fruity","Berry","Loganberry","#7A2945","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¡œê±´ë² ë¦¬"],
  ["Fruity","Berry","Mulberry","#843B62","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ì˜¤ë””"],
  ["Fruity","Berry","Sea Buckthorn","#F5822B","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","ë¹„íƒ€ë¯¼ë‚˜ë¬´ ì—´ë§¤"],
  ["Fruity","Berry","Cloudberry","#FFB347","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","í´ë¼ìš°ë“œë² ë¦¬"],
  ["Fruity","Berry","Gooseberry","#9ACD32","ê³¼ì¼ë¥˜","ë² ë¦¬ë¥˜","êµ¬ìŠ¤ë² ë¦¬"],
  
  // Fruity - Stone Fruit (í•µê³¼ë¥˜ í™•ì¥)
  ["Fruity","Stone Fruit","Peach","#FFA07A","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë³µìˆ­ì•„"],
  ["Fruity","Stone Fruit","White Peach","#FFDAB9","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë°±ë„"],
  ["Fruity","Stone Fruit","Yellow Peach","#FFCC5C","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","í™©ë„"],
  ["Fruity","Stone Fruit","Donut Peach","#FFE4B5","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë„ë„› ë³µìˆ­ì•„"],
  ["Fruity","Stone Fruit","Apricot","#FBCEB1","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ì‚´êµ¬"],
  ["Fruity","Stone Fruit","Cherry","#DE3163","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ì²´ë¦¬"],  
  ["Fruity","Stone Fruit","Sweet Cherry","#FF1493","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë‹¨ì²´ë¦¬"],
  ["Fruity","Stone Fruit","Sour Cherry","#DC143C","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ì‹ ì²´ë¦¬"],
  ["Fruity","Stone Fruit","Black Cherry","#4E0F0F","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë¸”ë™ì²´ë¦¬"],
  ["Fruity","Stone Fruit","Maraschino Cherry","#FF69B4","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë§ˆë¼ìŠ¤í‚¤ë…¸ ì²´ë¦¬"],
  ["Fruity","Stone Fruit","Plum","#B27AA4","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ìë‘"],
  ["Fruity","Stone Fruit","Red Plum","#8B008B","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë¹¨ê°„ìë‘"],
  ["Fruity","Stone Fruit","Yellow Plum","#DDA0DD","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë…¸ë€ìë‘"],
  ["Fruity","Stone Fruit","Damson Plum","#6F2DA8","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë‹´ìŠ¨ ìë‘"],
  ["Fruity","Stone Fruit","Nectarine","#FFB8A0","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë„¥íƒ€ë¦°"],
  ["Fruity","Stone Fruit","White Nectarine","#FFEFD5","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë°±ë„¥íƒ€ë¦°"],
  ["Fruity","Stone Fruit","Loquat","#F6AD49","ê³¼ì¼ë¥˜","í•µê³¼ë¥˜","ë¹„íŒŒ"],
  
  // Fruity - Tropical Fruit (ì—´ëŒ€ê³¼ì¼ í™•ì¥)
  ["Fruity","Tropical Fruit","Pineapple","#FEDF00","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","íŒŒì¸ì• í”Œ"],
  ["Fruity","Tropical Fruit","Fresh Pineapple","#FFD700","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ì‹ ì„ í•œ íŒŒì¸ì• í”Œ"],
  ["Fruity","Tropical Fruit","Grilled Pineapple","#DAA520","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","êµ¬ìš´ íŒŒì¸ì• í”Œ"],
  ["Fruity","Tropical Fruit","Coconut","#F2E8D7","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ì½”ì½”ë„›"],
  ["Fruity","Tropical Fruit","Young Coconut","#FFFAF0","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ì–´ë¦° ì½”ì½”ë„›"],
  ["Fruity","Tropical Fruit","Passion Fruit","#DDA0DD","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","íŒ¨ì…˜í”„ë£»"],
  ["Fruity","Tropical Fruit","Guava","#F88379","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","êµ¬ì•„ë°”"],
  ["Fruity","Tropical Fruit","Pink Guava","#FFB6C1","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","í•‘í¬ êµ¬ì•„ë°”"],
  ["Fruity","Tropical Fruit","White Guava","#F5F5F5","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","í™”ì´íŠ¸ êµ¬ì•„ë°”"],
  ["Fruity","Tropical Fruit","Banana","#FFEB99","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ë°”ë‚˜ë‚˜"],
  ["Fruity","Tropical Fruit","Ripe Banana","#FFE135","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ìµì€ ë°”ë‚˜ë‚˜"],
  ["Fruity","Tropical Fruit","Green Banana","#9ACD32","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ëœ ìµì€ ë°”ë‚˜ë‚˜"],
  ["Fruity","Tropical Fruit","Mango","#FDBE34","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ë§ê³ "],
  ["Fruity","Tropical Fruit","Ripe Mango","#FF8C00","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ìµì€ ë§ê³ "],
  ["Fruity","Tropical Fruit","Green Mango","#32CD32","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","í’‹ë§ê³ "],
  ["Fruity","Tropical Fruit","Lychee","#FFE4E1","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ë¦¬ì¹˜"],
  ["Fruity","Tropical Fruit","Star Fruit","#FADA5E","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ìŠ¤íƒ€í”„ë£»"],
  ["Fruity","Tropical Fruit","Papaya","#FFDAB9","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","íŒŒíŒŒì•¼"],
  ["Fruity","Tropical Fruit","Dragon Fruit","#FFC0CB","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ìš©ê³¼"],
  ["Fruity","Tropical Fruit","Jackfruit","#FFEFD5","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ì­í”„ë£»"],
  ["Fruity","Tropical Fruit","Kiwano","#C3D825","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","í‚¤ì™€ë…¸"],
  ["Fruity","Tropical Fruit","Durian","#CDB380","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ë‘ë¦¬ì•ˆ"],
  ["Fruity","Tropical Fruit","Longan","#D2B48C","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ìš©ì•ˆ"],
  ["Fruity","Tropical Fruit","Mangosteen","#5D1F1E","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ë§ê³ ìŠ¤í‹´"],
  ["Fruity","Tropical Fruit","Rambutan","#EC2D01","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ëŒë¶€íƒ„"],
  ["Fruity","Tropical Fruit","Soursop","#C3E88D","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ì‚¬ì›Œì‚½"],
  ["Fruity","Tropical Fruit","Breadfruit","#E8D499","ê³¼ì¼ë¥˜","ì—´ëŒ€ê³¼ì¼","ë¸Œë ˆë“œí”„ë£»"],
  
  // Fruity - Dried Fruit (ê±´ì¡°ê³¼ì¼ í™•ì¥)
  ["Fruity","Dried Fruit","Raisin","#BB9055","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ê±´í¬ë„"],
  ["Fruity","Dried Fruit","Golden Raisin","#DAA520","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ê³¨ë“  ê±´í¬ë„"],
  ["Fruity","Dried Fruit","Sultana","#CD853F","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ìˆ íƒ€ë‚˜"],
  ["Fruity","Dried Fruit","Prune","#925E3A","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ìë‘ë§ë¦°ê²ƒ"],
  ["Fruity","Dried Fruit","Fig","#8A4117","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë¬´í™”ê³¼"],
  ["Fruity","Dried Fruit","Date","#A57164","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ëŒ€ì¶”ì•¼ì"],
  ["Fruity","Dried Fruit","Medjool Date","#8B4513","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë©”ë“œì¤„ ëŒ€ì¶”"],
  ["Fruity","Dried Fruit","Dried Apple","#D5BA98","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°ì‚¬ê³¼"],
  ["Fruity","Dried Fruit","Dried Cherry","#A85751","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°ì²´ë¦¬"],
  ["Fruity","Dried Fruit","Dried Apricot","#E9967A","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°ì‚´êµ¬"],
  ["Fruity","Dried Fruit","Dried Mango","#FFD700","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°ë§ê³ "],
  ["Fruity","Dried Fruit","Dried Cranberry","#C41E3A","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°í¬ëœë² ë¦¬"],
  ["Fruity","Dried Fruit","Dried Blueberry","#4682B4","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°ë¸”ë£¨ë² ë¦¬"],
  ["Fruity","Dried Fruit","Dried Banana","#F3E5AB","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë°”ë‚˜ë‚˜ì¹©"],
  ["Fruity","Dried Fruit","Dried Pineapple","#FFCC33","ê³¼ì¼ë¥˜","ê±´ì¡°ê³¼ì¼","ë§ë¦°íŒŒì¸ì• í”Œ"],
  
  // Sweet (ë‹¨ë§› í™•ì¥)
  ["Sweet","Brown Sugar","Raw Sugar","#DFC5A4","ë‹¨ë§›","í‘ì„¤íƒ•","ì›ë‹¹"],
  ["Sweet","Brown Sugar","Muscovado","#5C4033","ë‹¨ë§›","í‘ì„¤íƒ•","ë¬´ìŠ¤ì½”ë°”ë„"],
  ["Sweet","Brown Sugar","Demerara","#8B7355","ë‹¨ë§›","í‘ì„¤íƒ•","ë°ë©”ë¼ë¼"],
  ["Sweet","Brown Sugar","Turbinado","#D2B48C","ë‹¨ë§›","í‘ì„¤íƒ•","í„°ë¹„ë‚˜ë„"],
  ["Sweet","Brown Sugar","Brown Sugar","#B38B57","ë‹¨ë§›","í‘ì„¤íƒ•","í‘ì„¤íƒ•"],
  ["Sweet","Caramelized","Caramel","#FFB15E","ë‹¨ë§›","ì¹´ë¼ë©œí™”","ìºëŸ¬ë©œ"],
  ["Sweet","Caramelized","Toffee","#D2691E","ë‹¨ë§›","ì¹´ë¼ë©œí™”","í† í”¼"],
  ["Sweet","Caramelized","Butterscotch","#E09540","ë‹¨ë§›","ì¹´ë¼ë©œí™”","ë²„í„°ìŠ¤ì¹´ì¹˜"],
  ["Sweet","Caramelized","Burnt Sugar","#8B4513","ë‹¨ë§›","ì¹´ë¼ë©œí™”","íƒ„ì„¤íƒ•"],
  ["Sweet","Vanilla","Honey","#FDE994","ë‹¨ë§›","ë°”ë‹ë¼","ê¿€"],
  ["Sweet","Vanilla","Wildflower Honey","#F0E68C","ë‹¨ë§›","ë°”ë‹ë¼","ì•¼ìƒí™”ê¿€"],
  ["Sweet","Vanilla","Acacia Honey","#FFEFD5","ë‹¨ë§›","ë°”ë‹ë¼","ì•„ì¹´ì‹œì•„ê¿€"],
  ["Sweet","Vanilla","Vanilla","#F0D7BC","ë‹¨ë§›","ë°”ë‹ë¼","ë°”ë‹ë¼"],
  ["Sweet","Vanilla","Vanilla Bean","#F3E5AB","ë‹¨ë§›","ë°”ë‹ë¼","ë°”ë‹ë¼ë¹ˆ"],
  ["Sweet","Vanilla","Custard","#F0E68C","ë‹¨ë§›","ë°”ë‹ë¼","ì»¤ìŠ¤í„°ë“œ"],
  ["Sweet","Vanilla","Cream","#FFFDD0","ë‹¨ë§›","ë°”ë‹ë¼","í¬ë¦¼"],
  ["Sweet","Molasses","Maple Syrup","#C97C5D","ë‹¨ë§›","ë‹¹ë°€","ë©”ì´í”Œì‹œëŸ½"],
  ["Sweet","Molasses","Molasses","#774936","ë‹¨ë§›","ë‹¹ë°€","ë‹¹ë°€"],
  ["Sweet","Molasses","Black Treacle","#2C1901","ë‹¨ë§›","ë‹¹ë°€","ë¸”ë™íŠ¸ë¦¬í´"],
  ["Sweet","Molasses","Golden Syrup","#F5BD1F","ë‹¨ë§›","ë‹¹ë°€","ê³¨ë“ ì‹œëŸ½"],
  ["Sweet","Molasses","Palm Sugar","#C19A6B","ë‹¨ë§›","ë‹¹ë°€","ì•¼ìì„¤íƒ•"],
  ["Sweet","Confectionery","Rock Sugar","#E8E6D9","ë‹¨ë§›","ê³¼ìë¥˜","ëŒì„¤íƒ•"],
  ["Sweet","Confectionery","Condensed Milk","#FFF8DC","ë‹¨ë§›","ê³¼ìë¥˜","ì—°ìœ "],
  ["Sweet","Confectionery","White Chocolate","#FFFFF0","ë‹¨ë§›","ê³¼ìë¥˜","í™”ì´íŠ¸ì´ˆì½œë¦¿"],
  ["Sweet","Confectionery","Marshmallow","#F8F8FF","ë‹¨ë§›","ê³¼ìë¥˜","ë§ˆì‹œë©œë¡œ"],
  ["Sweet","Confectionery","Cotton Candy","#FFB6C1","ë‹¨ë§›","ê³¼ìë¥˜","ì†œì‚¬íƒ•"],
  
  // Floral (ê½ƒí–¥ í™•ì¥)
  ["Floral","White Flowers","White Flower","#FFFFFF","ê½ƒí–¥","í°ê½ƒ","í°ê½ƒ"],
  ["Floral","White Flowers","Jasmine","#DEC2CB","ê½ƒí–¥","í°ê½ƒ","ììŠ¤ë¯¼"],
  ["Floral","White Flowers","Orange Blossom","#FFCC99","ê½ƒí–¥","í°ê½ƒ","ì˜¤ë Œì§€ê½ƒ"],
  ["Floral","White Flowers","Elderflower","#F0FFF0","ê½ƒí–¥","í°ê½ƒ","ì—˜ë”í”Œë¼ì›Œ"],
  ["Floral","White Flowers","Magnolia","#F8F4FF","ê½ƒí–¥","í°ê½ƒ","ëª©ë ¨"],
  ["Floral","White Flowers","Lily","#FFFFFF","ê½ƒí–¥","í°ê½ƒ","ë°±í•©"],
  ["Floral","White Flowers","Gardenia","#F1FFF7","ê½ƒí–¥","í°ê½ƒ","ì¹˜ìê½ƒ"],
  ["Floral","White Flowers","Coffee Blossom","#F5F5F5","ê½ƒí–¥","í°ê½ƒ","ì»¤í”¼ê½ƒ"],
  ["Floral","Colored Flowers","Rose","#FD5D8B","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ì¥ë¯¸"],
  ["Floral","Colored Flowers","Red Rose","#DC143C","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ë¹¨ê°„ì¥ë¯¸"],
  ["Floral","Colored Flowers","Pink Rose","#FFB6C1","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","í•‘í¬ì¥ë¯¸"],
  ["Floral","Colored Flowers","Hibiscus","#F53E6A","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","íˆë¹„ìŠ¤ì»¤ìŠ¤"],
  ["Floral","Colored Flowers","Lavender","#B57EDC","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ë¼ë²¤ë”"],
  ["Floral","Colored Flowers","Violet","#C9A0DC","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ì œë¹„ê½ƒ"],
  ["Floral","Colored Flowers","Cherry Blossom","#FFB7C5","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ë²šê½ƒ"],
  ["Floral","Colored Flowers","Orchid","#DA70D6","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ë‚œê½ƒ"],
  ["Floral","Colored Flowers","Geranium","#FF577F","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ì œë¼ëŠ„"],
  ["Floral","Colored Flowers","Freesia","#FFBF00","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","í”„ë¦¬ì§€ì•„"],
  ["Floral","Colored Flowers","Peony","#FAAFBE","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ëª¨ë€"],
  ["Floral","Colored Flowers","Lotus","#E8F1D4","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ì—°ê½ƒ"],
  ["Floral","Colored Flowers","Lilac","#C8A2C8","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ë¼ì¼ë½"],
  ["Floral","Colored Flowers","Iris","#5A4FCF","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ì•„ì´ë¦¬ìŠ¤"],
  ["Floral","Colored Flowers","Wisteria","#C9A0DC","ê½ƒí–¥","ìœ ìƒ‰ê½ƒ","ë“±ë‚˜ë¬´ê½ƒ"],
  ["Floral","Herbal Flowers","Chamomile","#F5E5C0","ê½ƒí–¥","í—ˆë¸Œê½ƒ","ì¹´ëª¨ë§ˆì¼"],
  ["Floral","Herbal Flowers","Honeysuckle","#FFF0DB","ê½ƒí–¥","í—ˆë¸Œê½ƒ","ì¸ë™ë©êµ´"],
  ["Floral","Herbal Flowers","Osmanthus","#FFDB58","ê½ƒí–¥","í—ˆë¸Œê½ƒ","ê³„ìˆ˜ë‚˜ë¬´"],
  
  // Nutty/Cocoa (ê²¬ê³¼/ì½”ì½”ì•„ í™•ì¥)
  ["Nutty/Cocoa","Tree Nuts","Almond","#DBD3C9","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ì•„ëª¬ë“œ"],
  ["Nutty/Cocoa","Tree Nuts","Sweet Almond","#F5DEB3","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ë‹¨ì•„ëª¬ë“œ"],
  ["Nutty/Cocoa","Tree Nuts","Bitter Almond","#D2B48C","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ì“´ì•„ëª¬ë“œ"],
  ["Nutty/Cocoa","Tree Nuts","Hazelnut","#D7C2A8","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","í—¤ì´ì¦ë„›"],
  ["Nutty/Cocoa","Tree Nuts","Roasted Hazelnut","#CD853F","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","êµ¬ìš´ í—¤ì´ì¦ë„›"],
  ["Nutty/Cocoa","Tree Nuts","Walnut","#C19A6B","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","í˜¸ë‘"],
  ["Nutty/Cocoa","Tree Nuts","Black Walnut","#654321","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ê²€ì€í˜¸ë‘"],
  ["Nutty/Cocoa","Tree Nuts","Pecan","#7E675E","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","í”¼ì¹¸"],
  ["Nutty/Cocoa","Tree Nuts","Macadamia","#F5F5DC","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ë§ˆì¹´ë‹¤ë¯¸ì•„"],
  ["Nutty/Cocoa","Tree Nuts","Cashew","#F5DEB3","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ìºìŠˆë„›"],
  ["Nutty/Cocoa","Tree Nuts","Pistachio","#93C572","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","í”¼ìŠ¤íƒ€ì¹˜ì˜¤"],
  ["Nutty/Cocoa","Tree Nuts","Brazilian Nut","#8D6E63","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ë¸Œë¼ì§ˆë„ˆíŠ¸"],
  ["Nutty/Cocoa","Tree Nuts","Chestnut","#954535","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ë°¤"],
  ["Nutty/Cocoa","Tree Nuts","Pine Nut","#D6C9A0","ê²¬ê³¼/ì½”ì½”ì•„","ê²¬ê³¼ë¥˜","ì£"],
  ["Nutty/Cocoa","Other Nuts","Peanut","#D28C78","ê²¬ê³¼/ì½”ì½”ì•„","ê¸°íƒ€ê²¬ê³¼ë¥˜","ë•…ì½©"],
  ["Nutty/Cocoa","Other Nuts","Roasted Peanut","#A0522D","ê²¬ê³¼/ì½”ì½”ì•„","ê¸°íƒ€ê²¬ê³¼ë¥˜","êµ¬ìš´ë•…ì½©"],
  ["Nutty/Cocoa","Other Nuts","Coconut","#F2EFE9","ê²¬ê³¼/ì½”ì½”ì•„","ê¸°íƒ€ê²¬ê³¼ë¥˜","ì½”ì½”ë„›"],
  ["Nutty/Cocoa","Cocoa","Dark Chocolate","#6C4F3D","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ë‹¤í¬ì´ˆì½œë¦¿"],
  ["Nutty/Cocoa","Cocoa","70% Dark Chocolate","#5D4037","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","70% ë‹¤í¬ì´ˆì½œë¦¿"],
  ["Nutty/Cocoa","Cocoa","85% Dark Chocolate","#3E2723","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","85% ë‹¤í¬ì´ˆì½œë¦¿"],
  ["Nutty/Cocoa","Cocoa","Cocoa","#926F34","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ì½”ì½”ì•„"],
  ["Nutty/Cocoa","Cocoa","Raw Cocoa","#8B4513","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ë¡œìš° ì½”ì½”ì•„"],
  ["Nutty/Cocoa","Cocoa","Milk Chocolate","#7B3F00","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ë°€í¬ì´ˆì½œë¦¿"],
  ["Nutty/Cocoa","Cocoa","Bittersweet Chocolate","#332421","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ìŒ‰ì‹¸ë¦„í•œ ì´ˆì½œë¦¿"],
  ["Nutty/Cocoa","Cocoa","White Chocolate","#F5F5F5","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","í™”ì´íŠ¸ ì´ˆì½œë¦¿"],
  ["Nutty/Cocoa","Cocoa","Mocha","#785135","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ëª¨ì¹´"],
  ["Nutty/Cocoa","Cocoa","Cacao Nibs","#654321","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ì¹´ì¹´ì˜¤ë‹™ìŠ¤"],
  ["Nutty/Cocoa","Cocoa","Cocoa Butter","#FEF5CA","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ì½”ì½”ì•„ ë²„í„°"],
  ["Nutty/Cocoa","Cocoa","Chocolate Liquor","#3D1E0F","ê²¬ê³¼/ì½”ì½”ì•„","ì½”ì½”ì•„","ì´ˆì½œë¦¿ ë¦¬ì¿¼"],
  
  // Spices (í–¥ì‹ ë£Œ í™•ì¥)
  ["Spices","Warm Spices","Cinnamon","#E5B39B","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ì‹œë‚˜ëª¬"],
  ["Spices","Warm Spices","Ceylon Cinnamon","#D2B48C","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ì‹¤ë¡  ì‹œë‚˜ëª¬"],
  ["Spices","Warm Spices","Cassia","#A0522D","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ì¹´ì‹œì•„"],
  ["Spices","Warm Spices","Clove","#C17855","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ì •í–¥"],
  ["Spices","Warm Spices","Cardamom","#BDA55D","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ì¹´ë‹¤ëª¬"],
  ["Spices","Warm Spices","Green Cardamom","#9ACD32","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ê·¸ë¦° ì¹´ë‹¤ëª¬"],
  ["Spices","Warm Spices","Black Cardamom","#654321","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ë¸”ë™ ì¹´ë‹¤ëª¬"],
  ["Spices","Warm Spices","Allspice","#9C5903","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ì˜¬ìŠ¤íŒŒì´ìŠ¤"],
  ["Spices","Warm Spices","Nutmeg","#BD9C7F","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ìœ¡ë‘êµ¬"],
  ["Spices","Warm Spices","Mace","#C19A6B","í–¥ì‹ ë£Œ","ë”°ëœ»í•œí–¥ì‹ ë£Œ","ë©”ì´ìŠ¤"],
  ["Spices","Hot Spices","Black Pepper","#393939","í–¥ì‹ ë£Œ","ë§¤ìš´í–¥ì‹ ë£Œ","í‘í›„ì¶”"],
  ["Spices","Hot Spices","White Pepper","#F5F5DC","í–¥ì‹ ë£Œ","ë§¤ìš´í–¥ì‹ ë£Œ","ë°±í›„ì¶”"],
  ["Spices","Hot Spices","Pink Pepper","#DDA0DD","í–¥ì‹ ë£Œ","ë§¤ìš´í–¥ì‹ ë£Œ","í•‘í¬í˜í¼"],
  ["Spices","Hot Spices","Cayenne","#CC333F","í–¥ì‹ ë£Œ","ë§¤ìš´í–¥ì‹ ë£Œ","ì¹´ì´ì—” í˜í¼"],
  ["Spices","Hot Spices","Chili","#FF6347","í–¥ì‹ ë£Œ","ë§¤ìš´í–¥ì‹ ë£Œ","ì¹ ë¦¬"],
  ["Spices","Aromatic Spices","Ginger","#EFCC9C","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ìƒê°•"],
  ["Spices","Aromatic Spices","Fresh Ginger","#F4E4BC","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ì‹ ì„ í•œ ìƒê°•"],
  ["Spices","Aromatic Spices","Dried Ginger","#CD853F","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ë§ë¦° ìƒê°•"],
  ["Spices","Aromatic Spices","Star Anise","#483C32","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","íŒ”ê°"],
  ["Spices","Aromatic Spices","Anise","#50404D","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ì•„ë‹ˆìŠ¤"],
  ["Spices","Aromatic Spices","Fennel","#C1E1C1","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","íšŒí–¥"],
  ["Spices","Aromatic Spices","Licorice","#2A2926","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ê°ì´ˆ"],
  ["Spices","Aromatic Spices","Cumin","#8B4513","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ì¿ ë¯¼"],
  ["Spices","Aromatic Spices","Coriander","#AEC6A5","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ê³ ìˆ˜"],
  ["Spices","Aromatic Spices","Coriander Seed","#C9A66B","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ì½”ë¦¬ì•¤ë” ì”¨ì•—"],
  ["Spices","Aromatic Spices","Turmeric","#FFC300","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ê°•í™©"],
  ["Spices","Aromatic Spices","Saffron","#F4C430","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ì‚¬í”„ë€"],
  ["Spices","Aromatic Spices","Juniper Berries","#6D80AB","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","ì£¼ë‹ˆí¼ë² ë¦¬"],
  ["Spices","Aromatic Spices","Fenugreek","#C19A6B","í–¥ì‹ ë£Œ","ë°©í–¥ì„±í–¥ì‹ ë£Œ","í˜ë‰´ê·¸ë¦­"],
  
  // Tea (ì°¨ í™•ì¥)
  ["Tea","Black Tea","Earl Grey","#3A2E39","ì°¨","í™ì°¨","ì–¼ê·¸ë ˆì´"],
  ["Tea","Black Tea","English Breakfast","#654321","ì°¨","í™ì°¨","ì‰ê¸€ë¦¬ì‹œ ë¸Œë ‰í¼ìŠ¤íŠ¸"],
  ["Tea","Black Tea","Darjeeling","#856D4D","ì°¨","í™ì°¨","ë‹¤ì¦ë§"],
  ["Tea","Black Tea","Assam","#4E362F","ì°¨","í™ì°¨","ì•„ì‚¼"],
  ["Tea","Black Tea","Ceylon","#5F4842","ì°¨","í™ì°¨","ì‹¤ë¡ "],
  ["Tea","Black Tea","Keemun","#6B4226","ì°¨","í™ì°¨","ê¸°ë¬¸"],
  ["Tea","Black Tea","Lapsang Souchong","#2F1B14","ì°¨","í™ì°¨","ë¼í”„ìƒ ì†Œìš°ì´"],
  ["Tea","Green Tea","Matcha","#D0F0C0","ì°¨","ë…¹ì°¨","ë§ì°¨"],
  ["Tea","Green Tea","Sencha","#90EE90","ì°¨","ë…¹ì°¨","ì„¼ì°¨"],
  ["Tea","Green Tea","Gyokuro","#799E65","ì°¨","ë…¹ì°¨","êµì¿ ë¡œ"],
  ["Tea","Green Tea","Longjing","#C7E4C0","ì°¨","ë…¹ì°¨","ë£½ì§•"],
  ["Tea","Green Tea","Jasmine Green Tea","#E6FFE6","ì°¨","ë…¹ì°¨","ììŠ¤ë¯¼ ë…¹ì°¨"],
  ["Tea","Oolong","Oolong","#A0522D","ì°¨","ìš°ë¡±ì°¨","ìš°ë¡±"],
  ["Tea","Oolong","Ti Kuan Yin","#8B4513","ì°¨","ìš°ë¡±ì°¨","ì² ê´€ìŒ"],
  ["Tea","Oolong","Da Hong Pao","#654321","ì°¨","ìš°ë¡±ì°¨","ëŒ€í™í¬"],
  ["Tea","White Tea","Silver Needle","#E6E8FA","ì°¨","ë°±ì°¨","ì€ì¹¨ì°¨"],
  ["Tea","White Tea","White Peony","#F5F5F5","ì°¨","ë°±ì°¨","ë°±ëª¨ë‹¨"],
  ["Tea","Herbal Tea","Chamomile","#FADA5E","ì°¨","í—ˆë¸Œì°¨","ì¹´ëª¨ë§ˆì¼"],
  ["Tea","Herbal Tea","Peppermint","#98FB98","ì°¨","í—ˆë¸Œì°¨","í˜í¼ë¯¼íŠ¸"],
  ["Tea","Herbal Tea","Rooibos","#D2691E","ì°¨","í—ˆë¸Œì°¨","ë£¨ì´ë³´ìŠ¤"],
  ["Tea","Herbal Tea","Hibiscus Tea","#CA3433","ì°¨","í—ˆë¸Œì°¨","íˆë¹„ìŠ¤ì»¤ìŠ¤ì°¨"],
  ["Tea","Herbal Tea","Lemongrass","#9DC183","ì°¨","í—ˆë¸Œì°¨","ë ˆëª¬ê·¸ë¼ìŠ¤"],
  ["Tea","Herbal Tea","Chrysanthemum","#FFD700","ì°¨","í—ˆë¸Œì°¨","êµ­í™”ì°¨"],
  ["Tea","Herbal Tea","Mint Tea","#98FB98","ì°¨","í—ˆë¸Œì°¨","ë¯¼íŠ¸ì°¨"],
  ["Tea","Puer","Aged Puer","#70593E","ì°¨","í‘¸ì–¼ì°¨","ìˆ™ì„± ë³´ì´ì°¨"],
  ["Tea","Puer","Raw Puer","#B5AA89","ì°¨","í‘¸ì–¼ì°¨","ìƒ ë³´ì´ì°¨"],
  ["Tea","Puer","Ripe Puer","#5D4037","ì°¨","í‘¸ì–¼ì°¨","ìˆ™ ë³´ì´ì°¨"],
  
  // Cereal/Grain (ê³¡ë¬¼ë¥˜ í™•ì¥)
  ["Cereal/Grain","Malted","Malt","#F0E68C","ê³¡ë¬¼ë¥˜","ë§¥ì•„","ë§¥ì•„"],
  ["Cereal/Grain","Malted","Barley Malt","#D2B48C","ê³¡ë¬¼ë¥˜","ë§¥ì•„","ë³´ë¦¬ë§¥ì•„"],
  ["Cereal/Grain","Malted","Wheat Malt","#EAD9A7","ê³¡ë¬¼ë¥˜","ë§¥ì•„","ë°€ë§¥ì•„"],
  ["Cereal/Grain","Baked","Toast","#D2B48C","ê³¡ë¬¼ë¥˜","êµ¬ìš´ê²ƒ","í† ìŠ¤íŠ¸"],
  ["Cereal/Grain","Baked","Whole Wheat Toast","#8B7355","ê³¡ë¬¼ë¥˜","êµ¬ìš´ê²ƒ","í†µë°€í† ìŠ¤íŠ¸"],
  ["Cereal/Grain","Baked","Sourdough","#E1D7C6","ê³¡ë¬¼ë¥˜","êµ¬ìš´ê²ƒ","ì‚¬ì›Œë„ìš°"],
  ["Cereal/Grain","Baked","Brioche","#EED7A1","ê³¡ë¬¼ë¥˜","êµ¬ìš´ê²ƒ","ë¸Œë¦¬ì˜¤ìŠˆ"],
  ["Cereal/Grain","Baked","Biscuit","#E2DFD2","ê³¡ë¬¼ë¥˜","êµ¬ìš´ê²ƒ","ë¹„ìŠ¤í‚·"],
  ["Cereal/Grain","Baked","Graham Cracker","#C9AD86","ê³¡ë¬¼ë¥˜","êµ¬ìš´ê²ƒ","ê·¸ë ˆì´ì—„ í¬ë˜ì»¤"],
  ["Cereal/Grain","Raw Grains","Barley","#DBD0AE","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ë³´ë¦¬"],
  ["Cereal/Grain","Raw Grains","Oats","#E4CBB1","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ê·€ë¦¬"],
  ["Cereal/Grain","Raw Grains","Steel Cut Oats","#D4B896","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ìŠ¤í‹¸ì»· ì˜¤íŠ¸"],
  ["Cereal/Grain","Raw Grains","Rice","#F9FBE7","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ìŒ€"],
  ["Cereal/Grain","Raw Grains","Brown Rice","#DEB887","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","í˜„ë¯¸"],
  ["Cereal/Grain","Raw Grains","Wheat","#EAD9A7","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ë°€"],
  ["Cereal/Grain","Raw Grains","Whole Wheat","#BC9A6A","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","í†µë°€"],
  ["Cereal/Grain","Raw Grains","Corn","#FFF380","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ì˜¥ìˆ˜ìˆ˜"],
  ["Cereal/Grain","Raw Grains","Rye","#8B7355","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","í˜¸ë°€"],
  ["Cereal/Grain","Raw Grains","Buckwheat","#C19A6B","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ë©”ë°€"],
  ["Cereal/Grain","Raw Grains","Quinoa","#DEC19E","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","í€´ë…¸ì•„"],
  ["Cereal/Grain","Raw Grains","Millet","#E9E4A7","ê³¡ë¬¼ë¥˜","ìƒê³¡ë¬¼","ê¸°ì¥"],
  ["Cereal/Grain","Processed","Granola","#C8A951","ê³¡ë¬¼ë¥˜","ê°€ê³µí’ˆ","ê·¸ë˜ë†€ë¼"],
  ["Cereal/Grain","Processed","Cheerios","#E8C99B","ê³¡ë¬¼ë¥˜","ê°€ê³µí’ˆ","ì‹œë¦¬ì˜¤ìŠ¤"],
  ["Cereal/Grain","Processed","Cornflakes","#FFBF00","ê³¡ë¬¼ë¥˜","ê°€ê³µí’ˆ","ì½˜í”Œë ˆì´í¬"],
  
  // Roasted (ë¡œìŠ¤íŒ… í–¥ í™•ì¥)
  ["Roasted","Light Roast","Cinnamon Roast","#AD8150","ë¡œìŠ¤íŒ…","ë¼ì´íŠ¸ ë¡œìŠ¤íŠ¸","ì‹œë‚˜ëª¬ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Light Roast","New England Roast","#967969","ë¡œìŠ¤íŒ…","ë¼ì´íŠ¸ ë¡œìŠ¤íŠ¸","ë‰´ì‰ê¸€ëœë“œ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Light Roast","Tea-like","#967969","ë¡œìŠ¤íŒ…","ë¼ì´íŠ¸ ë¡œìŠ¤íŠ¸","ì°¨ì™€ ìœ ì‚¬í•œ"],
  ["Roasted","Light Roast","Herbal","#BDCB96","ë¡œìŠ¤íŒ…","ë¼ì´íŠ¸ ë¡œìŠ¤íŠ¸","í—ˆë¸Œí–¥"],
  ["Roasted","Medium Roast","American Roast","#8B4513","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","ì•„ë©”ë¦¬ì¹¸ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Medium Roast","City Roast","#7B3F00","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","ì‹œí‹° ë¡œìŠ¤íŠ¸"],
  ["Roasted","Medium Roast","Full City","#654321","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","í’€ ì‹œí‹°"],
  ["Roasted","Medium Roast","Vienna Roast","#4E3524","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","ë¹„ì—”ë‚˜ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Medium Roast","Toasty","#C19A6B","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","í† ìŠ¤í‹°"],
  ["Roasted","Medium Roast","Caramelized","#C68E17","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","ìºëŸ¬ë©œí™”"],
  ["Roasted","Medium Roast","Nutty","#D2B48C","ë¡œìŠ¤íŒ…","ë¯¸ë””ì—„ ë¡œìŠ¤íŠ¸","ê²¬ê³¼ë¥˜"],
  ["Roasted","Dark Roast","French Roast","#23180D","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","í”„ë Œì¹˜ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Dark Roast","Italian Roast","#281811","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ì´íƒˆë¦¬ì•ˆ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Dark Roast","Spanish Roast","#1C1208","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ìŠ¤íŒ¨ë‹ˆì‹œ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Dark Roast","Continental Roast","#0F0A05","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ì»¨í‹°ë„¨íƒˆ ë¡œìŠ¤íŠ¸"],
  ["Roasted","Dark Roast","Burnt","#373536","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","íƒ„ ë§›"],
  ["Roasted","Dark Roast","Charred","#2C1608","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ìˆ¯ë¶ˆí–¥"],
  ["Roasted","Dark Roast","Ashy","#5D5D5D","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ì¬ ë§›"],
  ["Roasted","Dark Roast","Tobacco","#715F3F","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ë‹´ë°°í–¥"],
  ["Roasted","Dark Roast","Dark Chocolate","#3D2314","ë¡œìŠ¤íŒ…","ë‹¤í¬ ë¡œìŠ¤íŠ¸","ë‹¤í¬ ì´ˆì½œë¦¿"],
  ["Roasted","Smoky","Smoky","#463F3A","ë¡œìŠ¤íŒ…","í›ˆì—°","í›ˆì—°í–¥"],
  ["Roasted","Smoky","Wood Smoke","#696969","ë¡œìŠ¤íŒ…","í›ˆì—°","ë‚˜ë¬´ì—°ê¸°"],
  ["Roasted","Smoky","Barbecue","#8B4513","ë¡œìŠ¤íŒ…","í›ˆì—°","ë°”ë¹„í"],
  
  // Green/Vegetative (í’€/ì±„ì†Œë¥˜ í™•ì¥)
  ["Green/Vegetative","Fresh Green","Under-ripe","#A4C09C","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ëœ ìµì€ ë§›"],
  ["Green/Vegetative","Fresh Green","Grass","#7EC850","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","í’€"],
  ["Green/Vegetative","Fresh Green","Fresh Cut Grass","#66BB6A","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ê°“ ê¹ì€ í’€"],
  ["Green/Vegetative","Fresh Green","Green Bell Pepper","#4F7942","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","í”¼ë§"],
  ["Green/Vegetative","Fresh Green","Cucumber","#8FBC8F","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ì˜¤ì´"],
  ["Green/Vegetative","Fresh Green","Green Apple","#8DB600","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ì²­ì‚¬ê³¼"],
  ["Green/Vegetative","Fresh Green","Green Beans","#7BAA1D","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ê»ì§ˆì½©"],
  ["Green/Vegetative","Fresh Green","Peapod","#B2DAC0","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ì™„ë‘ì½© ê¼¬íˆ¬ë¦¬"],
  ["Green/Vegetative","Fresh Green","Fresh","#C2E99E","í’€/ì±„ì†Œë¥˜","ì‹ ì„ í•œí’€","ì‹ ì„ í•œ"],
  ["Green/Vegetative","Herbaceous","Mint","#98FB98","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ë¯¼íŠ¸"],
  ["Green/Vegetative","Herbaceous","Spearmint","#00FF7F","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ìŠ¤í”¼ì–´ë¯¼íŠ¸"],
  ["Green/Vegetative","Herbaceous","Peppermint","#90EE90","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","í˜í¼ë¯¼íŠ¸"],
  ["Green/Vegetative","Herbaceous","Basil","#579229","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ë°”ì§ˆ"],
  ["Green/Vegetative","Herbaceous","Sweet Basil","#6B8E23","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ìŠ¤ìœ„íŠ¸ ë°”ì§ˆ"],
  ["Green/Vegetative","Herbaceous","Thai Basil","#4B5320","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","íƒ€ì´ ë°”ì§ˆ"],
  ["Green/Vegetative","Herbaceous","Sage","#BCB88A","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ì„¸ì´ì§€"],
  ["Green/Vegetative","Herbaceous","Rosemary","#77815C","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ë¡œì¦ˆë§ˆë¦¬"],
  ["Green/Vegetative","Herbaceous","Thyme","#4E5144","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","íƒ€ì„"],  
  ["Green/Vegetative","Herbaceous","Oregano","#50C878","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ì˜¤ë ˆê°€ë…¸"],
  ["Green/Vegetative","Herbaceous","Dill","#718F58","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ë”œ"],
  ["Green/Vegetative","Herbaceous","Cilantro","#BDFFA8","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ì‹¤ë€íŠ¸ë¡œ"],
  ["Green/Vegetative","Herbaceous","Parsley","#7FFFD4","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","íŒŒìŠ¬ë¦¬"],
  ["Green/Vegetative","Herbaceous","Tarragon","#A3B86C","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","íƒ€ë¼ê³¤"],
  ["Green/Vegetative","Herbaceous","Bay Leaf","#87A96B","í’€/ì±„ì†Œë¥˜","í—ˆë¸Œë¥˜","ì›”ê³„ìˆ˜ì"],
  ["Green/Vegetative","Vegetal","Olive","#708238","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ì˜¬ë¦¬ë¸Œ"],
  ["Green/Vegetative","Vegetal","Green Olive","#9CAF88","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ê·¸ë¦° ì˜¬ë¦¬ë¸Œ"],
  ["Green/Vegetative","Vegetal","Black Olive","#36454F","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ë¸”ë™ ì˜¬ë¦¬ë¸Œ"],
  ["Green/Vegetative","Vegetal","Spinach","#175732","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ì‹œê¸ˆì¹˜"],
  ["Green/Vegetative","Vegetal","Artichoke","#8F9779","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ì•„í‹°ì´ˆí¬"],
  ["Green/Vegetative","Vegetal","Celery","#C1FD95","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ì…€ëŸ¬ë¦¬"],
  ["Green/Vegetative","Vegetal","Brussels Sprout","#7C9C53","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ë°©ìš¸ì–‘ë°°ì¶”"],
  ["Green/Vegetative","Vegetal","Kale","#5F7F50","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ì¼€ì¼"],
  ["Green/Vegetative","Vegetal","Wheatgrass","#98FB98","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ë°€ì‹¹"],
  ["Green/Vegetative","Vegetal","Asparagus","#87A96B","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ì•„ìŠ¤íŒŒë¼ê±°ìŠ¤"],
  ["Green/Vegetative","Vegetal","Broccoli","#6B8E23","í’€/ì±„ì†Œë¥˜","ì±„ì†Œë¥˜","ë¸Œë¡œì½œë¦¬"],
  
  // Sour/Fermented (ì‚°ë¯¸/ë°œíš¨ í™•ì¥)
  ["Sour/Fermented","Clean Acidity","Citric Acid","#CEE6CB","ì‚°ë¯¸/ë°œíš¨","ê¹¨ë—í•œì‚°ë¯¸","ì‹œíŠ¸ë¥´ì‚°"],
  ["Sour/Fermented","Clean Acidity","Malic Acid","#C9E265","ì‚°ë¯¸/ë°œíš¨","ê¹¨ë—í•œì‚°ë¯¸","ë§ì‚°"],
  ["Sour/Fermented","Clean Acidity","Tartaric Acid","#D7E8CB","ì‚°ë¯¸/ë°œíš¨","ê¹¨ë—í•œì‚°ë¯¸","íƒ€ë¥´íƒ€ë¥´ì‚°"],
  ["Sour/Fermented","Clean Acidity","Phosphoric Acid","#E8F3D9","ì‚°ë¯¸/ë°œíš¨","ê¹¨ë—í•œì‚°ë¯¸","ì¸ì‚°"],
  ["Sour/Fermented","Clean Acidity","Lactic Acid","#F5F5F5","ì‚°ë¯¸/ë°œíš¨","ê¹¨ë—í•œì‚°ë¯¸","ì –ì‚°"],
  ["Sour/Fermented","Sour","Acetic Acid","#D9C1B4","ì‚°ë¯¸/ë°œíš¨","ì‚°ë¯¸","ì•„ì„¸íŠ¸ì‚°"],
  ["Sour/Fermented","Sour","Vinegar","#ECEDE6","ì‚°ë¯¸/ë°œíš¨","ì‚°ë¯¸","ì‹ì´ˆ"],
  ["Sour/Fermented","Sour","Apple Cider Vinegar","#F4A460","ì‚°ë¯¸/ë°œíš¨","ì‚°ë¯¸","ì‚¬ê³¼ì‹ì´ˆ"],
  ["Sour/Fermented","Sour","Balsamic Vinegar","#654321","ì‚°ë¯¸/ë°œíš¨","ì‚°ë¯¸","ë°œì‚¬ë¯¹ ì‹ì´ˆ"],
  ["Sour/Fermented","Fermented","Winey","#AC436E","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì™€ì¸ ë§›"],
  ["Sour/Fermented","Fermented","Red Wine","#722F37","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì í¬ë„ì£¼"],
  ["Sour/Fermented","Fermented","White Wine","#F7E7CE","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ë°±í¬ë„ì£¼"],
  ["Sour/Fermented","Fermented","Champagne","#F7E7CE","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ìƒ´í˜ì¸"],
  ["Sour/Fermented","Fermented","Overripe","#625958","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ê³¼ìˆ™í•œ"],
  ["Sour/Fermented","Fermented","Yogurt","#F5F5F5","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ìš”ê±°íŠ¸"],
  ["Sour/Fermented","Fermented","Greek Yogurt","#FFF8DC","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ê·¸ë¦­ ìš”ê±°íŠ¸"],
  ["Sour/Fermented","Fermented","Kefir","#F0EAD6","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì¼€í”¼ì–´"],
  ["Sour/Fermented","Fermented","Sourdough","#E8D0A7","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì‚¬ì›Œë„ìš°"],
  ["Sour/Fermented","Fermented","Kombucha","#DEC19B","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì½¤ë¶€ì°¨"],
  ["Sour/Fermented","Fermented","Kimchi","#E80000","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ê¹€ì¹˜"],
  ["Sour/Fermented","Fermented","Sauerkraut","#E8E4C9","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì‚¬ìš°ì–´í¬ë¼ìš°íŠ¸"],
  ["Sour/Fermented","Fermented","Miso","#E9CEAA","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ë¯¸ì†Œ"],
  ["Sour/Fermented","Fermented","Sake","#EDEADE","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ì‚¬ì¼€"],
  ["Sour/Fermented","Fermented","Beer","#F5DEB3","ì‚°ë¯¸/ë°œíš¨","ë°œíš¨","ë§¥ì£¼"],
  ["Sour/Fermented","Aged/Funky","Musty","#8B7D6B","ì‚°ë¯¸/ë°œíš¨","ìˆ™ì„±/í‘í‚¤","ê³°íŒ¡ì´ ëƒ„ìƒˆ"],  
  ["Sour/Fermented","Aged/Funky","Earthy","#79553D","ì‚°ë¯¸/ë°œíš¨","ìˆ™ì„±/í‘í‚¤","í™ëƒ„ìƒˆ"],
  ["Sour/Fermented","Aged/Funky","Blue Cheese","#7CB9E8","ì‚°ë¯¸/ë°œíš¨","ìˆ™ì„±/í‘í‚¤","ë¸”ë£¨ì¹˜ì¦ˆ"],
  ["Sour/Fermented","Aged/Funky","Mildew","#7D7D65","ì‚°ë¯¸/ë°œíš¨","ìˆ™ì„±/í‘í‚¤","ê³°íŒ¡ì´"],
  ["Sour/Fermented","Aged/Funky","Barnyard","#8B7355","ì‚°ë¯¸/ë°œíš¨","ìˆ™ì„±/í‘í‚¤","ì¶•ì‚¬ëƒ„ìƒˆ"],
  
  // Other (ê¸°íƒ€ í™•ì¥)
  ["Other","Defect","Baggy","#C8B094","ê¸°íƒ€","ê²°í•¨","í¬ëŒ€ëƒ„ìƒˆ"],
  ["Other","Defect","Ferment","#614E1A","ê¸°íƒ€","ê²°í•¨","ê³¼ë°œíš¨"],
  ["Other","Defect","Phenol","#3B0000","ê¸°íƒ€","ê²°í•¨","í˜ë†€ë¦­"],
  ["Other","Defect","Quaker","#D1BEA8","ê¸°íƒ€","ê²°í•¨","í€˜ì´ì»¤"],
  ["Other","Defect","Potato","#D2B48C","ê¸°íƒ€","ê²°í•¨","ê°ìëƒ„ìƒˆ"],
  ["Other","Defect","Rio","#8B4513","ê¸°íƒ€","ê²°í•¨","ë¦¬ì˜¤"],
  ["Other","Chemical","Chemical","#FCF6B1","ê¸°íƒ€","í™”í•™ì ","í™”í•™ì "],
  ["Other","Chemical","Medicinal","#E2D784","ê¸°íƒ€","í™”í•™ì ","ì•½í’ˆí–¥"],
  ["Other","Chemical","Rubber","#454545","ê¸°íƒ€","í™”í•™ì ","ê³ ë¬´"],
  ["Other","Chemical","Petroleum","#2E2E2E","ê¸°íƒ€","í™”í•™ì ","ì„ìœ "],
  ["Other","Chemical","Plastic","#BEBEBE","ê¸°íƒ€","í™”í•™ì ","í”Œë¼ìŠ¤í‹±"],
  ["Other","Chemical","Tar","#1C1C1C","ê¸°íƒ€","í™”í•™ì ","íƒ€ë¥´"],
  ["Other","Chemical","Solvent","#696969","ê¸°íƒ€","í™”í•™ì ","ìš©ì œ"],
  ["Other","Earthy","Soil","#6F4E37","ê¸°íƒ€","í™ë‚´ìŒ","í™"],
  ["Other","Earthy","Wet Earth","#622F22","ê¸°íƒ€","í™ë‚´ìŒ","ì –ì€ í™"],
  ["Other","Earthy","Dry Earth","#8B7355","ê¸°íƒ€","í™ë‚´ìŒ","ë§ˆë¥¸ í™"],
  ["Other","Earthy","Mushroom","#D7CEC7","ê¸°íƒ€","í™ë‚´ìŒ","ë²„ì„¯"],
  ["Other","Earthy","Shiitake","#8B7355","ê¸°íƒ€","í™ë‚´ìŒ","í‘œê³ ë²„ì„¯"],
  ["Other","Earthy","Porcini","#A0522D","ê¸°íƒ€","í™ë‚´ìŒ","í¬ë¥´ì¹˜ë‹ˆ"],
  ["Other","Earthy","Forest Floor","#5E4B3B","ê¸°íƒ€","í™ë‚´ìŒ","ìˆ²ë°”ë‹¥"],
  ["Other","Earthy","Moss","#617744","ê¸°íƒ€","í™ë‚´ìŒ","ì´ë¼"],
  ["Other","Earthy","Truffle","#523A28","ê¸°íƒ€","í™ë‚´ìŒ","íŠ¸ëŸ¬í”Œ"],
  ["Other","Woody","Oak","#A46B2B","ê¸°íƒ€","ë‚˜ë¬´í–¥","ì˜¤í¬"],
  ["Other","Woody","French Oak","#8B4513","ê¸°íƒ€","ë‚˜ë¬´í–¥","í”„ë Œì¹˜ ì˜¤í¬"],
  ["Other","Woody","American Oak","#CD853F","ê¸°íƒ€","ë‚˜ë¬´í–¥","ì•„ë©”ë¦¬ì¹¸ ì˜¤í¬"],
  ["Other","Woody","Cedar","#A67B5B","ê¸°íƒ€","ë‚˜ë¬´í–¥","ì‚¼ë‚˜ë¬´"],
  ["Other","Woody","Pine","#8A9A5B","ê¸°íƒ€","ë‚˜ë¬´í–¥","ì†Œë‚˜ë¬´"],
  ["Other","Woody","Sandalwood","#B87333","ê¸°íƒ€","ë‚˜ë¬´í–¥","ë°±ë‹¨í–¥"],
  ["Other","Woody","Maple","#C04000","ê¸°íƒ€","ë‚˜ë¬´í–¥","ë‹¨í’ë‚˜ë¬´"],
  ["Other","Woody","Bamboo","#78866B","ê¸°íƒ€","ë‚˜ë¬´í–¥","ëŒ€ë‚˜ë¬´"],
  ["Other","Woody","Cypress","#2F4F4F","ê¸°íƒ€","ë‚˜ë¬´í–¥","ì‚¬ì´í”„ëŸ¬ìŠ¤"],
  ["Other","Woody","Eucalyptus","#44C173","ê¸°íƒ€","ë‚˜ë¬´í–¥","ìœ ì¹¼ë¦½íˆ¬ìŠ¤"],
  ["Other","Woody","Teak","#9A7B4F","ê¸°íƒ€","ë‚˜ë¬´í–¥","í‹°í¬"],
  ["Other","Woody","Mahogany","#7C1C05","ê¸°íƒ€","ë‚˜ë¬´í–¥","ë§ˆí˜¸ê°€ë‹ˆ"],
  ["Other","Woody","Birch","#F5DEB3","ê¸°íƒ€","ë‚˜ë¬´í–¥","ìì‘ë‚˜ë¬´"],
  ["Other","Animal","Leather","#8B4513","ê¸°íƒ€","ë™ë¬¼í–¥","ê°€ì£½"],
  ["Other","Animal","Suede","#C0C0C0","ê¸°íƒ€","ë™ë¬¼í–¥","ìŠ¤ì›¨ì´ë“œ"],
  ["Other","Animal","Musk","#4E4B51","ê¸°íƒ€","ë™ë¬¼í–¥","ì‚¬í–¥"],
  ["Other","Animal","Honey Comb","#ECB176","ê¸°íƒ€","ë™ë¬¼í–¥","ë²Œì§‘"],
  ["Other","Animal","Beeswax","#F0DC82","ê¸°íƒ€","ë™ë¬¼í–¥","ë°€ë"],
  ["Other","Mineral","Mineral","#A8A8A8","ê¸°íƒ€","ë¯¸ë„¤ë„","ë¯¸ë„¤ë„"],
  ["Other","Mineral","Wet Stone","#708090","ê¸°íƒ€","ë¯¸ë„¤ë„","ì –ì€ ëŒ"],
  ["Other","Mineral","Chalk","#F5F5F5","ê¸°íƒ€","ë¯¸ë„¤ë„","ë¶„í•„"],
  ["Other","Mineral","Limestone","#E5E4E2","ê¸°íƒ€","ë¯¸ë„¤ë„","ì„íšŒì•”"],
  ["Other","Mineral","Salt","#FFFFFF","ê¸°íƒ€","ë¯¸ë„¤ë„","ì†Œê¸ˆ"],
  ["Other","Mineral","Sea Salt","#F0F8FF","ê¸°íƒ€","ë¯¸ë„¤ë„","ë°”ë‹¤ì†Œê¸ˆ"]
];

// ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ë°ì´í„° ê°œì„  - ë” ë§ì€ í•­ëª©ê³¼ í•œê¸€/ì˜ë¬¸ ì§€ì› ê°•í™”
const BODY_DESCRIPTORS = [
  // ì§ˆê° ê³„ì—´
  { id: 'silky', label: 'Silky', korean: 'ì‹¤í‚¤í•œ', category: 'texture', color: '#E6E6FA' },
  { id: 'smooth', label: 'Smooth', korean: 'ë¶€ë“œëŸ¬ìš´', category: 'texture', color: '#F5F5DC' },
  { id: 'creamy', label: 'Creamy', korean: 'í¬ë¦¬ë¯¸í•œ', category: 'texture', color: '#FFFDD0' },
  { id: 'velvety', label: 'Velvety', korean: 'ë²¨ë²³ê°™ì€', category: 'texture', color: '#DDA0DD' },
  { id: 'buttery', label: 'Buttery', korean: 'ë²„í„°ê°™ì€', category: 'texture', color: '#FFFACD' },
  { id: 'oily', label: 'Oily', korean: 'ì˜¤ì¼ë¦¬í•œ', category: 'texture', color: '#F0E68C' },
  { id: 'watery', label: 'Watery', korean: 'ë¬¼ê°™ì€', category: 'texture', color: '#E0F6FF' },
  { id: 'thin', label: 'Thin', korean: 'ì–‡ì€', category: 'texture', color: '#F0F8FF' },
  { id: 'syrupy', label: 'Syrupy', korean: 'ì‹œëŸ½ê°™ì€', category: 'texture', color: '#DAA520' },
  { id: 'viscous', label: 'Viscous', korean: 'ì ì„±ìˆëŠ”', category: 'texture', color: '#CD853F' },
  { id: 'juicy', label: 'Juicy', korean: 'ê³¼ì¦™ì´ í’ë¶€í•œ', category: 'texture', color: '#FFB6C1' },
  { id: 'slick', label: 'Slick', korean: 'ë§¤ë„ëŸ¬ìš´', category: 'texture', color: '#E0E0E0' },
  
  // ë¬´ê²Œê° ê³„ì—´
  { id: 'light', label: 'Light', korean: 'ê°€ë²¼ìš´', category: 'weight', color: '#F0F8FF' },
  { id: 'medium_light', label: 'Medium-Light', korean: 'ì¤‘ê°„-ê°€ë²¼ìš´', category: 'weight', color: '#F5F5F5' },
  { id: 'medium', label: 'Medium', korean: 'ì¤‘ê°„', category: 'weight', color: '#DCDCDC' },
  { id: 'medium_heavy', label: 'Medium-Heavy', korean: 'ì¤‘ê°„-ë¬´ê±°ìš´', category: 'weight', color: '#C0C0C0' },
  { id: 'heavy', label: 'Heavy', korean: 'ë¬´ê±°ìš´', category: 'weight', color: '#A9A9A9' },
  { id: 'full', label: 'Full', korean: 'í’€ ë°”ë””', category: 'weight', color: '#808080' },
  { id: 'robust', label: 'Robust', korean: 'ê²¬ê³ í•œ', category: 'weight', color: '#696969' },
  { id: 'substantial', label: 'Substantial', korean: 'ì‹¤ì§ˆì ì¸', category: 'weight', color: '#778899' },
  { id: 'massive', label: 'Massive', korean: 'ê±°ëŒ€í•œ', category: 'weight', color: '#555555' },
  { id: 'weightless', label: 'Weightless', korean: 'ë¬´ì¤‘ë ¥ì˜', category: 'weight', color: '#F8F8FF' },
  
  // ë°€ë„ê° ê³„ì—´
  { id: 'dense', label: 'Dense', korean: 'ë°€ë„ìˆëŠ”', category: 'density', color: '#556B2F' },
  { id: 'concentrated', label: 'Concentrated', korean: 'ë†ì¶•ëœ', category: 'density', color: '#8B4513' },
  { id: 'rich', label: 'Rich', korean: 'í’ë¶€í•œ', category: 'density', color: '#A0522D' },
  { id: 'deep', label: 'Deep', korean: 'ê¹Šì€', category: 'density', color: '#8B0000' },
  { id: 'intense', label: 'Intense', korean: 'ê°•ë ¬í•œ', category: 'density', color: '#4B0082' },
  { id: 'weak', label: 'Weak', korean: 'ì•½í•œ', category: 'density', color: '#F5F5F5' },
  { id: 'diluted', label: 'Diluted', korean: 'í¬ì„ëœ', category: 'density', color: '#F0F8FF' },
  { id: 'thin_sparse', label: 'Sparse', korean: 'ë“œë¬¸ë“œë¬¸í•œ', category: 'density', color: '#E6E6FA' },
  { id: 'compact', label: 'Compact', korean: 'ì´˜ì´˜í•œ', category: 'density', color: '#8B7D6B' },
  
  // ì…ì•ˆê°ì´‰ ê³„ì—´
  { id: 'round', label: 'Round', korean: 'ë‘¥ê·¼', category: 'mouthfeel', color: '#DEB887' },
  { id: 'coating', label: 'Coating', korean: 'ì½”íŒ…ê°', category: 'mouthfeel', color: '#F4A460' },
  { id: 'lingering', label: 'Lingering', korean: 'ì§€ì†ë˜ëŠ”', category: 'mouthfeel', color: '#CD853F' },
  { id: 'clean', label: 'Clean', korean: 'ê¹”ë”í•œ', category: 'mouthfeel', color: '#F0FFFF' },
  { id: 'crisp', label: 'Crisp', korean: 'ìƒì¾Œí•œ', category: 'mouthfeel', color: '#E0FFFF' },
  { id: 'refreshing', label: 'Refreshing', korean: 'ìƒí¼í•œ', category: 'mouthfeel', color: '#AFEEEE' },
  { id: 'astringent', label: 'Astringent', korean: 'ë–«ì€', category: 'mouthfeel', color: '#8FBC8F' },
  { id: 'drying', label: 'Drying', korean: 'ê±´ì¡°í•œ', category: 'mouthfeel', color: '#D2B48C' },
  { id: 'chalky', label: 'Chalky', korean: 'ë¶„í•„ê°™ì€', category: 'mouthfeel', color: '#F5F5F5' },
  { id: 'gritty', label: 'Gritty', korean: 'ê±°ì¹œ', category: 'mouthfeel', color: '#BC8F8F' },
  { id: 'powdery', label: 'Powdery', korean: 'ê°€ë£¨ê°™ì€', category: 'mouthfeel', color: '#FFE4E1' },
  { id: 'metallic', label: 'Metallic', korean: 'ê¸ˆì†ì„±ì˜', category: 'mouthfeel', color: '#C0C0C0' },
  { id: 'tannic', label: 'Tannic', korean: 'íƒ€ë‹Œê°', category: 'mouthfeel', color: '#8B4513' },
  { id: 'velvety_smooth', label: 'Velvety Smooth', korean: 'ë²¨ë²³ì²˜ëŸ¼ ë¶€ë“œëŸ¬ìš´', category: 'mouthfeel', color: '#DA70D6' },
  
  // ì˜¨ë„ê° ê³„ì—´
  { id: 'warming', label: 'Warming', korean: 'ë”°ëœ»í•œ', category: 'temperature', color: '#FF7F50' },
  { id: 'cooling', label: 'Cooling', korean: 'ì‹œì›í•œ', category: 'temperature', color: '#87CEEB' },
  { id: 'neutral', label: 'Neutral', korean: 'ì¤‘ì„±ì ì¸', category: 'temperature', color: '#F5F5F5' },
  { id: 'hot', label: 'Hot', korean: 'ëœ¨ê±°ìš´', category: 'temperature', color: '#FF4500' },
  { id: 'cold', label: 'Cold', korean: 'ì°¨ê°€ìš´', category: 'temperature', color: '#4169E1' }
];

// í–¥ë¯¸ ì„ íƒ ê´€ë ¨ ìƒìˆ˜ë“¤
const FLAVOR_PHASES = [
  {id:"fragrance", label:"í”„ë˜ê·¸ëŸ°ìŠ¤", labelEn:"Fragrance"}, 
  {id:"aroma", label:"ì•„ë¡œë§ˆ", labelEn:"Aroma"}, 
  {id:"flavor", label:"í”Œë ˆì´ë²„", labelEn:"Flavor"}, 
  {id:"aftertaste", label:"ì—í”„í„°í…Œì´ìŠ¤íŠ¸", labelEn:"Aftertaste"}
];

const ATTR_TO_BADGE = {
  acidityLevel: {label:"ì‚°ë¯¸", labelEn:"Acidity", color:"#FF6B6B"},
  sweetnessLevel: {label:"ë‹¨ë§›", labelEn:"Sweetness", color:"#51CF66"},
  bodyLevel: {label:"ë°”ë””ê°", labelEn:"Body", color:"#339AF0"}
};

const ATTR_VALUE_LABELS = {
  "Low": {kr:"ë‚®ìŒ", en:"Low"}, 
  "Med-Low": {kr:"ë‚®ìŒ-ì¤‘ê°„", en:"Med-Low"}, 
  "Medium": {kr:"ì¤‘ê°„", en:"Medium"}, 
  "Med-High": {kr:"ì¤‘ê°„-ë†’ìŒ", en:"Med-High"}, 
  "High": {kr:"ë†’ìŒ", en:"High"}
};

const DEFECT_LABELS = {
  none: {label:"ë¯¸ì„ íƒ", labelEn:"None", color:"#bbb"},
  very_weak: {label:"ë§¤ìš° ì•½í•¨", labelEn:"Very Weak", color:"#9ad0c2"},
  weak: {label:"ì•½í•¨", labelEn:"Weak", color:"#95a7f2"},
  moderate: {label:"ë³´í†µ", labelEn:"Moderate", color:"#f6c177"},
  strong: {label:"ê°•í•¨", labelEn:"Strong", color:"#f59f4c"},
  very_strong: {label:"ë§¤ìš° ê°•í•¨", labelEn:"Very Strong", color:"#fc4747"}
};

const DEFECT_PROPS = [
  {key:"defectUnderdevelopment", label:"ì–¸ë”ë””ë²¨ë¡­ë¨¼íŠ¸", labelEn:"Underdevelopment", desc:"ë¡œìŠ¤íŒ… ë¶ˆì¶©ë¶„, ê°•í•œ ì‚°ë¯¸, í”¼ë‹ˆì‹œ/ì• í”„í„° ë¶€ì¡±", wheel:"Green/Vegetative"},
  {key:"defectOverdevelopment", label:"ì˜¤ë²„ë””ë²¨ë¡­ë¨¼íŠ¸", labelEn:"Overdevelopment", desc:"ê³¼ë„í•œ ë¡œìŠ¤íŒ…ìœ¼ë¡œ ì‚°ë¯¸, í”Œë ˆì´ë²„ ì†Œë©¸", wheel:"Roasted"},
  {key:"defectBaked", label:"ë² ì´í‚¹(ë² ì´í¬ë“œ)", labelEn:"Baked", desc:"íŒì½˜/ê·€ë¦¬/ì‹œë¦¬ì–¼ë¥˜ ê²°ì , ìºëŸ¬ë©œí™” ê³¼ì‰", wheel:"ê³¡ë¬¼(Cereal/Grain)"},
  {key:"defectScorching", label:"ìŠ¤ì½”ì¹­", labelEn:"Scorching", desc:"íƒ„ë§›, ê³¼ë‹¤ì—´ ë…¸ì¶œ, ì¬/íƒ„ ë…¸íŠ¸", wheel:"Roasted"}
];

// í–¥ë¯¸ ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë£¹í•‘ (í™•ì¥)
const FLAVOR_CATEGORIES = [
  { name: "ê³¼ì¼ë¥˜", nameEn: "Fruity", categories: ["Fruity"], color: "#FFB8A0" },
  { name: "ë‹¬ì½¤í•¨", nameEn: "Sweet", categories: ["Sweet"], color: "#FDE994" },
  { name: "ê½ƒí–¥", nameEn: "Floral", categories: ["Floral"], color: "#F5E5C0" },
  { name: "ê²¬ê³¼/ì´ˆì½œë¦¿", nameEn: "Nutty/Cocoa", categories: ["Nutty/Cocoa"], color: "#D7C2A8" },
  { name: "í–¥ì‹ ë£Œ", nameEn: "Spices", categories: ["Spices"], color: "#BDA55D" },
  { name: "ì°¨", nameEn: "Tea", categories: ["Tea"], color: "#8B4513" },
  { name: "ê³¡ë¬¼/ì‹œë¦¬ì–¼", nameEn: "Cereal/Grain", categories: ["Cereal/Grain"], color: "#E4CBB1" },
  { name: "ë¡œìŠ¤íŒ…", nameEn: "Roasted", categories: ["Roasted"], color: "#967969" },
  { name: "í’€/ì±„ì†Œë¥˜", nameEn: "Green/Vegetative", categories: ["Green/Vegetative"], color: "#A4C09C" },
  { name: "ì‚°ë¯¸/ë°œíš¨", nameEn: "Sour/Fermented", categories: ["Sour/Fermented"], color: "#CEE6CB" },
  { name: "ê¸°íƒ€", nameEn: "Other", categories: ["Other"], color: "#D7CEC7" }
];

// ìì£¼ ì‚¬ìš©í•˜ëŠ” í–¥ë¯¸ ë¦¬ìŠ¤íŠ¸ (í™•ì¥)
const FREQUENT_FLAVORS = [
  // ë² ë¦¬ë¥˜
  "Fruity|Berry|Strawberry",
  "Fruity|Berry|Blueberry", 
  "Fruity|Berry|Raspberry",
  "Fruity|Berry|Cranberry",
  "Fruity|Berry|Black Currant",
  
  // ê°ê·¤ë¥˜
  "Fruity|Citrus Fruit|Lemon",
  "Fruity|Citrus Fruit|Orange",
  "Fruity|Citrus Fruit|Grapefruit",
  "Fruity|Citrus Fruit|Bergamot",
  
  // í•µê³¼ë¥˜
  "Fruity|Stone Fruit|Peach",
  "Fruity|Stone Fruit|Apricot",
  "Fruity|Stone Fruit|Cherry",
  "Fruity|Stone Fruit|Plum",
  
  // ê½ƒí–¥
  "Floral|White Flowers|Coffee Blossom",
  "Floral|White Flowers|Jasmine",
  "Floral|Colored Flowers|Rose",
  "Floral|Colored Flowers|Lavender",
  
  // ì—´ëŒ€ê³¼ì¼
  "Fruity|Tropical Fruit|Passion Fruit",
  "Fruity|Tropical Fruit|Mango",
  "Fruity|Tropical Fruit|Papaya",
  "Fruity|Tropical Fruit|Guava",
  "Fruity|Tropical Fruit|Pineapple",
  
  // ê²¬ê³¼ë¥˜
  "Nutty/Cocoa|Tree Nuts|Almond",
  "Nutty/Cocoa|Tree Nuts|Walnut",
  "Nutty/Cocoa|Tree Nuts|Macadamia",
  "Nutty/Cocoa|Tree Nuts|Hazelnut",
  
  // ì´ˆì½œë¦¿
  "Nutty/Cocoa|Cocoa|Dark Chocolate",
  "Nutty/Cocoa|Cocoa|Milk Chocolate",
  "Nutty/Cocoa|Cocoa|Cocoa",
  
  // ë‹¨ë§›
  "Sweet|Caramelized|Caramel",
  "Sweet|Vanilla|Honey",
  "Sweet|Brown Sugar|Brown Sugar"
];

// ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë£¹í•‘ (ë‹¤êµ­ì–´ ì§€ì›)
const BODY_DESCRIPTOR_CATEGORIES = [
  { name: "ì§ˆê°", nameEn: "Texture", key: "texture", color: "#E6E6FA" },
  { name: "ë¬´ê²Œê°", nameEn: "Weight", key: "weight", color: "#DCDCDC" },
  { name: "ë°€ë„ê°", nameEn: "Density", key: "density", color: "#A0522D" },
  { name: "ì…ì•ˆê°ì´‰", nameEn: "Mouthfeel", key: "mouthfeel", color: "#DEB887" },
  { name: "ì˜¨ë„ê°", nameEn: "Temperature", key: "temperature", color: "#87CEEB" }
];

// ì–¸ì–´ ì§€ì›ì„ ìœ„í•œ ë²ˆì—­ ê°ì²´
const I18N_TEXTS = {
  ko: {
    'body-descriptor-title': 'ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°',
    'body-descriptor-desc': 'ì»¤í”¼ì˜ ì§ˆê°, ë°€ë„, ë¬´ê²Œê°ì„ í‘œí˜„í•˜ëŠ” ì„¸ë¶€ íŠ¹ì„±ì„ ì„ íƒí•˜ì„¸ìš” (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)',
    'body-descriptor-help': 'ì„ íƒëœ í•­ëª©ì€ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œë©ë‹ˆë‹¤. í´ë¦­í•˜ì—¬ ì„ íƒ/í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
  },
  en: {
    'body-descriptor-title': 'Body Descriptors',
    'body-descriptor-desc': 'Select detailed characteristics that express the texture, density, and weight of coffee (multiple selections possible)',
    'body-descriptor-help': 'Selected items are highlighted. Click to select/deselect.'
  }
};

/* === 2ë‹¨ê³„: í•µì‹¬ ë³€ìˆ˜ ë° ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ === */

// ì „ì—­ ë³€ìˆ˜ë“¤
let samples = [];
let currentSampleId = null;
let sampleSaveTimeout = null;
let flavorProfileChart = null;
let sortableInstance = null;
let currentLanguage = 'en'; // ì–¸ì–´ ê¸°ë³¸ê°’ì„ ì˜ì–´ë¡œ ì„¤ì •
let chartObjects = {};
let currentFlavorCategory = null;
let currentFlavorPhase = "fragrance";
let lastErrorCount = 0;

// í–¥ë¯¸ íœ  ì•„ì½”ë””ì–¸ í† ê¸€ í•¨ìˆ˜
function toggleAccordion(header) {
  if (!header) return;
  
  const content = header.nextElementSibling;
  if (!content) return;
  
  const isOpen = content.classList.toggle('show');
  
  // ì•„ì´ì½˜ ë³€ê²½
  const icon = header.querySelector('.accordion-icon');
  if (icon) {
    icon.innerHTML = isOpen ? '<i class="fas fa-chevron-up"></i>' : '<i class="fas fa-chevron-down"></i>';
  }
}

// í•œêµ­ì–´ ì´ˆì„± ì¶”ì¶œ í•¨ìˆ˜
function getKoreanInitials(text) {
  if (!text) return '';
  
  const initials = ['ã„±','ã„²','ã„´','ã„·','ã„¸','ã„¹','ã…','ã…‚','ã…ƒ','ã……','ã…†','ã…‡','ã…ˆ','ã…‰','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
  
  return text.split('').map(char => {
    const code = char.charCodeAt(0);
    if (code >= 0xAC00 && code <= 0xD7A3) {
      // í•œê¸€ ìœ ë‹ˆì½”ë“œ ë²”ìœ„
      const index = Math.floor((code - 0xAC00) / 588);
      return initials[index];
    }
    return char;
  }).join('');
}

// í•œêµ­ì–´ ì´ˆì„± ë§¤ì¹­ í•¨ìˆ˜
function matchKoreanInitials(text, searchTerm) {
  if (!text || !searchTerm) return false;
  
  const textInitials = getKoreanInitials(text.toLowerCase());
  const searchInitials = getKoreanInitials(searchTerm.toLowerCase());
  
  // ì¼ë°˜ í…ìŠ¤íŠ¸ ë§¤ì¹­ë„ í•¨ê»˜ í™•ì¸
  return text.toLowerCase().includes(searchTerm.toLowerCase()) || 
         textInitials.includes(searchInitials) ||
         textInitials.includes(searchTerm.toLowerCase());
}

// ë°°ê²½ìƒ‰ì— ë”°ë¥¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ìµœì í™” í•¨ìˆ˜
function getContrastColor(hexColor) {
  if (!hexColor || typeof hexColor !== 'string') return '#000000';
  
  let r, g, b;
  if (hexColor.startsWith('#')) {
    hexColor = hexColor.substring(1);
  }
  
  if (hexColor.length === 3) {
    r = parseInt(hexColor.charAt(0) + hexColor.charAt(0), 16);
    g = parseInt(hexColor.charAt(1) + hexColor.charAt(1), 16);
    b = parseInt(hexColor.charAt(2) + hexColor.charAt(2), 16);
  } 
  else if (hexColor.length === 6) {
    r = parseInt(hexColor.substring(0, 2), 16);
    g = parseInt(hexColor.substring(2, 4), 16);
    b = parseInt(hexColor.substring(4, 6), 16);
  } else {
    return '#000000';
  }
  
  const brightness = (r * 299 + g * 587 + b * 114) / 1000;
  return brightness > 128 ? '#000000' : '#FFFFFF';
}

// ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
function getI18nText(key, lang = currentLanguage) {
  return I18N_TEXTS[lang] && I18N_TEXTS[lang][key] ? I18N_TEXTS[lang][key] : key;
}

// ì–¸ì–´ì— ë”°ë¥¸ ë ˆì´ë¸” ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
function getLocalizedLabel(item, lang = currentLanguage) {
  if (lang === 'ko') {
    return item.label || item.labelEn || item.name || item.nameEn || '';
  } else {
    return item.labelEn || item.label || item.nameEn || item.name || '';
  }
}

// ë¹ˆ ìƒ˜í”Œ ë°ì´í„° ìƒì„±
function getEmptySampleData() {
  let flavorSelections = {}; 
  FLAVOR_PHASES.forEach(phase => flavorSelections[phase.id] = []);
  return {
    title: "", coffeeName: "", origin: "", variety: "", process: "", roastDate: "", roastLevel: "",
    flavorSelections, acidityLevel: "", sweetnessLevel: "", bodyLevel: "",
    bodyDescriptors: [], // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ì¶”ê°€
    defectUnderdevelopment: "none", defectOverdevelopment: "none", defectBaked: "none", defectScorching: "none",
    scoreFragrance: 7, scoreAroma: 7, scoreFlavor: 7, scoreAftertaste: 7, scoreAcidity: 7, scoreBody: 7, scoreBalance: 7, scoreOverall: 7,
    tastingNotes: "", lastEdit: +(new Date())
  };
}

// ìƒˆ ìƒ˜í”Œ ê°ì²´ ìƒì„±
function createNewSampleObj(title) {
  let id = "sample_" + Date.now() + "_" + Math.floor(Math.random() * 10000);
  return {id, title: title || "ìƒˆ ìƒ˜í”Œ", sampleData: getEmptySampleData(), lastEdit: +(new Date())};
}

// ìƒ˜í”Œ ì´ë™ ì‹œ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
function showSampleToast(sampleName) {
  const toast = document.getElementById('sampleToast');
  if (toast) {
    toast.textContent = sampleName;
    toast.classList.add('show');
    
    setTimeout(() => {
      toast.classList.remove('show');
    }, 1500);
  }
}

// í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
function showToast(msg) {
  try {
    let toast = document.getElementById('toast');
    if (toast) {
      toast.innerHTML = msg;
      toast.classList.add('show');
      setTimeout(() => {toast.classList.remove('show');}, 1800);
    }
  } catch(e) {
    console.error("í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ ì¤‘ ì˜¤ë¥˜:", e);
  }
}

// í˜„ì¬ ìƒ˜í”Œ í‘œì‹œ ì—…ë°ì´íŠ¸
function updateCurrentSampleIndicator() {
  const indicator = document.getElementById('currentSampleIndicator');
  if (!indicator) return;
  
  const currentSample = getCurrentSampleObj();
  if (currentSample) {
    indicator.querySelector('span').textContent = currentSample.title || "ìƒ˜í”Œ";
    
    const currentIndex = samples.findIndex(s => s.id === currentSampleId);
    if (currentIndex > -1) {
      indicator.querySelector('span').textContent += ` (${currentIndex + 1}/${samples.length})`;
    }
  } else {
    indicator.querySelector('span').textContent = "ìƒ˜í”Œ ì—†ìŒ";
  }
}

// ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
function updateNavigationButtons() {
  const prevBtn = document.getElementById('prevSampleBtn');
  const nextBtn = document.getElementById('nextSampleBtn');
  
  if (!prevBtn || !nextBtn || !samples.length) return;
  
  const currentIndex = samples.findIndex(s => s.id === currentSampleId);
  
  prevBtn.disabled = currentIndex <= 0;
  prevBtn.classList.toggle('opacity-50', currentIndex <= 0);
  prevBtn.classList.toggle('cursor-not-allowed', currentIndex <= 0);
  
  nextBtn.disabled = currentIndex >= samples.length - 1;
  nextBtn.classList.toggle('opacity-50', currentIndex >= samples.length - 1);
  nextBtn.classList.toggle('cursor-not-allowed', currentIndex >= samples.length - 1);
}

// ì´ì „/ë‹¤ìŒ ìƒ˜í”Œë¡œ ì´ë™
function goToPrevSample() {
  if (!samples.length) return;
  
  const currentIndex = samples.findIndex(s => s.id === currentSampleId);
  if (currentIndex > 0) {
    loadSample(samples[currentIndex - 1].id);
    showSampleToast(samples[currentIndex - 1].title || "ìƒ˜í”Œ");
  }
}

function goToNextSample() {
  if (!samples.length) return;
  
  const currentIndex = samples.findIndex(s => s.id === currentSampleId);
  if (currentIndex < samples.length - 1) {
    loadSample(samples[currentIndex + 1].id);
    showSampleToast(samples[currentIndex + 1].title || "ìƒ˜í”Œ");
  }
}

// ì²´í¬ëœ ë¼ë””ì˜¤ ë²„íŠ¼ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°
function getCheckedRadio(name) {
  let radio = document.querySelector(`input[name="${name}"]:checked`);
  return radio ? radio.value : "";
}

// í–¥ë¯¸ ì¹´í…Œê³ ë¦¬ í•„í„°ë§
function filterByCategory(category) {
  currentFlavorCategory = currentFlavorCategory === category ? null : category;
  
  document.querySelectorAll('.flavor-category-tab').forEach(tab => {
    tab.classList.toggle('active', tab.dataset.category === currentFlavorCategory);
  });
  
  const allCategories = document.querySelectorAll('.flavor-category-accordion');
  
  if (currentFlavorCategory) {
    allCategories.forEach(cat => {
      if (cat.dataset.category === currentFlavorCategory) {
        cat.classList.remove('flavor-fix-hidden');
        const content = cat.querySelector('.flavor-category-content');
        if (content) {
          content.classList.add('show');
          const icon = content.previousElementSibling.querySelector('.accordion-icon');
          if (icon) icon.innerHTML = '<i class="fas fa-chevron-up"></i>';
        }
      } else {
        cat.classList.add('flavor-fix-hidden');
      }
    });
  } else {
    allCategories.forEach(cat => {
      cat.classList.remove('flavor-fix-hidden');
    });
  }
}

// ì–¸ì–´ ì „í™˜ í•¨ìˆ˜ ê°œì„ 
function switchLanguage(lang) {
  if (currentLanguage === lang) return; // ë™ì¼í•œ ì–¸ì–´ë©´ ë¬´ì‹œ
  
  currentLanguage = lang;
  
  // ì–¸ì–´ í† ê¸€ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
  const langEn = document.getElementById('langEn');
  const langKo = document.getElementById('langKo');
  
  if (langEn && langKo) {
    langEn.classList.toggle('active', lang === 'en');
    langKo.classList.toggle('active', lang === 'ko');
  }
  
  // ì–¸ì–´ ë³€ê²½ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
  const flavorArea = document.getElementById('flavorWheelMultiSelectArea');
  const bodyArea = document.getElementById('bodyDescriptorArea');
  
  if (flavorArea) {
    flavorArea.classList.add('language-transition', 'fade-out');
  }
  if (bodyArea) {
    bodyArea.classList.add('language-transition', 'fade-out');
  }
  
  // ì§€ì—° í›„ UI ì—…ë°ì´íŠ¸
  setTimeout(() => {
    // í–¥ë¯¸ ê´€ë ¨ UI ì—…ë°ì´íŠ¸
    renderFlavorTabs();
    renderFlavorPhase();
    
    // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° UI ì—…ë°ì´íŠ¸
    renderBodyDescriptors();
    
    // ì„ íƒëœ í–¥ë¯¸ ì˜ì—­ ì—…ë°ì´íŠ¸
    renderSelectedFlavorsArea();
    
    // ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
    updateI18nTexts();
    
    // í˜ì´ë“œ ì¸ íš¨ê³¼
    setTimeout(() => {
      if (flavorArea) {
        flavorArea.classList.remove('language-transition', 'fade-out');
      }
      if (bodyArea) {
        bodyArea.classList.remove('language-transition', 'fade-out');
      }
    }, 100);
    
  }, 200);
  
  console.log(`ì–¸ì–´ê°€ ${lang === 'ko' ? 'í•œêµ­ì–´' : 'ì˜ì–´'}ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
}

// ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateI18nTexts() {
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    const text = getI18nText(key);
    if (text !== key) {
      element.textContent = text;
    }
  });
}

// ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ë Œë”ë§ ê°œì„ 
function renderBodyDescriptors() {
  const container = document.getElementById('bodyDescriptorArea');
  if (!container) return;
  
  const currentSample = getCurrentSampleObj();
  const selectedDescriptors = currentSample ? (currentSample.sampleData.bodyDescriptors || []) : [];
  
  let html = '';
  
  // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ë Œë”ë§
  BODY_DESCRIPTOR_CATEGORIES.forEach(category => {
    const categoryDescriptors = BODY_DESCRIPTORS.filter(d => d.category === category.key);
    
    if (categoryDescriptors.length > 0) {
      const categoryName = currentLanguage === 'ko' ? category.name : category.nameEn;
      html += `<div class="col-span-full body-category-header">${categoryName}</div>`;
      
      categoryDescriptors.forEach(descriptor => {
        const isSelected = selectedDescriptors.includes(descriptor.id);
        const displayText = currentLanguage === 'ko' ? descriptor.korean : descriptor.label;
        const selectedClass = isSelected ? 'selected' : '';
        
        html += `
          <div class="body-descriptor-item ${selectedClass}" 
               data-descriptor="${descriptor.id}"
               style="border-color: ${descriptor.color};"
               onclick="toggleBodyDescriptor('${descriptor.id}')">
            <input type="checkbox" ${isSelected ? 'checked' : ''}>
            <span class="checkbox-custom"></span>
            <span>${displayText}</span>
          </div>
        `;
      });
    }
  });
  
  container.innerHTML = html;
  
  console.log(`ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ë Œë”ë§ ì™„ë£Œ (ì–¸ì–´: ${currentLanguage})`);
}

// ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° í† ê¸€ í•¨ìˆ˜ ê°œì„ 
function toggleBodyDescriptor(descriptorId) {
  const currentSample = getCurrentSampleObj();
  if (!currentSample) return;
  
  const descriptors = currentSample.sampleData.bodyDescriptors || [];
  const index = descriptors.indexOf(descriptorId);
  
  if (index > -1) {
    descriptors.splice(index, 1);
  } else {
    descriptors.push(descriptorId);
  }
  
  currentSample.sampleData.bodyDescriptors = descriptors;
  
  // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸ (í–¥ë¯¸ ì„ íƒê³¼ ë™ì¼í•œ ë°©ì‹)
  const itemElement = document.querySelector(`[data-descriptor="${descriptorId}"]`);
  if (itemElement) {
    const checkbox = itemElement.querySelector('input[type="checkbox"]');
    const isSelected = descriptors.includes(descriptorId);
    
    if (checkbox) {
      checkbox.checked = isSelected;
    }
    
    if (isSelected) {
      itemElement.classList.add('selected');
    } else {
      itemElement.classList.remove('selected');
    }
  }
  
  renderSelectedFlavorsArea();
  scheduleAutoSave();
  
  console.log(`ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° '${descriptorId}' í† ê¸€ë¨:`, descriptors.includes(descriptorId));
}

/* === 3ë‹¨ê³„: UI ë Œë”ë§ ë° ìƒí˜¸ì‘ìš© í•¨ìˆ˜ === */

// Flavor Tabs ë Œë”ë§ ê°œì„ 
function renderFlavorTabs() {
  const tabs = document.getElementById('flavorTabs');
  if (!tabs) return;
  
  tabs.innerHTML = '';
  FLAVOR_PHASES.forEach(phase => {
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'flavor-phase-btn font-bold rounded px-4 py-1 mr-1 mb-1 mobile-touch-friendly ' + 
      (currentFlavorPhase === phase.id ? 'tab-btn-active' : 'tab-btn-inactive');
    
    // ì–¸ì–´ì— ë”°ë¥¸ ë ˆì´ë¸” í‘œì‹œ
    btn.textContent = currentLanguage === 'ko' ? phase.label : phase.labelEn;
    btn.dataset.flavorphase = phase.id;
    btn.onclick = () => {
      currentFlavorPhase = phase.id;
      renderFlavorTabs();
      renderFlavorPhase();
    };
    tabs.appendChild(btn);
  });
  
  console.log(`í–¥ë¯¸ íƒ­ ë Œë”ë§ ì™„ë£Œ (ì–¸ì–´: ${currentLanguage})`);
}

// í–¥ë¯¸ ì„ íƒ ì˜ì—­ ë Œë”ë§ ê°œì„ 
function renderFlavorPhase() {
  const currentSample = getCurrentSampleObj();
  if (!currentSample) return;
  
  let curSel = currentSample.sampleData.flavorSelections[currentFlavorPhase] || [];
  let outer = document.getElementById('flavorWheelMultiSelectArea');
  
  if (!outer) return;
  
  outer.innerHTML = `
    <div class="flex justify-center items-center p-4">
      <svg class="animate-spin -ml-1 mr-3 h-6 w-6 text-amber-700" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <span class="text-amber-700">í–¥ë¯¸ ì„ íƒê¸° ë¡œë”© ì¤‘...</span>
    </div>
  `;
  
  const categoryMapping = {};
  FLAVOR_CATEGORIES.forEach(cat => {
    cat.categories.forEach(engCat => {
      categoryMapping[engCat] = currentLanguage === 'ko' ? cat.name : cat.nameEn;
    });
  });
  
  let html = `
    <div class="search-box mb-3">
      <input type="text" id="flavorSearchInput" class="search-input" 
        placeholder="${currentLanguage === 'ko' ? 'í–¥ë¯¸ ê²€ìƒ‰ (ë² ë¦¬, ì´ˆì½œë¦¿, ê½ƒí–¥, ì´ˆì„±: ã…‚ã„¹, ã…Šã…‹ã„¹ ë“±...)' : 'Search flavors (berry, chocolate, floral, etc...)'}">
      <div class="text-xs text-gray-500 mt-1 px-2">
        ${currentLanguage === 'ko' ? 'ğŸ’¡ íŒ: í•œêµ­ì–´ ì´ˆì„±ìœ¼ë¡œë„ ê²€ìƒ‰ ê°€ëŠ¥ (ì˜ˆ: "ã…‚ã„¹" â†’ ë² ë¦¬ë¥˜, "ã…Šã…‹ã„¹" â†’ ì´ˆì½œë¦¿)' : 'ğŸ’¡ Tip: Search with Korean initials (e.g., "ã…‚ã„¹" â†’ Berry)'}
      </div>
   </div>
    
    <div class="flavor-category-tabs">
  `;
  
  // ì¹´í…Œê³ ë¦¬ íƒ­ ì¶”ê°€ (ì–¸ì–´ë³„)
  FLAVOR_CATEGORIES.forEach(category => {
    const categoryName = currentLanguage === 'ko' ? category.name : category.nameEn;
    html += `
      <button type="button" class="flavor-category-tab ${currentFlavorCategory === categoryName ? 'active' : ''}" 
              data-category="${categoryName}" onclick="filterByCategory('${categoryName}')">
        ${categoryName}
      </button>
    `;
  });
  
  html += `</div>
    
    <div class="frequently-used-flavors">
      <h4><i class="fas fa-star mr-1"></i> ${currentLanguage === 'ko' ? 'ìì£¼ ì‚¬ìš©í•˜ëŠ” í–¥ë¯¸' : 'Frequently Used Flavors'}</h4>
      <div class="flex flex-wrap">
  `;
  
  // ìì£¼ ì‚¬ìš©í•˜ëŠ” í–¥ë¯¸ ëª©ë¡ ë Œë”ë§
  FREQUENT_FLAVORS.forEach(key => {
    const [cat, sub, desc] = key.split('|');
    const rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
    if (rec) {
      const color = rec[3] || '#B8B2A5';
      const textColor = getContrastColor(color);
      const displayName = currentLanguage === 'ko' && rec.length > 6 ? rec[6] : desc;
      const checked = curSel.includes(key) ? ' checked ' : '';
      const selectedClass = checked ? 'selected-flavor' : '';
      
      html += `
        <label class="flavor-checkbox-label ${selectedClass}" style="background:${color};color:${textColor};">
          <input type="checkbox" class="flavorSelectBox" data-key="${key}" ${checked}>
          <span class="checkbox-custom"></span>
          ${displayName}
        </label>
      `;
    }
  });
  
  html += `
      </div>
    </div>
  `;
  
  // ì¹´í…Œê³ ë¦¬ë³„ë¡œ í–¥ë¯¸ë¥¼ ê·¸ë£¹í™”
  const flavorsByCategory = {};
  
  FLAVOR_CATEGORIES.forEach(category => {
    const categoryName = currentLanguage === 'ko' ? category.name : category.nameEn;
    flavorsByCategory[categoryName] = [];
    
    category.categories.forEach(engCategory => {
      FLAVOR_DATA.forEach(flavor => {
        if (flavor[0] === engCategory) {
          flavorsByCategory[categoryName].push(flavor);
        }
      });
    });
  });
  
  // ê° ì¹´í…Œê³ ë¦¬ë³„ ì•„ì½”ë””ì–¸ ìƒì„±
  Object.keys(flavorsByCategory).forEach(categoryName => {
    const flavors = flavorsByCategory[categoryName];
    if (!flavors || flavors.length === 0) return;
    
    const isHidden = currentFlavorCategory && currentFlavorCategory !== categoryName;
    
    html += `
      <div class="flavor-category-accordion mb-3 ${isHidden ? 'flavor-fix-hidden' : ''}" data-category="${categoryName}">
        <div class="flavor-category-header" onclick="toggleAccordion(this)">
          <h4>${categoryName}</h4>
          <span class="accordion-icon"><i class="fas fa-chevron-${isHidden ? 'down' : 'up'}"></i></span>
        </div>
        <div class="flavor-category-content ${isHidden ? '' : 'show'}">
    `;
    
    // ì„œë¸Œì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
    const flavorsBySubCategory = {};
    
    flavors.forEach(flavor => {
      const subCategory = flavor[1] || 'ì¼ë°˜';
      let displaySubCategory;
      
      if (currentLanguage === 'ko') {
        displaySubCategory = flavor[5] || subCategory;
      } else {
        displaySubCategory = subCategory;
      }
      
      if (!flavorsBySubCategory[displaySubCategory]) {
        flavorsBySubCategory[displaySubCategory] = [];
      }
      
      flavorsBySubCategory[displaySubCategory].push(flavor);
    });
    
    // ê° ì„œë¸Œì¹´í…Œê³ ë¦¬ ë Œë”ë§
    Object.keys(flavorsBySubCategory).sort().forEach(subCategory => {
      const subFlavors = flavorsBySubCategory[subCategory];
      
      if (subCategory !== 'ì¼ë°˜' && subCategory !== 'General') {
        html += `<div class="flavor-subcategory-title">${subCategory}</div>`;
      }
      
      html += `<div class="flavor-items flex flex-wrap">`;
      
      subFlavors.forEach(flavor => {
        const [cat, sub, desc, color, catKr, subKr, descKr] = flavor;
        const id = cat+'|'+sub+'|'+desc;
        const checked = curSel.includes(id) ? ' checked ' : '';
        const textColor = getContrastColor(color);
        const displayName = currentLanguage === 'ko' && descKr ? descKr : desc;
        const selectedClass = checked ? 'selected-flavor' : '';
        
        html += `
          <label class="flavor-checkbox-label ${selectedClass}" style="background:${color};color:${textColor};" 
                data-category="${cat}" data-subcategory="${sub}" data-flavor-en="${desc.toLowerCase()}" data-flavor-kr="${(descKr||'').toLowerCase()}">
            <input type="checkbox" class="flavorSelectBox" data-key="${id}" ${checked}>
            <span class="checkbox-custom"></span>
            ${displayName}
          </label>
        `;
      });
      
      html += `</div>`;
    });
    
    html += `
        </div>
      </div>
    `;
  });
  
  outer.innerHTML = html;
  
  // í–¥ë¯¸ ê²€ìƒ‰ ê¸°ëŠ¥
  const searchInput = document.getElementById('flavorSearchInput');
  if (searchInput) {
    let searchTimeout;
    searchInput.addEventListener('input', function() {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        const searchTerm = this.value.trim().toLowerCase();
        
        if (searchTerm === '') {
          document.querySelectorAll('.flavor-checkbox-label').forEach(label => {
            label.style.display = '';
            label.classList.remove('search-highlight');
          });
          
          document.querySelectorAll('.flavor-category-accordion').forEach(cat => {
            const categoryName = currentLanguage === 'ko' ? 
              FLAVOR_CATEGORIES.find(c => c.nameEn === cat.dataset.category)?.name || cat.dataset.category :
              cat.dataset.category;
            cat.classList.toggle('flavor-fix-hidden', currentFlavorCategory && categoryName !== currentFlavorCategory);
          });
          
          document.querySelectorAll('.flavor-subcategory-title').forEach(title => {
            title.style.display = '';
          });
          return;
        }
        
        document.querySelectorAll('.flavor-category-content').forEach(content => {
          content.classList.add('show');
          const icon = content.previousElementSibling.querySelector('.accordion-icon');
          if (icon) icon.innerHTML = '<i class="fas fa-chevron-up"></i>';
        });
        
        document.querySelectorAll('.flavor-category-accordion').forEach(cat => {
          cat.classList.remove('flavor-fix-hidden');
        });
        
        let visibleCategories = new Set();
        
        document.querySelectorAll('.flavor-checkbox-label').forEach(label => {
          const flavorEn = label.dataset.flavorEn?.toLowerCase() || '';
          const flavorKr = label.dataset.flavorKr?.toLowerCase() || '';
          const category = label.dataset.category?.toLowerCase() || '';
          const subcategory = label.dataset.subcategory?.toLowerCase() || '';
          
// ê¸°ë³¸ í…ìŠ¤íŠ¸ ë§¤ì¹­
const basicMatch = flavorEn.includes(searchTerm) || 
                 flavorKr.includes(searchTerm) || 
                 category.includes(searchTerm) || 
                 subcategory.includes(searchTerm);

// í•œêµ­ì–´ ì´ˆì„± ë§¤ì¹­
const initialMatch = matchKoreanInitials(flavorKr, searchTerm) ||
                    matchKoreanInitials(category, searchTerm) ||
                    matchKoreanInitials(subcategory, searchTerm);

if (basicMatch || initialMatch) {
            label.style.display = '';
            label.classList.add('search-highlight');
            
            const categoryAccordion = label.closest('.flavor-category-accordion');
            if (categoryAccordion) {
              visibleCategories.add(categoryAccordion);
            }
          } else {
            label.style.display = 'none';
            label.classList.remove('search-highlight');
          }
        });
        
        document.querySelectorAll('.flavor-category-accordion').forEach(accordion => {
          accordion.classList.toggle('flavor-fix-hidden', !visibleCategories.has(accordion));
        });
        
        document.querySelectorAll('.flavor-subcategory-title').forEach(title => {
          let hasVisibleFlavor = false;
          let current = title.nextElementSibling;
          
          while (current && !current.classList.contains('flavor-subcategory-title')) {
            if (current.classList.contains('flavor-items')) {
              const visibleLabels = Array.from(current.querySelectorAll('.flavor-checkbox-label'))
                .filter(label => label.style.display !== 'none');
                
              if (visibleLabels.length > 0) {
                hasVisibleFlavor = true;
                break;
              }
            }
            current = current.nextElementSibling;
          }
          
          title.style.display = hasVisibleFlavor ? '' : 'none';
        });
      }, 250);
    });
  }
  
  // í–¥ë¯¸ ì„ íƒ ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ì²˜ë¦¬ ê°œì„ 
  outer.querySelectorAll('.flavorSelectBox').forEach(cb => {
    cb.onchange = function() {
      if (!currentSampleId) return;
      
      const currentSample = getCurrentSampleObj();
      if (!currentSample) return;
      
      let sel = currentSample.sampleData.flavorSelections[currentFlavorPhase];
      let key = this.getAttribute('data-key');
      
      if (this.checked) {
        if (sel.indexOf(key) === -1) {
          if (sel.length < 10) {
            sel.push(key);
            this.closest('label').classList.add('selected-flavor');
          } else {
            this.checked = false;
            showToast("ê° í•­ëª©ë‹¹ ìµœëŒ€ 10ê°œê¹Œì§€ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
            return;
          }
        }
      } else {
        let idx = sel.indexOf(key);
        if (idx > -1) {
          sel.splice(idx, 1);
          this.closest('label').classList.remove('selected-flavor');
        }
      }
      
      renderSelectedFlavorsArea();
      scheduleAutoSave();
    };
  });
  
  console.log(`ì„ íƒëœ í–¥ë¯¸ ì˜ì—­ ì—…ë°ì´íŠ¸ ì™„ë£Œ (ì–¸ì–´: ${currentLanguage})`);
}

// ìƒ˜í”Œ ë°ì´í„°ì—ì„œ í–¥ë¯¸ ìš”ì•½ HTML ë°˜í™˜
function getFlavorSummaryHtml(sampleData) {
  let html = '';
  FLAVOR_PHASES.forEach(phase => {
    const phaseLabel = currentLanguage === 'ko' ? phase.label : phase.labelEn;
    const phaseSel = (sampleData.flavorSelections[phase.id] || []).map(key => {
      const [cat, sub, desc] = key.split('|');
      const rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
      if (!rec) return '';
      const color = rec[3] || '#B8B2A5';
      const displayName = currentLanguage === 'ko' && rec.length > 6 ? rec[6] : desc;
      const textColor = getContrastColor(color);
      return `<span class="flavor-badge" style="background:${color};color:${textColor};">${displayName}</span>`;
    }).filter(b => b !== '').join(' ');
    html += `<div class="mb-1"><span class="font-bold">${phaseLabel}:</span> ${phaseSel || '<span class="text-xs text-gray-400">ì—†ìŒ</span>'}</div>`;
  });

  html += `<div class="mt-2">`;
  Object.keys(ATTR_TO_BADGE).forEach(attrKey => {
    const attrMeta = ATTR_TO_BADGE[attrKey];
    const val = sampleData[attrKey];
    const attrLabel = currentLanguage === 'ko' ? attrMeta.label : attrMeta.labelEn;
    const valLabel = val && ATTR_VALUE_LABELS[val] ?
      (currentLanguage === 'ko' ? ATTR_VALUE_LABELS[val].kr : ATTR_VALUE_LABELS[val].en) : 'ë¯¸ì„ íƒ';
    const opacity = val ? '1' : '0.5';
    html += `<span class="flavor-badge" style="background:${attrMeta.color};color:#fff;opacity:${opacity};">${attrLabel}: ${valLabel}</span>`;
  });
  html += `</div>`;

  if (sampleData.bodyDescriptors && sampleData.bodyDescriptors.length > 0) {
    html += `<div class="mt-2 mb-1"><span class="font-bold">ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°:</span><div class="flex flex-wrap gap-1 mt-1">`;
    sampleData.bodyDescriptors.forEach(descriptorId => {
      const descriptor = BODY_DESCRIPTORS.find(d => d.id === descriptorId);
      if (descriptor) {
        const displayText = currentLanguage === 'ko' ? descriptor.korean : descriptor.label;
        const textColor = getContrastColor(descriptor.color);
        html += `<span class="flavor-badge" style="background:${descriptor.color};color:${textColor};">${displayText}</span>`;
      }
    });
    html += `</div></div>`;
  }
  return html;
}

// í–¥ë¯¸ íŠ¹ì„±/ì†ì„± ì‹¤ì‹œê°„ ë°˜ì˜ ê°œì„  (ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° í¬í•¨)
function renderSelectedFlavorsArea(_data) {
  let sampleData;
  
  if (_data) {
    sampleData = _data;
  } else {
    const currentSample = getCurrentSampleObj();
    if (!currentSample) return;
    sampleData = currentSample.sampleData;
  }
  
  let html = '';
  
  // ê° ë‹¨ê³„ë³„ í–¥ë¯¸ í‘œì‹œ
  FLAVOR_PHASES.forEach(phase => {
    const phaseLabel = currentLanguage === 'ko' ? phase.label : phase.labelEn;
    let phaseSel = (sampleData.flavorSelections[phase.id] || []).map(key => {
      let [cat, sub, desc] = key.split('|');
      let rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
      if (!rec) return '';
      
      let color = rec[3] || '#B8B2A5';
      let displayName = currentLanguage === 'ko' && rec.length > 6 ? rec[6] : desc;
      
      let textColor = getContrastColor(color);
      return `<span class="flavor-badge" style="background:${color};color:${textColor};">${displayName}</span>`;
    }).filter(badge => badge !== '');
    
    html += `<div class="mb-1">
      <span class="font-bold">${phaseLabel}:</span> 
      ${phaseSel.join(' ') || '<span class="text-xs text-gray-400">ì—†ìŒ</span>'}
    </div>`;
  });
  
  // ì†ì„± í‘œì‹œ
  html += `<div class="mt-2 mb-1 flex flex-wrap items-center">`;
  Object.keys(ATTR_TO_BADGE).forEach(attrKey => {
    let attrMeta = ATTR_TO_BADGE[attrKey];
    let val = sampleData[attrKey];
    const attrLabel = currentLanguage === 'ko' ? attrMeta.label : attrMeta.labelEn;
    const valLabel = val && ATTR_VALUE_LABELS[val] ? 
      (currentLanguage === 'ko' ? ATTR_VALUE_LABELS[val].kr : ATTR_VALUE_LABELS[val].en) : 
      (currentLanguage === 'ko' ? 'ë¯¸ì„ íƒ' : 'None');
    
    if (val) {
      html += `<span class="flavor-badge" style="background:${attrMeta.color};color:#fff;">
        ${attrLabel}: ${valLabel}
      </span>`;
    } else {
      html += `<span class="flavor-badge" style="background:${attrMeta.color};color:#fff;opacity:0.5;">
        ${attrLabel}: ${valLabel}
      </span>`;
    }
  });
  html += `</div>`;
  
  // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° í‘œì‹œ ê°œì„ 
  if (sampleData.bodyDescriptors && sampleData.bodyDescriptors.length > 0) {
    const bodyLabel = currentLanguage === 'ko' ? 'ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°' : 'Body Descriptors';
    html += `<div class="mt-2 mb-1">
      <span class="font-bold">${bodyLabel}:</span>
      <div class="flex flex-wrap gap-1 mt-1">`;
    
    sampleData.bodyDescriptors.forEach(descriptorId => {
      const descriptor = BODY_DESCRIPTORS.find(d => d.id === descriptorId);
      if (descriptor) {
        const displayText = currentLanguage === 'ko' ? descriptor.korean : descriptor.label;
        const textColor = getContrastColor(descriptor.color);
        html += `<span class="flavor-badge" style="background:${descriptor.color};color:${textColor};">
          ${displayText}
        </span>`;
      }
    });
    
    html += `</div></div>`;
  } else {
    const bodyLabel = currentLanguage === 'ko' ? 'ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°' : 'Body Descriptors';
    const noneLabel = currentLanguage === 'ko' ? 'ì„ íƒëœ í•­ëª© ì—†ìŒ' : 'No items selected';
    html += `<div class="mt-2 mb-1">
      <span class="font-bold">${bodyLabel}:</span>
      <span class="text-xs text-gray-400 ml-2">${noneLabel}</span>
    </div>`;
  }
  
  // ë¡œìŠ¤íŒ… ë””í™íŠ¸ í‘œì‹œ
  const defectLabel = currentLanguage === 'ko' ? 'ë¡œìŠ¤íŒ… ë””í™íŠ¸' : 'Roasting Defects';
  html += `<div class="mt-2">
    <span class="font-bold">${defectLabel}:</span>
    <div class="flex flex-wrap gap-1 mt-1">`;
    
  let hasDefect = false;
  DEFECT_PROPS.forEach(d => {
    const val = sampleData[d.key] || "none";
    if (val !== "none") {
      const dColor = DEFECT_LABELS[val] ? DEFECT_LABELS[val].color : "#bbb";
      const defectNameLabel = currentLanguage === 'ko' ? d.label : d.labelEn;
      const defectValueLabel = currentLanguage === 'ko' ? DEFECT_LABELS[val].label : DEFECT_LABELS[val].labelEn;
      html += `<span class="flavor-badge" style="background:${dColor};color:#fff;">
        ${defectNameLabel}: ${defectValueLabel}
      </span>`;
      hasDefect = true;
    }
  });
  
  if (!hasDefect) {
    const noDefectLabel = currentLanguage === 'ko' ? 'ì„ íƒëœ ë””í™íŠ¸ ì—†ìŒ' : 'No defects selected';
    html += `<span class="text-xs text-gray-400">${noDefectLabel}</span>`;
  }
  
  html += `</div></div>`;
  
  const flavorArea = document.getElementById('selectedFlavorsArea');
  if (flavorArea) {
    flavorArea.innerHTML = html;
  }
  
  console.log(`ì„ íƒëœ í–¥ë¯¸ ì˜ì—­ ì—…ë°ì´íŠ¸ ì™„ë£Œ (ì–¸ì–´: ${currentLanguage})`);
}

// ìƒ˜í”Œ ë°ì´í„°ì—ì„œ í–¥ë¯¸ ìš”ì•½ HTML ë°˜í™˜
function getFlavorSummaryHtml(sampleData) {
  let html = '';
  FLAVOR_PHASES.forEach(phase => {
    const phaseLabel = currentLanguage === 'ko' ? phase.label : phase.labelEn;
    const phaseSel = (sampleData.flavorSelections[phase.id] || []).map(key => {
      const [cat, sub, desc] = key.split('|');
      const rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
      if (!rec) return '';
      const color = rec[3] || '#B8B2A5';
      const displayName = currentLanguage === 'ko' && rec.length > 6 ? rec[6] : desc;
      const textColor = getContrastColor(color);
      return `<span class="flavor-badge" style="background:${color};color:${textColor};">${displayName}</span>`;
    }).filter(b => b !== '').join(' ');
    html += `<div class="mb-1"><span class="font-bold">${phaseLabel}:</span> ${phaseSel || '<span class="text-xs text-gray-400">ì—†ìŒ</span>'}</div>`;
  });

  html += `<div class="mt-2">`;
  Object.keys(ATTR_TO_BADGE).forEach(attrKey => {
    const attrMeta = ATTR_TO_BADGE[attrKey];
    const val = sampleData[attrKey];
    const attrLabel = currentLanguage === 'ko' ? attrMeta.label : attrMeta.labelEn;
    const valLabel = val && ATTR_VALUE_LABELS[val] ?
      (currentLanguage === 'ko' ? ATTR_VALUE_LABELS[val].kr : ATTR_VALUE_LABELS[val].en) : 'ë¯¸ì„ íƒ';
    const opacity = val ? '1' : '0.5';
    html += `<span class="flavor-badge" style="background:${attrMeta.color};color:#fff;opacity:${opacity};">${attrLabel}: ${valLabel}</span>`;
  });
  html += `</div>`;

  if (sampleData.bodyDescriptors && sampleData.bodyDescriptors.length > 0) {
    html += `<div class="mt-2 mb-1"><span class="font-bold">ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°:</span><div class="flex flex-wrap gap-1 mt-1">`;
    sampleData.bodyDescriptors.forEach(descriptorId => {
      const descriptor = BODY_DESCRIPTORS.find(d => d.id === descriptorId);
      if (descriptor) {
        const displayText = currentLanguage === 'ko' ? descriptor.korean : descriptor.label;
        const textColor = getContrastColor(descriptor.color);
        html += `<span class="flavor-badge" style="background:${descriptor.color};color:${textColor};">${displayText}</span>`;
      }
    });
    html += `</div></div>`;
  }
  return html;
}

// ë ˆì´ë” ì°¨íŠ¸ ì—…ë°ì´íŠ¸
function updateRadar(data) {
  const ctx = document.getElementById('cuppingRadar');
  if (!ctx) return;
  
  if (flavorProfileChart) {
    flavorProfileChart.destroy();
    flavorProfileChart = null;
  }
  
  let sampleData = data || getCurrentSampleObj()?.sampleData;
  if (!sampleData) return;

  const chartData = {
    labels: ['í”„ë˜ê·¸ëŸ°ìŠ¤', 'ì•„ë¡œë§ˆ', 'í”Œë ˆì´ë²„', 'ì—í”„í„°í…Œì´ìŠ¤íŠ¸', 'ì•¡ì‹œë””í‹°', 'ë°”ë””', 'ë°¸ëŸ°ìŠ¤', 'ì˜¤ë²„ëŸ´'],
    datasets: [{
      label: 'ì ìˆ˜',
      data: [
        sampleData.scoreFragrance || 0,
        sampleData.scoreAroma || 0,
        sampleData.scoreFlavor || 0,
        sampleData.scoreAftertaste || 0,
        sampleData.scoreAcidity || 0,
        sampleData.scoreBody || 0,
        sampleData.scoreBalance || 0,
        sampleData.scoreOverall || 0
      ],
      backgroundColor: 'rgba(139, 90, 43, 0.2)',
      borderColor: 'rgba(139, 90, 43, 0.8)',
      borderWidth: 2,
      pointBackgroundColor: 'rgba(139, 90, 43, 1)',
      pointRadius: 4
    }]
  };

  const options = {
    scales: {
      r: {
        angleLines: {
          display: true
        },
        min: 0,
        max: 10,
        ticks: {
          stepSize: 2,
          backdropColor: 'rgba(255, 255, 255, 0)'
        }
      }
    },
    plugins: {
      legend: {
        display: false
      },
      tooltip: {
        callbacks: {
          label: function(context) {
            return `ì ìˆ˜: ${context.raw}`;
          }
        }
      }
    }
  };

  flavorProfileChart = new Chart(ctx, {
    type: 'radar',
    data: chartData,
    options: options
  });
  
  chartObjects['cuppingRadar'] = flavorProfileChart;
}

// ì´ì  ê³„ì‚°
function updateTotalScore(data) {
  let sampleData = data;
  
  if (!data) {
    const currentSample = getCurrentSampleObj();
    if (!currentSample) return;
    sampleData = currentSample.sampleData;
  }
  
  const scoreFields = [
    'scoreFragrance', 'scoreAroma', 'scoreFlavor', 'scoreAftertaste', 
    'scoreAcidity', 'scoreBody', 'scoreBalance', 'scoreOverall'
  ];
  
  let total = 30;
  scoreFields.forEach(field => {
    total += parseFloat(sampleData[field] || 0);
  });
  
  let totalScoreEl = document.getElementById('totalScore');
  if (totalScoreEl) {
    totalScoreEl.textContent = total.toFixed(2);
  }
  
  document.getElementById('evalDate').textContent = new Date().toLocaleDateString();
}

// ìë™ ì €ì¥
function scheduleAutoSave() {
  if (sampleSaveTimeout) {
    clearTimeout(sampleSaveTimeout);
  }
  
  sampleSaveTimeout = setTimeout(() => {
    try {
      saveCurrentSample();
      
      const saveState = document.getElementById('sampleSavedState');
      if (saveState) {
        saveState.classList.remove("hidden");
        setTimeout(() => saveState.classList.add("hidden"), 1500);
      }
    } catch(e) {
      console.error("ìë™ ì €ì¥ ì¤‘ ì˜¤ë¥˜:", e);
      showToast("ìë™ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
  }, 2000);
}

// í˜„ì¬ ìƒ˜í”Œ ê°€ì ¸ì˜¤ê¸°
function getCurrentSampleObj() { 
  const sample = samples.find(s => s.id === currentSampleId);
  return sample || null;
}

// UIì—ì„œ ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ
function setUIFromSample(sampleData) {
  document.getElementById('sampleTitleInput').value = sampleData.title || '';
  document.getElementById('coffeeName').value = sampleData.coffeeName || '';
  document.getElementById('origin').value = sampleData.origin || '';
  document.getElementById('variety').value = sampleData.variety || '';
  document.getElementById('process').value = sampleData.process || '';
  document.getElementById('roastDate').value = sampleData.roastDate || '';
  document.getElementById('roastLevel').value = sampleData.roastLevel || '';
  
  // ë¼ë””ì˜¤ ë²„íŠ¼ ìƒíƒœ ì„¤ì •
  ["acidity", "sweetness", "body"].forEach(group => {
    let v = sampleData[group + "Level"] || "";
    let groupRadio = 'input[name="' + group + 'Level"]';
    if (v) {
      let radio = document.querySelector(groupRadio + '[value="' + v + '"]');
      if (radio) radio.checked = true;
    } else {
      let radios = document.querySelectorAll(groupRadio); 
      radios.forEach(r => r.checked = false);
    }
  });
  
  // ë””í™íŠ¸ ë¼ë””ì˜¤ ë²„íŠ¼ ì„¤ì •
  DEFECT_PROPS.forEach(d => {
    const val = sampleData[d.key] || "none";
    let radioNode = document.querySelector('input[name="' + d.key + '"][value="' + val + '"]');
    if (radioNode) radioNode.checked = true;
  });
  
  // SCA ì ìˆ˜ ì„¤ì •
  [
    ["scoreFragrance", "scoreFragrance"], ["scoreAroma", "scoreAroma"], 
    ["scoreFlavor", "scoreFlavor"], ["scoreAftertaste", "scoreAftertaste"],
    ["scoreAcidity", "scoreAcidity"], ["scoreBody", "scoreBody"], 
    ["scoreBalance", "scoreBalance"], ["scoreOverall", "scoreOverall"]
  ].forEach(([key, id]) => {
    document.getElementById(id).value = sampleData[key] || 7;
    document.getElementById(id + "_slider").value = sampleData[key] || 7;
  });
  
  document.getElementById('tastingNotes').value = sampleData.tastingNotes || '';
  
  // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ë Œë”ë§
  renderBodyDescriptors();
  
  renderSelectedFlavorsArea(sampleData);
  updateRadar(sampleData);
  updateTotalScore(sampleData);
  renderFlavorTabs();
  renderFlavorPhase();
}

// UIì—ì„œ ìƒ˜í”Œ ë°ì´í„° ì €ì¥
function saveUIToSample(targetDataObj) {
  let sampleData = targetDataObj || getCurrentSampleObj().sampleData;
  if (!sampleData) return;
  
  sampleData.title = document.getElementById('sampleTitleInput').value || "";
  sampleData.coffeeName = document.getElementById('coffeeName').value;
  sampleData.origin = document.getElementById('origin').value;
  sampleData.variety = document.getElementById('variety').value;
  sampleData.process = document.getElementById('process').value;
  sampleData.roastDate = document.getElementById('roastDate').value;
  sampleData.roastLevel = document.getElementById('roastLevel').value;
  sampleData.acidityLevel = getCheckedRadio('acidityLevel');
  sampleData.sweetnessLevel = getCheckedRadio('sweetnessLevel');
  sampleData.bodyLevel = getCheckedRadio('bodyLevel');
  
  DEFECT_PROPS.forEach(d => {
    sampleData[d.key] = getCheckedRadio(d.key) || "none";
  });
  
  sampleData.scoreFragrance = parseFloat(document.getElementById('scoreFragrance').value) || 0;
  sampleData.scoreAroma = parseFloat(document.getElementById('scoreAroma').value) || 0;
  sampleData.scoreFlavor = parseFloat(document.getElementById('scoreFlavor').value) || 0;
  sampleData.scoreAftertaste = parseFloat(document.getElementById('scoreAftertaste').value) || 0;
  sampleData.scoreAcidity = parseFloat(document.getElementById('scoreAcidity').value) || 0;
  sampleData.scoreBody = parseFloat(document.getElementById('scoreBody').value) || 0;
  sampleData.scoreBalance = parseFloat(document.getElementById('scoreBalance').value) || 0;
  sampleData.scoreOverall = parseFloat(document.getElementById('scoreOverall').value) || 0;
  sampleData.tastingNotes = document.getElementById('tastingNotes').value;
  sampleData.lastEdit = +(new Date());
}

// ìƒ˜í”Œ ëª©ë¡ ë Œë”ë§ (ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì›) - ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ê°œì„ 
function renderSampleList() {
  let listDiv = document.getElementById('sampleList');
  if (!samples.length) {
    listDiv.innerHTML = `<div class="text-gray-500 text-xs my-3 text-center">ìƒ˜í”Œ ì—†ìŒ<br>ìƒˆë¡œ ì¶”ê°€í•˜ì„¸ìš”.</div>`;
    updateNavigationButtons();
    updateCurrentSampleIndicator();
    return;
  }
  
  let html = '';
  samples.forEach(sm => {
    html += `
      <div class="flex justify-between items-center border rounded-lg px-2 py-1 mb-1 sample-item ${sm.id === currentSampleId ? "bg-yellow-100 border-yellow-700" : "bg-white border-gray-200"}" data-id="${sm.id}">
        <div class="sample-drag-handle"><i class="fas fa-grip-lines"></i></div>
        <span class="truncate text-sm flex-1 ${sm.id === currentSampleId ? "font-bold" : ""}">${sm.title || "ìƒ˜í”Œ"}</span>
        <span class="text-xs ml-2 text-gray-400">${sm.sampleData && sm.sampleData.roastDate ? sm.sampleData.roastDate : ""}</span>
      </div>
    `;
  });
  
  listDiv.innerHTML = html;
  
  // ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ë„ë¡ í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™”
  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  
  // ìƒ˜í”Œ í´ë¦­ ì´ë²¤íŠ¸
  Array.from(listDiv.querySelectorAll('.sample-item')).forEach(el => {
    el.addEventListener('click', (e) => {
      if (!e.target.closest('.sample-drag-handle')) {
        let id = el.getAttribute('data-id');
        if (id !== currentSampleId) {
          loadSample(id);
          const sample = samples.find(s => s.id === id);
          if (sample) {
            showSampleToast(sample.title || "ìƒ˜í”Œ");
          }
        }
      }
    });
    
    // ëª¨ë°”ì¼ ê¸¸ê²Œ ëˆ„ë¥´ê¸°ë¡œ ë³µì œ (ë“œë˜ê·¸ì™€ êµ¬ë¶„)
    if (isMobile) {
      let longPressTimer;
      let isDragging = false;
      
      el.addEventListener('touchstart', function(e) {
        if (e.target.closest('.sample-drag-handle')) {
          isDragging = true;
          return;
        }
        
        isDragging = false;
        longPressTimer = setTimeout(() => {
          if (!isDragging) {
            const sampleId = el.getAttribute('data-id');
            if (confirm("ì´ ìƒ˜í”Œì„ ë³µì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
              cloneSample(sampleId);
            }
          }
        }, 800);
      });
      
      el.addEventListener('touchmove', function(e) {
        if (!e.target.closest('.sample-drag-handle')) {
          clearTimeout(longPressTimer);
          isDragging = true;
        }
      });
      
      el.addEventListener('touchend', function(e) {
        clearTimeout(longPressTimer);
        isDragging = false;
      });
      
      el.addEventListener('touchcancel', function(e) {
        clearTimeout(longPressTimer);
        isDragging = false;
      });
    }
  });
  
  // Sortable.js ì´ˆê¸°í™” (ëª¨ë°”ì¼ ìµœì í™”)
  if (sortableInstance) {
    sortableInstance.destroy();
  }
  
  if (samples.length > 1) {
    sortableInstance = new Sortable(listDiv, {
      animation: 150,
      handle: '.sample-drag-handle',
      ghostClass: 'sortable-ghost',
      chosenClass: 'sortable-chosen',
      // ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ê³¼ ë“œë˜ê·¸ êµ¬ë¶„
      scroll: true,
      scrollSensitivity: 30,
      scrollSpeed: 10,
      // í„°ì¹˜ ì§€ì—° ì¶”ê°€ (ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ê³¼ ë“œë˜ê·¸ êµ¬ë¶„)
      delay: isMobile ? 100 : 0,
      delayOnTouchOnly: true,
      onEnd: function (evt) {
        const oldIndex = evt.oldIndex;
        const newIndex = evt.newIndex;
        
        if (oldIndex !== newIndex) {
          const item = samples[oldIndex];
          samples.splice(oldIndex, 1);
          samples.splice(newIndex, 0, item);
          saveSamplesToStorage();
          updateNavigationButtons();
          updateCurrentSampleIndicator();
        }
      }
    });
  }
  
  updateNavigationButtons();
  updateCurrentSampleIndicator();
  renderCompareList();
}

// ë¹„êµ ëª©ë¡ ë Œë”ë§
function renderCompareList() {
  const compareListBox = document.getElementById('compareListBox');
  if (!compareListBox) return;
  
  if (samples.length < 2) {
    compareListBox.innerHTML = `<div class="text-xs text-gray-400 my-2">ë¹„êµë¥¼ ìœ„í•´ ìƒ˜í”Œì„ 2ê°œ ì´ìƒ ì¶”ê°€í•˜ì„¸ìš”.</div>`;
    return;
  }
  
  let html = `<div class="text-xs mb-2 text-gray-500">ë¹„êµí•  ìƒ˜í”Œ ì„ íƒ:</div>`;
  
  html += `<div class="flex flex-wrap gap-2 mb-3">`;
  samples.forEach(sm => {
    html += `
      <label class="flex items-center bg-gray-100 hover:bg-gray-200 rounded px-3 py-1 text-sm mobile-touch-friendly">
        <input type="checkbox" class="compare-checkbox mr-1.5" value="${sm.id}">
        ${sm.title || "ìƒ˜í”Œ"}
      </label>
    `;
  });
  html += `</div>`;
  
  compareListBox.innerHTML = html;
}

// í˜„ì¬ ìƒ˜í”Œ ì €ì¥
function saveCurrentSample(applyInput=true) {
  let sampleIdx = samples.findIndex(s => s.id === currentSampleId);
  if (sampleIdx === -1) return false;
  
  if (applyInput) {
    saveUIToSample(samples[sampleIdx].sampleData);
  }
  let titleVal = document.getElementById('sampleTitleInput').value.trim();
  samples[sampleIdx].title = titleVal || "ìƒ˜í”Œ";
  samples[sampleIdx].sampleData.title = samples[sampleIdx].title;
  samples[sampleIdx].lastEdit = +(new Date());
  renderSampleList();
  saveSamplesToStorage();
  return true;
}

// ìƒ˜í”Œ ë¡œë“œ
function loadSample(sampleId) {
  if (currentSampleId) {
    saveCurrentSample();
  }
  
  let sampleObj = samples.find(s => s.id === sampleId);
  if (sampleObj) {
    currentSampleId = sampleId;
    setUIFromSample(sampleObj.sampleData);
    renderSampleList();
  }
}

// ìŠ¤í† ë¦¬ì§€ì—ì„œ ìƒ˜í”Œ ë¡œë“œ
function loadSamplesFromStorage() {
  try {
    let raw = localStorage.getItem("mollis_sca_samples2");
    if (raw) { 
      samples = JSON.parse(raw); 
      if (!Array.isArray(samples)) {
        samples = [];
      }
    }
  } catch(e) {
    console.error("ì €ì¥ëœ ìƒ˜í”Œ ë¡œë”© ì¤‘ ì˜¤ë¥˜:", e);
    samples = [];
  }
  
  if (samples.length === 0) {
    let defaultSample = createNewSampleObj("ìƒ˜í”Œ #1");
    samples.push(defaultSample);
    currentSampleId = defaultSample.id;
    saveSamplesToStorage();
  }
  
  if (!currentSampleId || !samples.find(s => s.id === currentSampleId)) { 
    currentSampleId = samples[0].id; 
  }
  
  renderSampleList();
}

// ìŠ¤í† ë¦¬ì§€ì— ìƒ˜í”Œ ì €ì¥
function saveSamplesToStorage() {
  try {
    localStorage.setItem("mollis_sca_samples2", JSON.stringify(samples));
    const saveState = document.getElementById('sampleSavedState');
    if (saveState) {
      saveState.classList.remove("hidden");
      setTimeout(() => saveState.classList.add("hidden"), 900);
    }
  } catch(e) {
    console.error("ìƒ˜í”Œ ì €ì¥ ì¤‘ ì˜¤ë¥˜:", e);
    showToast("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¥¼ ë°±ì—…í•´ ì£¼ì„¸ìš”.");
  }
}

// ìƒ˜í”Œ ë³µì œ
function cloneSample(sampleId) {
  const originalSample = samples.find(s => s.id === sampleId);
  if (!originalSample) return;
  
  const clonedData = JSON.parse(JSON.stringify(originalSample.sampleData));
  const newId = "sample_" + Date.now() + "_" + Math.floor(Math.random() * 10000);
  const clonedSample = {
    id: newId,
    title: originalSample.title + " (ë³µì‚¬ë³¸)",
    sampleData: clonedData,
    lastEdit: +(new Date())
  };
  
  samples.unshift(clonedSample);
  currentSampleId = newId;
  renderSampleList();
  setUIFromSample(clonedSample.sampleData);
  saveSamplesToStorage();
  showToast("ìƒ˜í”Œì„ ë³µì œí–ˆìŠµë‹ˆë‹¤.");
}

// ìŠ¤ì™€ì´í”„ë¡œ ì´ì „/ë‹¤ìŒ ìƒ˜í”Œ ì´ë™ (ëª¨ë°”ì¼ ìµœì í™”)
function setupSwipeNavigation() {
  try {
    const form = document.getElementById('cuppingForm');
    if (!form || typeof Hammer === 'undefined') return;
    
    const hammer = new Hammer(form);
    hammer.get('swipe').set({ direction: Hammer.DIRECTION_HORIZONTAL });
    
    hammer.on('swipeleft', function(e) {
      goToNextSample();
    });
    
    hammer.on('swiperight', function(e) {
      goToPrevSample();
    });
    
    console.log("ìŠ¤ì™€ì´í”„ ë‚´ë¹„ê²Œì´ì…˜ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
  } catch (e) {
    console.error("ìŠ¤ì™€ì´í”„ ë‚´ë¹„ê²Œì´ì…˜ ì„¤ì • ì¤‘ ì˜¤ë¥˜:", e);
  }
}

/* === 4ë‹¨ê³„: ê³ ê¸‰ ê¸°ëŠ¥ ë° ë§ˆë¬´ë¦¬ === */

// ìë™ ë°±ì—… ê¸°ëŠ¥
function setupAutoBackup() {
  const lastBackup = localStorage.getItem('mollis_sca_last_backup');
  const now = Date.now();
  
  if (!lastBackup || (now - parseInt(lastBackup)) > 86400000) {
    try {
      const backupData = JSON.stringify(samples);
      const backupKey = `mollis_sca_backup_${new Date().toISOString().slice(0, 10)}`;
      
      localStorage.setItem(backupKey, backupData);
      localStorage.setItem('mollis_sca_last_backup', now.toString());
      
      const keys = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.startsWith('mollis_sca_backup_')) {
          keys.push(key);
        }
      }
      
      if (keys.length > 7) {
        keys.sort();
        while (keys.length > 7) {
          localStorage.removeItem(keys.shift());
        }
      }
      
      console.log('ìë™ ë°±ì—… ì™„ë£Œ:', backupKey);
    } catch (e) {
      console.error('ìë™ ë°±ì—… ì¤‘ ì˜¤ë¥˜:', e);
    }
  }
}

// ë°±ì—… ëª©ë¡ í‘œì‹œ ë° ë³µì›
function showBackupList() {
  const backups = [];
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key && key.startsWith('mollis_sca_backup_')) {
      const date = key.replace('mollis_sca_backup_', '');
      backups.push({ key, date });
    }
  }
  
  if (backups.length === 0) {
    showToast("ì €ì¥ëœ ë°±ì—…ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }
  
  backups.sort((a, b) => b.date.localeCompare(a.date));
  
  let message = "ë°±ì—… ëª©ë¡: (ìµœê·¼ ë‚ ì§œìˆœ)\n\n";
  backups.forEach((backup, i) => {
    message += `${i + 1}. ${backup.date}\n`;
  });
  
  message += "\në³µì›í•  ë°±ì—… ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì·¨ì†ŒëŠ” 0):";
  
  const choice = prompt(message, "");
  if (!choice) return;
  
  const num = parseInt(choice, 10);
  if (isNaN(num) || num === 0) return;
  
  if (num > 0 && num <= backups.length) {
    const selectedBackup = backups[num - 1];
    
    if (confirm(`${selectedBackup.date} ë°±ì—…ì„ ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ë°ì´í„°ëŠ” ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤.`)) {
      try {
        const backupData = localStorage.getItem(selectedBackup.key);
        const parsedData = JSON.parse(backupData);
        
        if (Array.isArray(parsedData) && parsedData.length > 0) {
          samples = parsedData;
          currentSampleId = samples[0].id;
          setUIFromSample(samples[0].sampleData);
          renderSampleList();
          saveSamplesToStorage();
          showToast(`${selectedBackup.date} ë°±ì—…ì„ ì„±ê³µì ìœ¼ë¡œ ë³µì›í–ˆìŠµë‹ˆë‹¤.`);
        } else {
          showToast("ë°±ì—… ë°ì´í„° í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
      } catch (e) {
        console.error("ë°±ì—… ë³µì› ì¤‘ ì˜¤ë¥˜:", e);
        showToast("ë°±ì—… ë³µì› ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      }
    }
  } else {
    showToast("ì˜¬ë°”ë¥¸ ë°±ì—… ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
  }
}

// ì°¨íŠ¸ ë©”ëª¨ë¦¬ ì •ë¦¬
function cleanupCharts() {
  Object.keys(chartObjects).forEach(key => {
    const chart = chartObjects[key];
    if (chart) {
      try {
        chart.destroy();
        chartObjects[key] = null;
      } catch (e) {
        console.warn(`ì°¨íŠ¸(${key}) ì •ë¦¬ ì¤‘ ì˜¤ë¥˜:`, e);
      }
    }
  });
}

// ë¹„êµ ì°¨íŠ¸ ìƒì„±
function createComparisonChart(selectedSamples) {
  const compareArea = document.getElementById('compareArea');
  if (!compareArea) return;
  
  if (chartObjects.comparisonRadar) {
    chartObjects.comparisonRadar.destroy();
    chartObjects.comparisonRadar = null;
  }
  
  let html = `
    <div class="bg-white rounded-lg p-4 shadow-md mt-4">
      <h4 class="font-semibold mb-4">SCA ì ìˆ˜ ë¹„êµ ì°¨íŠ¸</h4>
      <div class="chart-container">
        <canvas id="comparisonRadar"></canvas>
      </div>
    </div>
    
    <div class="bg-white rounded-lg p-4 shadow-md mt-4">
      <h4 class="font-semibold mb-4">ì ìˆ˜ ë¹„êµ í…Œì´ë¸”</h4>
      <div class="overflow-x-auto">
        <table class="compare-table w-full">
          <thead>
            <tr>
              <th>í•­ëª©</th>
  `;
  
  selectedSamples.forEach(sample => {
    html += `<th>${sample.title || 'ìƒ˜í”Œ'}</th>`;
  });
  
  html += `</tr></thead><tbody>`;
  
  const scoreFields = [
    { key: 'scoreFragrance', label: 'í”„ë˜ê·¸ëŸ°ìŠ¤' },
    { key: 'scoreAroma', label: 'ì•„ë¡œë§ˆ' },
    { key: 'scoreFlavor', label: 'í”Œë ˆì´ë²„' },
    { key: 'scoreAftertaste', label: 'ì—í”„í„°í…Œì´ìŠ¤íŠ¸' },
    { key: 'scoreAcidity', label: 'ì•¡ì‹œë””í‹°' },
    { key: 'scoreBody', label: 'ë°”ë””' },
    { key: 'scoreBalance', label: 'ë°¸ëŸ°ìŠ¤' },
    { key: 'scoreOverall', label: 'ì˜¤ë²„ëŸ´' }
  ];
  
  scoreFields.forEach(field => {
    html += `<tr><td>${field.label}</td>`;
    selectedSamples.forEach(sample => {
      html += `<td>${parseFloat(sample.sampleData[field.key] || 0).toFixed(2)}</td>`;
    });
    html += `</tr>`;
  });
  
  html += `<tr class="font-bold"><td>ì´ì  (30+í•©ê³„)</td>`;
  selectedSamples.forEach(sample => {
    let total = 30;
    scoreFields.forEach(field => {
      total += parseFloat(sample.sampleData[field.key] || 0);
    });
    html += `<td>${total.toFixed(2)}</td>`;
  });
  html += `</tr>`;

  html += `</tbody></table></div></div>`;

  html += `<div class="bg-white rounded-lg p-4 shadow-md mt-4">`;
  html += `<h4 class="font-semibold mb-4">ì„ íƒí•œ í–¥ë¯¸</h4>`;
  html += `<div class="grid md:grid-cols-${selectedSamples.length} gap-4">`;
  selectedSamples.forEach(sample => {
    html += `<div>${getFlavorSummaryHtml(sample.sampleData)}</div>`;
  });
  html += `</div></div>`;

  compareArea.innerHTML = html;
  
  // ì°¨íŠ¸ ìƒì„±
  const ctx = document.getElementById('comparisonRadar');
  if (!ctx) return;
  
  const chartData = {
    labels: ['í”„ë˜ê·¸ëŸ°ìŠ¤', 'ì•„ë¡œë§ˆ', 'í”Œë ˆì´ë²„', 'ì—í”„í„°í…Œì´ìŠ¤íŠ¸', 'ì•¡ì‹œë””í‹°', 'ë°”ë””', 'ë°¸ëŸ°ìŠ¤', 'ì˜¤ë²„ëŸ´'],
    datasets: []
  };
  
  const colors = [
    { bg: 'rgba(139, 90, 43, 0.2)', border: 'rgba(139, 90, 43, 0.8)' },
    { bg: 'rgba(54, 162, 235, 0.2)', border: 'rgba(54, 162, 235, 0.8)' },
    { bg: 'rgba(255, 99, 132, 0.2)', border: 'rgba(255, 99, 132, 0.8)' },
    { bg: 'rgba(75, 192, 192, 0.2)', border: 'rgba(75, 192, 192, 0.8)' },
    { bg: 'rgba(153, 102, 255, 0.2)', border: 'rgba(153, 102, 255, 0.8)' },
    { bg: 'rgba(255, 159, 64, 0.2)', border: 'rgba(255, 159, 64, 0.8)' }
  ];
  
  selectedSamples.forEach((sample, index) => {
    const color = colors[index % colors.length];
    
    chartData.datasets.push({
      label: sample.title || 'ìƒ˜í”Œ',
      data: [
        parseFloat(sample.sampleData.scoreFragrance || 0),
        parseFloat(sample.sampleData.scoreAroma || 0),
        parseFloat(sample.sampleData.scoreFlavor || 0),
        parseFloat(sample.sampleData.scoreAftertaste || 0),
        parseFloat(sample.sampleData.scoreAcidity || 0),
        parseFloat(sample.sampleData.scoreBody || 0),
        parseFloat(sample.sampleData.scoreBalance || 0),
        parseFloat(sample.sampleData.scoreOverall || 0)
      ],
      backgroundColor: color.bg,
      borderColor: color.border,
      borderWidth: 2,
      pointRadius: 4
    });
  });
  
  const options = {
    scales: {
      r: {
        angleLines: { display: true },
        min: 0,
        max: 10,
        ticks: {
          stepSize: 2,
          backdropColor: 'rgba(255, 255, 255, 0)'
        }
      }
    }
  };
  
  chartObjects.comparisonRadar = new Chart(ctx, {
    type: 'radar',
    data: chartData,
    options: options
  });
  
  compareArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// ê³ ê¸‰ ë¹„êµ í…Œì´ë¸” ìƒì„±
function createAdvancedComparisonTable(selectedSamples) {
  const compareArea = document.getElementById('compareArea');
  if (!compareArea) return;
  
  let html = `
    <div class="bg-white rounded-lg p-4 shadow-md mt-4">
      <h4 class="font-semibold mb-4">ê³ ê¸‰ ë¶„ì„ ë¹„êµ</h4>
      <div class="overflow-x-auto">
        <table class="advanced-compare-table w-full">
          <thead>
            <tr>
              <th>êµ¬ë¶„</th>
              <th>í•­ëª©</th>
  `;
  
  selectedSamples.forEach(sample => {
    html += `<th>${sample.title || 'ìƒ˜í”Œ'}</th>`;
  });
  
  html += `</tr></thead><tbody>`;
  
  // ê¸°ë³¸ ì •ë³´ ì„¹ì…˜
  html += `<tr class="category-row"><td colspan="${2 + selectedSamples.length}">ê¸°ë³¸ ì •ë³´</td></tr>`;
  
  const basicFields = [
    { key: 'coffeeName', label: 'ì»¤í”¼ëª…' },
    { key: 'origin', label: 'ì›ì‚°ì§€' },
    { key: 'variety', label: 'í’ˆì¢…' },
    { key: 'process', label: 'ê°€ê³µë°©ì‹' },
    { key: 'roastDate', label: 'ë¡œìŠ¤íŒ… ë‚ ì§œ' },
    { key: 'roastLevel', label: 'ë¡œìŠ¤íŒ… ë ˆë²¨' }
  ];
  
  basicFields.forEach(field => {
    html += `<tr><td>ê¸°ë³¸ì •ë³´</td><td>${field.label}</td>`;
    selectedSamples.forEach(sample => {
      html += `<td>${sample.sampleData[field.key] || '-'}</td>`;
    });
    html += `</tr>`;
  });
  
  // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ì„¹ì…˜ ì¶”ê°€
  html += `<tr class="category-row"><td colspan="${2 + selectedSamples.length}">ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°</td></tr>`;
  html += `<tr><td>ë°”ë””ê°</td><td>ì„ íƒëœ ë””ìŠ¤í¬ë¦½í„°</td>`;
  selectedSamples.forEach(sample => {
    const descriptors = sample.sampleData.bodyDescriptors || [];
    if (descriptors.length > 0) {
      const descriptorTexts = descriptors.map(id => {
        const descriptor = BODY_DESCRIPTORS.find(d => d.id === id);
        return descriptor ? (currentLanguage === 'ko' ? descriptor.korean : descriptor.label) : '';
      }).filter(text => text);
      html += `<td>${descriptorTexts.join(', ')}</td>`;
    } else {
      html += `<td><span class="text-xs text-gray-400">ì—†ìŒ</span></td>`;
    }
  });
  html += `</tr>`;

  // í–¥ë¯¸ ì„ íƒ ì„¹ì…˜
  html += `<tr class="category-row"><td colspan="${2 + selectedSamples.length}">í–¥ë¯¸</td></tr>`;
  FLAVOR_PHASES.forEach(phase => {
    html += `<tr><td>í–¥ë¯¸</td><td>${currentLanguage === 'ko' ? phase.label : phase.labelEn}</td>`;
    selectedSamples.forEach(sample => {
      const phaseSel = (sample.sampleData.flavorSelections[phase.id] || []).map(key => {
        const [cat, sub, desc] = key.split('|');
        const rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
        return rec ? (currentLanguage === 'ko' && rec.length > 6 ? rec[6] : desc) : '';
      }).filter(t => t).join(', ');
      html += `<td>${phaseSel || '-'}</td>`;
    });
    html += `</tr>`;
  });
  
  html += `</tbody></table></div></div>`;
  
  compareArea.innerHTML = html;
  compareArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// ë¶„í•  í™”ë©´ ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì—…ë°ì´íŠ¸
function updateSplitViewSelects() {
  const leftSelect = document.getElementById('leftSampleSelect');
  const rightSelect = document.getElementById('rightSampleSelect');
  
  if (!leftSelect || !rightSelect) return;
  
  leftSelect.innerHTML = '';
  rightSelect.innerHTML = '';
  
  leftSelect.add(new Option('ì„ íƒí•˜ì„¸ìš”', ''));
  rightSelect.add(new Option('ì„ íƒí•˜ì„¸ìš”', ''));
  
  samples.forEach(sample => {
    leftSelect.add(new Option(sample.title || 'ìƒ˜í”Œ', sample.id));
    rightSelect.add(new Option(sample.title || 'ìƒ˜í”Œ', sample.id));
  });
  
  if (samples.length >= 2) {
    leftSelect.value = samples[0].id;
    rightSelect.value = samples[1].id;
    updateSplitView();
  }
}

// ë¶„í•  í™”ë©´ ì—…ë°ì´íŠ¸
function updateSplitView() {
  const leftSelect = document.getElementById('leftSampleSelect');
  const rightSelect = document.getElementById('rightSampleSelect');
  const leftView = document.getElementById('leftSampleView');
  const rightView = document.getElementById('rightSampleView');
  
  if (!leftSelect || !rightSelect || !leftView || !rightView) return;
  
  const leftSample = samples.find(s => s.id === leftSelect.value);
  const rightSample = samples.find(s => s.id === rightSelect.value);
  
  if (leftSample) {
    leftView.innerHTML = createSampleSummary(leftSample);
  } else {
    leftView.innerHTML = '<div class="text-center text-gray-500">ì™¼ìª½ ìƒ˜í”Œì„ ì„ íƒí•˜ì„¸ìš”</div>';
  }
  
  if (rightSample) {
    rightView.innerHTML = createSampleSummary(rightSample);
  } else {
    rightView.innerHTML = '<div class="text-center text-gray-500">ì˜¤ë¥¸ìª½ ìƒ˜í”Œì„ ì„ íƒí•˜ì„¸ìš”</div>';
  }
}

// ìƒ˜í”Œ ìš”ì•½ HTML ìƒì„±
function createSampleSummary(sample) {
  if (!sample) return '';
  
  const sampleData = sample.sampleData;
  let html = `
    <h3 class="font-bold text-lg mb-3">${sample.title || 'ìƒ˜í”Œ'}</h3>
    <div class="mb-3">
      <div><span class="font-semibold">ì»¤í”¼ëª…:</span> ${sampleData.coffeeName || '-'}</div>
      <div><span class="font-semibold">ì›ì‚°ì§€:</span> ${sampleData.origin || '-'}</div>
      <div><span class="font-semibold">í’ˆì¢…:</span> ${sampleData.variety || '-'}</div>
      <div><span class="font-semibold">ê°€ê³µë²•:</span> ${sampleData.process || '-'}</div>
      <div><span class="font-semibold">ë¡œìŠ¤íŒ… ë‚ ì§œ:</span> ${sampleData.roastDate || '-'}</div>
    </div>
    
    <h4 class="font-bold mt-4 mb-2">SCA ì ìˆ˜</h4>
    <div class="grid grid-cols-2 gap-2">
      <div><span class="font-semibold">í”„ë˜ê·¸ëŸ°ìŠ¤:</span> ${parseFloat(sampleData.scoreFragrance || 0).toFixed(2)}</div>
      <div><span class="font-semibold">ì•„ë¡œë§ˆ:</span> ${parseFloat(sampleData.scoreAroma || 0).toFixed(2)}</div>
      <div><span class="font-semibold">í”Œë ˆì´ë²„:</span> ${parseFloat(sampleData.scoreFlavor || 0).toFixed(2)}</div>
      <div><span class="font-semibold">ì—í”„í„°í…Œì´ìŠ¤íŠ¸:</span> ${parseFloat(sampleData.scoreAftertaste || 0).toFixed(2)}</div>
      <div><span class="font-semibold">ì•¡ì‹œë””í‹°:</span> ${parseFloat(sampleData.scoreAcidity || 0).toFixed(2)}</div>
      <div><span class="font-semibold">ë°”ë””:</span> ${parseFloat(sampleData.scoreBody || 0).toFixed(2)}</div>
      <div><span class="font-semibold">ë°¸ëŸ°ìŠ¤:</span> ${parseFloat(sampleData.scoreBalance || 0).toFixed(2)}</div>
      <div><span class="font-semibold">ì˜¤ë²„ëŸ´:</span> ${parseFloat(sampleData.scoreOverall || 0).toFixed(2)}</div>
    </div>
    
    <div class="mt-2">
      <span class="font-bold">ì´ì : </span>
      ${(30 + parseFloat(sampleData.scoreFragrance || 0) + 
          parseFloat(sampleData.scoreAroma || 0) + 
          parseFloat(sampleData.scoreFlavor || 0) + 
          parseFloat(sampleData.scoreAftertaste || 0) + 
          parseFloat(sampleData.scoreAcidity || 0) + 
          parseFloat(sampleData.scoreBody || 0) + 
          parseFloat(sampleData.scoreBalance || 0) + 
          parseFloat(sampleData.scoreOverall || 0)).toFixed(2)}
    </div>
  `;
  
  html += getFlavorSummaryHtml(sampleData);

  if (sampleData.tastingNotes) {
    html += `
      <h4 class="font-bold mt-4 mb-2">í…Œì´ìŠ¤íŒ… ë…¸íŠ¸</h4>
      <div class="bg-gray-50 p-3 rounded text-sm">${sampleData.tastingNotes.replace(/\n/g, '<br>')}</div>
    `;
  }
  
  return html;
}

// SNSí˜• ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸° í•¨ìˆ˜ (ìˆ˜ì •ë¨)
function exportSnsImage() {
  saveCurrentSample();
  
  const currentSample = getCurrentSampleObj();
  if (!currentSample) {
    showToast("ë‚´ë³´ë‚¼ ìƒ˜í”Œì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }
  
  const s = currentSample.sampleData;
  
  // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° HTML ìƒì„± í•¨ìˆ˜
  function generateBodyDescriptorsHtml() {
    if (!s.bodyDescriptors || s.bodyDescriptors.length === 0) {
      return '';
    }
    
    const bodyDescriptorElements = s.bodyDescriptors.map(descriptorId => {
      const descriptor = BODY_DESCRIPTORS.find(d => d.id === descriptorId);
      if (descriptor) {
        const displayText = currentLanguage === 'ko' ? descriptor.korean : descriptor.label;
        const textColor = getContrastColor(descriptor.color);
        return `<span style="display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 12px; color: ${textColor}; background: ${descriptor.color}; font-weight: 500; margin: 2px;">${displayText}</span>`;
      }
      return '';
    }).filter(html => html !== '').join('');
    
    if (bodyDescriptorElements) {
      return `
        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e5e5;">
          <div style="font-weight: 600; margin-bottom: 8px; font-size: 14px; color: #555;">ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°</div>
          <div style="display: flex; flex-wrap: wrap; gap: 4px; line-height: 1.4;">
            ${bodyDescriptorElements}
          </div>
        </div>
      `;
    }
    
    return '';
  }
  
  // SNSìš© ì„ì‹œ DOM ìš”ì†Œ ìƒì„± (ì‹¬í”Œí•œ í°ìƒ‰ ë°°ê²½)
  const tempRoot = document.createElement('div');
  tempRoot.style.cssText = `
    background: white;
    padding: 40px;
    max-width: 500px;
    font-family: 'Noto Sans KR', sans-serif;
    position: absolute;
    left: -9999px;
    top: 0;
    border-radius: 12px;
    color: #333;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    border: 2px solid #f0f0f0;
  `;
  
  // SNSìš© ê°„ê²°í•œ HTML êµ¬ì„±
  const bodyDescriptorsHtml = generateBodyDescriptorsHtml();
  
  tempRoot.innerHTML = `
  <div style="text-align: center; margin-bottom: 30px;">
    <h2 style="margin: 0; font-size: 24px; font-weight: bold; color: #8B5A2B;">${s.title || s.coffeeName || 'ì»¤í”¼ í…Œì´ìŠ¤íŒ…'}</h2>
    ${s.coffeeName && s.title !== s.coffeeName ? `<div style="font-size: 16px; color: #666; margin-top: 5px;">${s.coffeeName}</div>` : ''}
  </div>
  
  <div style="border: 1px solid #e5e5e5; border-radius: 8px; padding: 25px;">
    <h3 style="font-weight: 700; font-size: 18px; margin: 0 0 20px 0; text-align: center; color: #8B5A2B; border-bottom: 1px solid #e5e5e5; padding-bottom: 10px;">í–¥ë¯¸ í”„ë¡œí•„</h3>
    
    <div style="display: grid; gap: 15px;">
      ${FLAVOR_PHASES.map(phase => {
        const phaseLabel = currentLanguage === 'ko' ? phase.label : phase.labelEn;
        const phaseSel = (s.flavorSelections[phase.id] || []).map(key => {
          const [cat, sub, desc] = key.split('|');
          const rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
          const displayName = currentLanguage === 'ko' && rec && rec.length > 6 ? rec[6] : desc;
          const color = rec ? rec[3] : '#B8B2A5';
          const textColor = getContrastColor(color);
          return `<span style="display: inline-block; padding: 4px 10px; border-radius: 12px; margin: 2px; font-size: 12px; color: ${textColor}; background: ${color}; font-weight: 500;">${displayName}</span>`;
        }).join('');
        
        return `<div style="margin-bottom: 12px;">
          <div style="font-weight: 600; margin-bottom: 6px; font-size: 14px; color: #555;">${phaseLabel}</div>
          <div style="line-height: 1.5; min-height: 24px;">
            ${phaseSel || '<span style="color: #999; font-style: italic; font-size: 12px;">ì„ íƒëœ í–¥ë¯¸ ì—†ìŒ</span>'}
          </div>
        </div>`;
      }).join('')}
    </div>
    
    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #e5e5e5;">
      <div style="font-weight: 600; margin-bottom: 8px; font-size: 14px; color: #555;">ë§› ì†ì„±</div>
      <div style="display: flex; flex-wrap: wrap; gap: 6px;">
        ${Object.keys(ATTR_TO_BADGE).map(attrKey => {
          const attrMeta = ATTR_TO_BADGE[attrKey];
          const val = s[attrKey];
          const attrLabel = currentLanguage === 'ko' ? attrMeta.label : attrMeta.labelEn;
          const valLabel = val && ATTR_VALUE_LABELS[val] ? 
            (currentLanguage === 'ko' ? ATTR_VALUE_LABELS[val].kr : ATTR_VALUE_LABELS[val].en) : 
            (currentLanguage === 'ko' ? 'ë¯¸ì„ íƒ' : 'None');
          
          if (val) {
            return `<span style="display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 12px; color: white; background: ${attrMeta.color}; font-weight: 500;">${attrLabel}: ${valLabel}</span>`;
          } else {
            return `<span style="display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 12px; color: white; background: ${attrMeta.color}; opacity: 0.5; font-weight: 500;">${attrLabel}: ${valLabel}</span>`;
          }
        }).join('')}
      </div>
    </div>
    
    ${bodyDescriptorsHtml}
    
    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #e5e5e5; text-align: center;">
      <div style="font-size: 12px; color: #888;">
        ${new Date().toLocaleDateString()} | mollis Coffee Cupping (ê°œì„ ë²„ì „)
      </div>
    </div>
  </div>
  `;
  
  document.body.appendChild(tempRoot);

  // SNSìš© ì´ë¯¸ì§€ ìƒì„±âŠ
  document.fonts.ready.then(() => html2canvas(tempRoot, {
    backgroundColor: "white",
    scale: 2,
    logging: false,
    useCORS: true,
    width: 500,
    height: tempRoot.scrollHeight
  })).then(canvas => {
    try {
      const a = document.createElement('a');
      a.href = canvas.toDataURL("image/png");
      const fname = (s.title || s.coffeeName || 'coffee_sns') + '_sns.png';
      a.download = fname;
      document.body.appendChild(a);
      a.click();
      
      document.body.removeChild(a);
      document.body.removeChild(tempRoot);
      showToast("SNSìš© ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
      
      // ì„±ê³µ ë¡œê·¸
      console.log("SNS ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸° ì„±ê³µ:", {
        title: s.title,
        bodyDescriptors: s.bodyDescriptors ? s.bodyDescriptors.length : 0,
        flavorSelections: Object.keys(s.flavorSelections).length
      });
      
    } catch (e) {
      console.error("SNS ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜:", e);
      showToast("SNS ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      if (document.body.contains(tempRoot)) {
        document.body.removeChild(tempRoot);
      }
    }

  }).catch(e => {
    console.error("Canvas ìƒì„± ì¤‘ ì˜¤ë¥˜:", e);
    showToast("ì´ë¯¸ì§€ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    if (document.body.contains(tempRoot)) {
      document.body.removeChild(tempRoot);
    }
  });
}

// ê²°ê³¼ ì˜ì—­ ì´ë¯¸ì§€ë¡œ ì €ì¥
function exportImage() {
  saveCurrentSample();

  const currentSample = getCurrentSampleObj();
  if (!currentSample) {
    showToast("ë‚´ë³´ë‚¼ ìƒ˜í”Œì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  const container = document.getElementById('visualSection');
  if (!container) return;

  const wrapper = document.createElement('div');
  wrapper.style.position = 'absolute';
  wrapper.style.left = '-9999px';
  const title = document.createElement('h3');
  title.textContent = currentSample.title || currentSample.sampleData.coffeeName || 'Sample';
  title.style.textAlign = 'center';
  title.style.marginBottom = '10px';
  wrapper.appendChild(title);
  const clone = container.cloneNode(true);
  wrapper.appendChild(clone);
  document.body.appendChild(wrapper);

  html2canvas(wrapper, {backgroundColor: 'white', scale: 2, useCORS: true}).then(canvas => {
    try {
      const a = document.createElement('a');
      a.href = canvas.toDataURL('image/png');
      a.download = (currentSample.title || 'cupping') + '.png';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      document.body.removeChild(wrapper);
      showToast('ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    } catch (e) {
      console.error('ì´ë¯¸ì§€ ì €ì¥ ì˜¤ë¥˜:', e);
      showToast('ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      if (document.body.contains(wrapper)) document.body.removeChild(wrapper);
    }
  }).catch(e => {
    console.error('Canvas ìƒì„± ì¤‘ ì˜¤ë¥˜:', e);
    showToast('ì´ë¯¸ì§€ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    if (document.body.contains(wrapper)) document.body.removeChild(wrapper);
  });
}

// ì—‘ì…€ íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°
function exportXlsx() {
  saveCurrentSample();

  const currentSample = getCurrentSampleObj();
  if (!currentSample) {
    showToast('ë‚´ë³´ë‚¼ ìƒ˜í”Œì´ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }

  const s = currentSample.sampleData;
  const rows = [];
  rows.push(['ìƒ˜í”Œëª…', currentSample.title || '']);
  rows.push(['ì»¤í”¼ëª…', s.coffeeName || '']);
  rows.push(['ì›ì‚°ì§€', s.origin || '']);
  rows.push(['í’ˆì¢…', s.variety || '']);
  rows.push(['ê°€ê³µë°©ì‹', s.process || '']);
  rows.push(['ë¡œìŠ¤íŒ… ë‚ ì§œ', s.roastDate || '']);
  rows.push(['ë¡œìŠ¤íŒ… ë ˆë²¨', s.roastLevel || '']);

  FLAVOR_PHASES.forEach(phase => {
    const selections = (s.flavorSelections[phase.id] || []).map(key => {
      const [cat, sub, desc] = key.split('|');
      const rec = FLAVOR_DATA.find(f => f[0] === cat && f[1] === sub && f[2] === desc);
      return rec ? (currentLanguage === 'ko' && rec.length > 6 ? rec[6] : desc) : desc;
    }).join(', ');
    rows.push([currentLanguage === 'ko' ? phase.label : phase.labelEn, selections]);
  });

  const bodyDesc = (s.bodyDescriptors || []).map(id => {
    const d = BODY_DESCRIPTORS.find(b => b.id === id);
    return d ? (currentLanguage === 'ko' ? d.korean : d.label) : '';
  }).filter(v => v).join(', ');
  rows.push(['ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°', bodyDesc]);

  rows.push(['ì‚°ë¯¸', s.acidityLevel ? ATTR_VALUE_LABELS[s.acidityLevel].kr : '']);
  rows.push(['ë‹¨ë§›', s.sweetnessLevel ? ATTR_VALUE_LABELS[s.sweetnessLevel].kr : '']);
  rows.push(['ë°”ë””', s.bodyLevel ? ATTR_VALUE_LABELS[s.bodyLevel].kr : '']);

  const scoreFields = [
    { key: 'scoreFragrance', label: 'í”„ë˜ê·¸ëŸ°ìŠ¤' },
    { key: 'scoreAroma', label: 'ì•„ë¡œë§ˆ' },
    { key: 'scoreFlavor', label: 'í”Œë ˆì´ë²„' },
    { key: 'scoreAftertaste', label: 'ì—í”„í„°í…Œì´ìŠ¤íŠ¸' },
    { key: 'scoreAcidity', label: 'ì•¡ì‹œë””í‹°' },
    { key: 'scoreBody', label: 'ë°”ë””' },
    { key: 'scoreBalance', label: 'ë°¸ëŸ°ìŠ¤' },
    { key: 'scoreOverall', label: 'ì˜¤ë²„ëŸ´' }
  ];

  let total = 30;
  scoreFields.forEach(field => {
    rows.push([field.label, s[field.key] || 0]);
    total += parseFloat(s[field.key] || 0);
  });
  rows.push(['ì´ì ', total.toFixed(2)]);

  const ws = XLSX.utils.aoa_to_sheet(rows);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Cupping');
  const filename = (currentSample.title || 'cupping') + '.xlsx';
  XLSX.writeFile(wb, filename);
  showToast('ì—‘ì…€ íŒŒì¼ë¡œ ë‚´ë³´ëƒˆìŠµë‹ˆë‹¤.');
}
  
// ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ í•¨ìˆ˜
function validateSampleData(sampleData) {
  try {
    // í•„ìˆ˜ í•„ë“œ ê²€ì¦
    if (!sampleData.flavorSelections) {
      sampleData.flavorSelections = {};
      FLAVOR_PHASES.forEach(phase => sampleData.flavorSelections[phase.id] = []);
    }
    
    // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° í•„ë“œ ì¶”ê°€ (ê¸°ì¡´ ë°ì´í„° í˜¸í™˜ì„±)
    if (!sampleData.bodyDescriptors) {
      sampleData.bodyDescriptors = [];
    }
    
    // ì ìˆ˜ í•„ë“œ ê²€ì¦
    const scoreFields = ['scoreFragrance', 'scoreAroma', 'scoreFlavor', 'scoreAftertaste', 
                        'scoreAcidity', 'scoreBody', 'scoreBalance', 'scoreOverall'];
    scoreFields.forEach(field => {
      if (typeof sampleData[field] !== 'number' || isNaN(sampleData[field])) {
        sampleData[field] = 7; // ê¸°ë³¸ê°’
      }
    });
    
    // ë””í™íŠ¸ í•„ë“œ ê²€ì¦
    DEFECT_PROPS.forEach(defect => {
      if (!sampleData[defect.key] || !DEFECT_LABELS[sampleData[defect.key]]) {
        sampleData[defect.key] = "none";
      }
    });
    
    return true;
  } catch (e) {
    console.error("ìƒ˜í”Œ ë°ì´í„° ê²€ì¦ ì¤‘ ì˜¤ë¥˜:", e);
    return false;
  }
}

// ì˜¤ë¥˜ ëª¨ë‹ˆí„°ë§ ë° ìë™ ë³µêµ¬ ê¸°ëŠ¥
function setupErrorMonitoring() {
  window.addEventListener('error', function(e) {
    console.error('ì˜¤ë¥˜ ê°ì§€ë¨:', e.error);
    
    lastErrorCount++;
    
    if (lastErrorCount > 5) {
      try {
        let lastBackupKey = null;
        let lastBackupDate = '';
        
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('mollis_sca_backup_')) {
            const date = key.replace('mollis_sca_backup_', '');
            if (!lastBackupKey || date > lastBackupDate) {
              lastBackupKey = key;
              lastBackupDate = date;
            }
          }
        }
        
        if (lastBackupKey) {
          const emergency_copy = JSON.parse(JSON.stringify(samples));
          const backupData = JSON.parse(localStorage.getItem(lastBackupKey));
          
          if (Array.isArray(backupData) && backupData.length > 0) {
            localStorage.setItem('mollis_sca_emergency_backup', JSON.stringify(emergency_copy));
            showToast("ì˜¤ë¥˜ë¡œ ì¸í•´ ë§ˆì§€ë§‰ ë°±ì—… ìƒíƒœë¡œ ë³µì›í•©ë‹ˆë‹¤...");
            
            samples = backupData;
            if (samples.length > 0) {
              currentSampleId = samples[0].id;
              setUIFromSample(samples[0].sampleData);
              renderSampleList();
              saveSamplesToStorage();
            }
          }
        }
        
        lastErrorCount = 0;
      } catch (err) {
        console.error("ìë™ ë³µêµ¬ ì¤‘ ì˜¤ë¥˜:", err);
      }
    }
    
    setTimeout(() => { lastErrorCount = 0; }, 10000);
  });
}

// ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™” ì¶”ê°€ ê¸°ëŠ¥
function enhanceMobileExperience() {
  // ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ê°ì§€
  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  
  if (isMobile) {
    // ëª¨ë°”ì¼ ì „ìš© ìŠ¤íƒ€ì¼ ë™ì  ì ìš©
    const style = document.createElement('style');
    style.textContent = `
      .mobile-optimized {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }
      
      input, textarea, select {
        font-size: 16px !important; /* iOS ì¤Œ ë°©ì§€ */
      }
      
      .flavor-checkbox-label {
        min-height: 44px;
        min-width: 44px;
      }
      
      .sample-item {
        min-height: 50px;
      }
      
      .tab-btn-active, .tab-btn-inactive {
        min-height: 48px;
      }
    `;
    document.head.appendChild(style);
    
    // ëª¨ë°”ì¼ ì „ìš© í„°ì¹˜ ì´ë²¤íŠ¸ ì¶”ê°€
    document.body.classList.add('mobile-optimized');
    
    // ë”ë¸” íƒ­ ì¤Œ ë°©ì§€
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);
    
    console.log("ëª¨ë°”ì¼ ìµœì í™” ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
  }
}

// í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì§€ì›
function setupKeyboardShortcuts() {
  document.addEventListener('keydown', function(e) {
    // Ctrl+S: í˜„ì¬ ìƒ˜í”Œ ì €ì¥
    if (e.ctrlKey && e.key === 's') {
      e.preventDefault();
      if (currentSampleId) {
        saveCurrentSample();
        showToast("ìƒ˜í”Œì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }
    }
    
    // Ctrl+N: ìƒˆ ìƒ˜í”Œ ì¶”ê°€
    if (e.ctrlKey && e.key === 'n') {
      e.preventDefault();
      document.getElementById('addSampleBtn').click();
    }
    
    // í™”ì‚´í‘œ í‚¤: ìƒ˜í”Œ ë„¤ë¹„ê²Œì´ì…˜
    if (e.key === 'ArrowLeft' && e.altKey) {
      e.preventDefault();
      goToPrevSample();
    }
    
    if (e.key === 'ArrowRight' && e.altKey) {
      e.preventDefault();
      goToNextSample();
    }
    
    // Ctrl+D: ìƒ˜í”Œ ë³µì œ
    if (e.ctrlKey && e.key === 'd') {
      e.preventDefault();
      if (currentSampleId) {
        cloneSample(currentSampleId);
      }
    }
    
    // ESC: ëª¨ë‹¬ ë‹«ê¸°
    if (e.key === 'Escape') {
      document.querySelectorAll('.modal.show').forEach(modal => {
        modal.classList.remove('show');
      });
    }
    
    // Ctrl+1~4: í–¥ë¯¸ íƒ­ ì „í™˜
    if (e.ctrlKey && e.key >= '1' && e.key <= '4') {
      e.preventDefault();
      const phaseIndex = parseInt(e.key) - 1;
      if (phaseIndex < FLAVOR_PHASES.length) {
        currentFlavorPhase = FLAVOR_PHASES[phaseIndex].id;
        renderFlavorTabs();
        renderFlavorPhase();
      }
    }
    
    // Ctrl+L: ì–¸ì–´ ì „í™˜
    if (e.ctrlKey && e.key === 'l') {
      e.preventDefault();
      switchLanguage(currentLanguage === 'ko' ? 'en' : 'ko');
    }
  });
  
  console.log("í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
}

// ì„±ëŠ¥ ìµœì í™” í•¨ìˆ˜
function optimizePerformance() {
  // ë””ë°”ìš´ì‹±ëœ ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸
  let resizeTimeout;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      // ì°¨íŠ¸ ë¦¬ì‚¬ì´ì¦ˆ
      if (flavorProfileChart) {
        flavorProfileChart.resize();
      }
      
      Object.values(chartObjects).forEach(chart => {
        if (chart && typeof chart.resize === 'function') {
          chart.resize();
        }
      });
    }, 250);
  });
  
  // ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ (ê°œë°œì ë„êµ¬ìš©)
  if (typeof performance !== 'undefined' && performance.memory) {
    setInterval(() => {
      const memory = performance.memory;
      if (memory.usedJSHeapSize > 50 * 1024 * 1024) { // 50MB ì´ìƒ
        console.warn("ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ë†’ìŠµë‹ˆë‹¤:", memory.usedJSHeapSize / 1024 / 1024, "MB");
        cleanupCharts();
      }
    }, 30000); // 30ì´ˆë§ˆë‹¤ ì²´í¬
  }
}

// ì´ˆê¸°í™” í•¨ìˆ˜
function initApp() {
  try {
    console.log("ğŸš€ Mollis SCA ì»¤í”¼ ê´€ëŠ¥ í‰ê°€ ë„êµ¬ (ê°œì„ ë²„ì „) ì‹œì‘");
    
    renderFlavorTabs();
    loadSamplesFromStorage();
    
    // ëª¨ë“  ìƒ˜í”Œ ë°ì´í„° ê²€ì¦ ë° ìˆ˜ì •
    samples.forEach(sample => {
      validateSampleData(sample.sampleData);
    });
    
    setupSwipeNavigation();
    setupKeyboardShortcuts();
    enhanceMobileExperience();
    setupErrorMonitoring();
    
    document.getElementById('evalDate').textContent = new Date().toLocaleDateString();
    
    // ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„° ë Œë”ë§
    renderBodyDescriptors();
    
    // ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
    updateI18nTexts();
    
    // í˜„ì¬ ìƒ˜í”Œì´ ìˆìœ¼ë©´ UI ì—…ë°ì´íŠ¸
    if (currentSampleId) {
      const currentSample = getCurrentSampleObj();
      if (currentSample) {
        setUIFromSample(currentSample.sampleData);
      }
    }
    
    console.log("âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì™„ë£Œ");
    console.log(`ğŸ“Š í–¥ë¯¸ í•­ëª©: ${FLAVOR_DATA.length}ê°œ`);
    console.log(`ğŸ– ë°”ë””ê° ë””ìŠ¤í¬ë¦½í„°: ${BODY_DESCRIPTORS.length}ê°œ`);
    console.log(`ğŸŒ í˜„ì¬ ì–¸ì–´: ${currentLanguage === 'ko' ? 'í•œêµ­ì–´' : 'ì˜ì–´'}`);
    
    // ì‚¬ìš©ìì—ê²Œ í™˜ì˜ ë©”ì‹œì§€ í‘œì‹œ
    setTimeout(() => {
      showToast("Mollis SCA ì»¤í”¼ ê´€ëŠ¥ í‰ê°€ ë„êµ¬ (ê°œì„ ë²„ì „)ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!");
    }, 1000);
    
  } catch (e) {
    console.error("ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜:", e);
    showToast("ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.");
  }
}

// ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •
function setupEventHandlers() {
  // ìƒ˜í”Œ ê´€ë¦¬ ë²„íŠ¼ë“¤
  document.getElementById('addSampleBtn').addEventListener('click', function() {
    if (currentSampleId) {
      saveCurrentSample();
    }
    
    const newSample = createNewSampleObj(`ìƒ˜í”Œ #${samples.length + 1}`);
    samples.unshift(newSample);
    currentSampleId = newSample.id;
    renderSampleList();
    setUIFromSample(newSample.sampleData);
    saveSamplesToStorage();
    showToast("ìƒˆ ìƒ˜í”Œì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.");
  });
  
  document.getElementById('removeSampleBtn').addEventListener('click', function() {
    if (!currentSampleId) return;
    
    if (confirm("í˜„ì¬ ìƒ˜í”Œì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
      const currentIdx = samples.findIndex(s => s.id === currentSampleId);
      if (currentIdx === -1) return;
      
      samples.splice(currentIdx, 1);
      
      if (samples.length > 0) {
        currentSampleId = samples[Math.min(currentIdx, samples.length - 1)].id;
        setUIFromSample(samples.find(s => s.id === currentSampleId).sampleData);
      } else {
        const newSample = createNewSampleObj("ìƒ˜í”Œ #1");
        samples.push(newSample);
        currentSampleId = newSample.id;
        setUIFromSample(newSample.sampleData);
      }
      
      renderSampleList();
      saveSamplesToStorage();
      showToast("ìƒ˜í”Œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
  });
  
  document.getElementById('cloneSampleBtn').addEventListener('click', function() {
    if (!currentSampleId) return;
    cloneSample(currentSampleId);
  });
  
  // ë°ì´í„° ê´€ë¦¬ ë²„íŠ¼ë“¤
  document.getElementById('saveSamplesBtn').addEventListener('click', function() {
    if (currentSampleId) {
      saveCurrentSample();
    }
    saveSamplesToStorage();
    showToast("ëª¨ë“  ìƒ˜í”Œì´ ì›¹ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
  });
  
  document.getElementById('loadSamplesWebBtn').addEventListener('click', function() {
    if (confirm("ì›¹ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìƒ˜í”Œì„ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ? ì €ì¥ë˜ì§€ ì•Šì€ ë³€ê²½ì‚¬í•­ì€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.")) {
      loadSamplesFromStorage();
      if (samples.length > 0) {
        currentSampleId = samples[0].id;
        setUIFromSample(samples[0].sampleData);
      }
      showToast("ì›¹ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìƒ˜í”Œì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.");
    }
  });
  
  document.getElementById('backupManageBtn').addEventListener('click', function() {
    showBackupList();
  });
  
  // JSON ë‚´ë³´ë‚´ê¸°
  document.getElementById('exportSamplesBtn').addEventListener('click', function() {
    if (currentSampleId) {
      saveCurrentSample();
    }
    
    try {
      const dataStr = JSON.stringify(samples, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
      
      const exportFileName = `mollis_coffee_samples_${new Date().toISOString().slice(0, 10)}.json`;
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileName);
      linkElement.style.display = 'none';
      document.body.appendChild(linkElement);
      linkElement.click();
      document.body.removeChild(linkElement);
      
      showToast("ìƒ˜í”Œ ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‚´ë³´ëƒˆìŠµë‹ˆë‹¤.");
    } catch (e) {
      console.error("JSON ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜:", e);
      showToast("ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
  });
  
  // JSON ë¶ˆëŸ¬ì˜¤ê¸°
  document.getElementById('importSamplesInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = function(event) {
      try {
        const importedData = JSON.parse(event.target.result);
        
        if (Array.isArray(importedData) && importedData.length > 0) {
          if (confirm("ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¡œ ê¸°ì¡´ ë°ì´í„°ë¥¼ ëŒ€ì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            samples = importedData;
            // ë°ì´í„° ê²€ì¦
            samples.forEach(sample => {
              validateSampleData(sample.sampleData);
            });
            
            currentSampleId = samples[0].id;
            setUIFromSample(samples[0].sampleData);
            renderSampleList();
            saveSamplesToStorage();
            showToast("ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.");
          }
        } else {
          showToast("ìœ íš¨í•œ ìƒ˜í”Œ ë°ì´í„°ê°€ ì•„ë‹™ë‹ˆë‹¤.");
        }
      } catch (e) {
        console.error("JSON íŒŒì‹± ì˜¤ë¥˜:", e);
        showToast("JSON íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      }
    };
    
    reader.readAsText(file);
    e.target.value = '';
  });
  
  // ìŠ¬ë¼ì´ë”/ì…ë ¥ ë™ê¸°í™”
  document.querySelectorAll('.score-slider').forEach(slider => {
    const inputId = slider.id.replace('_slider', '');
    const input = document.getElementById(inputId);
    
    slider.addEventListener('input', function() {
      input.value = this.value;
      updateTotalScore();
      scheduleAutoSave();
    });
    
    input.addEventListener('input', function() {
      slider.value = this.value;
      updateTotalScore();
      scheduleAutoSave();
    });
  });
  
  // ê³„ì‚° ë²„íŠ¼
  document.getElementById('calcScoreBtn').addEventListener('click', function() {
    updateTotalScore();
  });
  
  // ë³€ê²½ ê°ì§€ ì´ë²¤íŠ¸ë“¤
  document.getElementById('sampleTitleInput').addEventListener('input', scheduleAutoSave);
  
  document.querySelectorAll('.coffee-input').forEach(input => {
    input.addEventListener('input', scheduleAutoSave);
    input.addEventListener('change', scheduleAutoSave);
  });
  
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', function() {
      scheduleAutoSave();
      renderSelectedFlavorsArea();
    });
  });
  
  document.getElementById('tastingNotes').addEventListener('input', scheduleAutoSave);
  
  // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼
  document.getElementById('prevSampleBtn').addEventListener('click', goToPrevSample);
  document.getElementById('nextSampleBtn').addEventListener('click', goToNextSample);
  
  // ì–¸ì–´ ì „í™˜ ë²„íŠ¼ ê°œì„ 
  document.getElementById('langEn').addEventListener('click', () => switchLanguage('en'));
  document.getElementById('langKo').addEventListener('click', () => switchLanguage('ko'));
  
  // ë¹„êµ ë²„íŠ¼ë“¤
  document.getElementById('compareBtn').addEventListener('click', function() {
    const selectedIds = Array.from(document.querySelectorAll('.compare-checkbox:checked'))
      .map(cb => cb.value);
    
    if (selectedIds.length < 2) {
      showToast("ë¹„êµë¥¼ ìœ„í•´ 2ê°œ ì´ìƒì˜ ìƒ˜í”Œì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
      return;
    }
    
    const selectedSamples = samples.filter(s => selectedIds.includes(s.id));
    createComparisonChart(selectedSamples);
  });
  
  document.getElementById('advancedCompareBtn').addEventListener('click', function() {
    const selectedIds = Array.from(document.querySelectorAll('.compare-checkbox:checked'))
      .map(cb => cb.value);
    
    if (selectedIds.length < 2) {
      showToast("ë¹„êµë¥¼ ìœ„í•´ 2ê°œ ì´ìƒì˜ ìƒ˜í”Œì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
      return;
    }
    
    const selectedSamples = samples.filter(s => selectedIds.includes(s.id));
    createAdvancedComparisonTable(selectedSamples);
  });
  
  document.getElementById('splitViewBtn').addEventListener('click', function() {
    if (samples.length < 2) {
      showToast("ë¹„êµë¥¼ ìœ„í•´ ìƒ˜í”Œì´ 2ê°œ ì´ìƒ í•„ìš”í•©ë‹ˆë‹¤.");
      return;
    }
    
    const modal = document.getElementById('splitViewModal');
    modal.classList.add('show');
    updateSplitViewSelects();
  });
  
  // ëª¨ë‹¬ ê´€ë ¨
  document.getElementById('closeSplitViewBtn').addEventListener('click', function() {
    document.getElementById('splitViewModal').classList.remove('show');
  });
  
  document.getElementById('leftSampleSelect').addEventListener('change', updateSplitView);
  document.getElementById('rightSampleSelect').addEventListener('change', updateSplitView);
  
  // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('modal')) {
      e.target.classList.remove('show');
    }
  });
  
  // ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ë“¤ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€ - ìƒëµí•˜ì—¬ ê¸¸ì´ ë‹¨ì¶•)
  document.getElementById('exportImgBtn').addEventListener('click', exportImage);
  
  document.getElementById('exportSnsImgBtn').addEventListener('click', exportSnsImage);
  
  document.getElementById('exportXlsxBtn').addEventListener('click', exportXlsx);
  
  console.log("ëª¨ë“  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì • ì™„ë£Œ");
}

// DOMì´ ì¤€ë¹„ë˜ë©´ ì•± ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
  initApp();
  setupEventHandlers();
  setupAutoBackup();
  optimizePerformance();
});

// í˜ì´ì§€ ì¢…ë£Œ ì‹œ ì •ë¦¬ ì‘ì—… 
window.addEventListener('beforeunload', function(e) {
  try {
    saveCurrentSample();
    cleanupCharts();
  } catch (err) {
    console.error("í˜ì´ì§€ ì¢…ë£Œ ì‹œ ì •ë¦¬ ì‘ì—… ì¤‘ ì˜¤ë¥˜:", err);
  }
});

</script>
</body>
</html>
